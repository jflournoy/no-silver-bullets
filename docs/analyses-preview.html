<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.5.57">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="author" content="John Flournoy">
    <meta name="dcterms.date" content="2025-02-27">

    <title>Cycle time analysis</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
     <script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>   <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script> 
      </head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Cycle time analysis</h6>

            <a href="./analyses.qmd" class="btn btn-primary quarto-download-embed" download="analyses.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-right">
      <h1 class="title">Cycle time analysis</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta column-page-right">

                <div>
            <div class="quarto-title-meta-heading">Author</div>
            <div class="quarto-title-meta-contents">
                        <p>John Flournoy </p>
                      </div>
          </div>
                
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">February 27, 2025</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link active" data-scroll-target="#data-preparation">Data preparation</a></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration">Data exploration</a>
  <ul>
  <li><a href="#outcome-distribution" id="toc-outcome-distribution" class="nav-link" data-scroll-target="#outcome-distribution">Outcome distribution</a></li>
  <li><a href="#outcome-across-months" id="toc-outcome-across-months" class="nav-link" data-scroll-target="#outcome-across-months">Outcome across months</a></li>
  <li><a href="#outlier-trends" id="toc-outlier-trends" class="nav-link" data-scroll-target="#outlier-trends">Outlier trends</a></li>
  <li><a href="#predictor-plots" id="toc-predictor-plots" class="nav-link" data-scroll-target="#predictor-plots">Predictor plots</a></li>
  </ul></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling">Modeling</a>
  <ul>
  <li><a href="#likelihood-and-prior-definitions" id="toc-likelihood-and-prior-definitions" class="nav-link" data-scroll-target="#likelihood-and-prior-definitions">Likelihood and prior definitions</a></li>
  <li><a href="#non-linear-predictors-interacting-with-non-linear-unclosed-control-full-data" id="toc-non-linear-predictors-interacting-with-non-linear-unclosed-control-full-data" class="nav-link" data-scroll-target="#non-linear-predictors-interacting-with-non-linear-unclosed-control-full-data">Non-linear Predictors interacting with non-linear unclosed control (Full data)</a></li>
  <li><a href="#linear-predictors-interacting-with-month-random-effect-full-data" id="toc-linear-predictors-interacting-with-month-random-effect-full-data" class="nav-link" data-scroll-target="#linear-predictors-interacting-with-month-random-effect-full-data">Linear predictors interacting with “month” random effect (full data)</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block column-page-right" id="quarto-document-content">      

       <section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">Data preparation</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms) </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(StanHeaders)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(showtext)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>font_name <span class="ot">&lt;-</span> <span class="st">"Roboto"</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(font_name)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>brms_to_draws <span class="ot">&lt;-</span> <span class="cf">function</span>(x, variables){</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x<span class="sc">$</span>fit<span class="sc">@</span>sim<span class="sc">$</span>samples</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  x_subsamples <span class="ot">&lt;-</span> <span class="fu">lapply</span>(x, \(x) x[, variables])</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  x_draws <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws</span>(x_subsamples)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x_draws)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>get_unique_N <span class="ot">&lt;-</span> <span class="cf">function</span>(xdt, <span class="at">var =</span> <span class="st">'user_id'</span>){</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(xdt[, .(<span class="at">N =</span> <span class="fu">uniqueN</span>(.SD)), <span class="at">.SDcols =</span> var]<span class="sc">$</span>N)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>create_label_transform <span class="ot">&lt;-</span> <span class="cf">function</span>(center, <span class="at">inverse_logit =</span> <span class="cn">FALSE</span>, <span class="at">format =</span> <span class="st">"numeric"</span>) {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) {</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(x))</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    uncentered <span class="ot">&lt;-</span> x <span class="sc">+</span> center</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (inverse_logit) {</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>      values <span class="ot">&lt;-</span> <span class="fu">plogis</span>(uncentered)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>      values <span class="ot">&lt;-</span> uncentered</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (format <span class="sc">==</span> <span class="st">"numeric"</span>) {</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">round</span>(values, <span class="dv">3</span>))</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (format <span class="sc">==</span> <span class="st">"percent"</span>) {</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">paste0</span>(<span class="fu">round</span>(values <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>))</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">"Invalid format. Use 'numeric' or 'percent'."</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>get_center <span class="ot">&lt;-</span> <span class="cf">function</span>(x, var){</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  var_c <span class="ot">&lt;-</span> <span class="fu">paste0</span>(var, <span class="st">'_c'</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>(<span class="fu">round</span>(month_level_dt[[var]] <span class="sc">-</span> </span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>                   month_level_dt[[var_c]], <span class="dv">5</span>))</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>plot_marginal_effect <span class="ot">&lt;-</span> <span class="cf">function</span>(x, condition, </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">trans.y =</span> <span class="cn">NULL</span>, </span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">translabels.x =</span> <span class="cn">NULL</span>, </span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">translabels.fill =</span> <span class="fu">rev</span>(translabels.x), </span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">binwidth =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">plot_labels =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">bin_alpha =</span> .<span class="dv">8</span>,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">patchwork_args =</span> <span class="fu">list</span>(),</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">stack_swaps =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">swap_condition_axes =</span> <span class="cn">FALSE</span>){</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x = cycle_time_full_intx_lin_remonth_m</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># condition = list('month_num_c' = c(1, 3, 6, 9, 12) - 7,</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                  'yr_avg_comments_per_pr_c' = c(1, 5, 7, 12, 18) - yr_avg_comments_per_pr_center)</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># trans.y = scales::modulus_trans(p = .25)</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># trans.x = NULL</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># patchwork_args = list(nrow = 2)</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># binwidth = NULL</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bin_alpha = .8</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot_labels = list(labs(x = 'Month',</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                         y = 'Median cycle time (days)',</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                         fill = 'Comments per PR',</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                         color = 'Comments per PR'),</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                    labs(y = 'Median cycle time (days)',</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                         x = 'Comments per PR',</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                         fill = 'Month',</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                         color = 'Month'))</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># translabels.x = list(create_label_transform(7),</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                      create_label_transform(yr_avg_comments_per_pr_center))</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># translabels.fill = rev(translabels.x)</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stack_swaps = TRUE</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># swap_condition_axes = FALSE</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(patchwork)</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(rlang)</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>  s_to_day <span class="ot">&lt;-</span> \(x) <span class="fu">return</span>(x <span class="sc">/</span> (<span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span>))</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the formula terms</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  terms_object <span class="ot">&lt;-</span> <span class="fu">attr</span>(<span class="fu">model.frame</span>(x), <span class="st">"terms"</span>)</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the variables attribute (which includes the response variable)</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  response_variable <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">attr</span>(terms_object, <span class="st">"variables"</span>))[<span class="dv">2</span>]</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>  max_resp <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x<span class="sc">$</span>data[[response_variable]], <span class="at">p =</span> .<span class="dv">95</span>)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>  coords <span class="ot">&lt;-</span> <span class="fu">s_to_day</span>(<span class="fu">c</span>(<span class="dv">0</span>, max_resp))</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(stack_swaps){</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>    condition_list <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">list</span>(condition, <span class="fu">rev</span>(condition)))</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (swap_condition_axes) {</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    condition_list <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">list</span>(<span class="fu">rev</span>(condition)))</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    condition_list <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">list</span>(condition))</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(condition_list), \(c_i) {</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    cond <span class="ot">&lt;-</span> condition_list[[c_i]]</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(cond))){</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>      c_names <span class="ot">&lt;-</span> <span class="fu">names</span>(cond)</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>      cond[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(x), <span class="at">to =</span> <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>      c_names <span class="ot">&lt;-</span> cond</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(binwidth)) {</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(c_names[[<span class="dv">1</span>]] <span class="sc">==</span> <span class="st">'month_num_c'</span>){</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>        binwidth_x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>        binwidth_y <span class="ot">&lt;-</span> .<span class="dv">005</span><span class="sc">*</span><span class="fu">s_to_day</span>(<span class="fu">diff</span>(<span class="fu">range</span>(x<span class="sc">$</span>data[[response_variable]])))</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>        binwidth_x <span class="ot">&lt;-</span> .<span class="dv">05</span><span class="sc">*</span><span class="fu">diff</span>(<span class="fu">range</span>(x<span class="sc">$</span>data[[c_names[[<span class="dv">1</span>]]]]))</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>        binwidth_y <span class="ot">&lt;-</span> .<span class="dv">0025</span><span class="sc">*</span><span class="fu">s_to_day</span>(<span class="fu">diff</span>(<span class="fu">range</span>(x<span class="sc">$</span>data[[response_variable]])))</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>      this_binwidth <span class="ot">&lt;-</span> <span class="fu">c</span>(binwidth_x, binwidth_y)</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(c_i <span class="sc">&gt;</span> <span class="fu">length</span>(binwidth)){</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">'binwidth should be a list with length equal to condition_list'</span>)</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>      this_binwidth <span class="ot">&lt;-</span> binwidth[[c_i]]</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(this_binwidth) <span class="sc">!=</span> <span class="dv">2</span>){</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">'each element of binwidth should have length == 2'</span>)</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>    pp_data <span class="ot">&lt;-</span> marginaleffects<span class="sc">::</span><span class="fu">plot_predictions</span>(x, <span class="at">condition =</span> cond, <span class="at">re_formula =</span> <span class="cn">NA</span>, <span class="at">trans =</span> s_to_day, <span class="at">draw =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>    pp <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data =</span> pp_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">get</span>(c_names[[<span class="dv">1</span>]]), <span class="at">y =</span> estimate)) <span class="sc">+</span> </span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_summary_2d</span>(<span class="at">data =</span> x<span class="sc">$</span>data, </span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">s_to_day</span>(<span class="fu">get</span>(response_variable)), </span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="fu">get</span>(c_names[[<span class="dv">1</span>]]),</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>                          <span class="at">z =</span> <span class="dv">1</span>), </span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>                      <span class="at">binwidth =</span> this_binwidth, <span class="at">alpha =</span> bin_alpha,</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x))) <span class="sc">+</span> </span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>      <span class="co"># geom_bin2d(data = x$data, aes(y = s_to_day(get(response_variable)), x = get(c_names[[1]])), </span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>      <span class="co">#            binwidth = this_binwidth, alpha = bin_alpha) + </span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">'mako'</span>, <span class="at">guide =</span> <span class="st">'none'</span>,</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>                           <span class="at">begin =</span> <span class="dv">1</span>, <span class="at">end =</span> .<span class="dv">5</span>)</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(cond) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>      pp <span class="ot">&lt;-</span> pp <span class="sc">+</span> </span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>        ggnewscale<span class="sc">::</span><span class="fu">new_scale_fill</span>() <span class="sc">+</span> </span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">group =</span> <span class="fu">get</span>(c_names[[<span class="dv">2</span>]]), </span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> <span class="fu">get</span>(c_names[[<span class="dv">2</span>]])), <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">get</span>(c_names[[<span class="dv">2</span>]]), <span class="at">color =</span> <span class="fu">get</span>(c_names[[<span class="dv">2</span>]])))</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(translabels.fill)){</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>        pp <span class="ot">&lt;-</span> pp <span class="sc">+</span> <span class="fu">scale_color_viridis_d</span>(<span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">'fill'</span>, <span class="st">'color'</span>),</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>                              <span class="at">option =</span> <span class="st">'rocket'</span>, <span class="at">begin =</span> <span class="dv">0</span>, <span class="at">end =</span> .<span class="dv">7</span>,</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labels =</span> translabels.fill[[c_i]])</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>        pp <span class="ot">&lt;-</span> pp <span class="sc">+</span> <span class="fu">scale_color_viridis_d</span>(<span class="at">labels =</span> <span class="cf">function</span>(b) <span class="fu">round</span>(<span class="fu">as.numeric</span>(b), <span class="dv">2</span>), </span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>                              <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">'fill'</span>, <span class="st">'color'</span>),</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>                              <span class="at">option =</span> <span class="st">'rocket'</span>, <span class="at">begin =</span> <span class="dv">0</span>, <span class="at">end =</span> .<span class="dv">7</span>)</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>      pp <span class="ot">&lt;-</span> pp <span class="sc">+</span> </span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_minimal</span>()</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">length</span>(cond) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>      pp <span class="ot">&lt;-</span> pp <span class="sc">+</span> </span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>        ggnewscale<span class="sc">::</span><span class="fu">new_scale_fill</span>() <span class="sc">+</span> </span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_minimal</span>()</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(translabels.x)){</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>      pp <span class="ot">&lt;-</span> pp <span class="sc">+</span> </span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> translabels.x[[c_i]])</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(plot_labels)){</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(c_names) <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>        pp <span class="ot">&lt;-</span> pp <span class="sc">+</span> </span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x =</span> c_names[[<span class="dv">1</span>]], <span class="at">y =</span> response_variable) </span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">length</span>(c_names <span class="sc">==</span> <span class="dv">2</span>)){</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>        pp <span class="ot">&lt;-</span> pp <span class="sc">+</span> </span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x =</span> c_names[[<span class="dv">1</span>]], <span class="at">y =</span> response_variable, <span class="at">fill =</span> c_names[[<span class="dv">2</span>]], <span class="at">color =</span> c_names[[<span class="dv">2</span>]])</span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>      pp <span class="ot">&lt;-</span> pp <span class="sc">+</span> </span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>        plot_labels[[c_i]]</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>    pp <span class="ot">&lt;-</span> pp <span class="sc">+</span> </span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_cartesian</span>(<span class="at">y =</span> coords, </span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>                      <span class="at">x =</span> <span class="fu">range</span>(x<span class="sc">$</span>data[[c_names[[<span class="dv">1</span>]]]]))</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(pp)</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(trans.y)){</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">'adding transform for y'</span>)</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">lapply</span>(p, \(pp) pp <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> trans.y))</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>  default_patchwork <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">do.call</span>(patchwork<span class="sc">::</span>wrap_plots, <span class="fu">c</span>(<span class="fu">list</span>(p), <span class="fu">modifyList</span>(default_patchwork, patchwork_args)))</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>traceplot_manyvars <span class="ot">&lt;-</span> <span class="cf">function</span>(x, variables){</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(posterior)</span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(data.table)</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x<span class="sc">$</span>fit<span class="sc">@</span>sim<span class="sc">$</span>samples</span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>  x_subsamples <span class="ot">&lt;-</span> <span class="fu">lapply</span>(x, \(x) x[, variables])</span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>  x_draws_df_l <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">as.data.table</span>(posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(x_subsamples)),</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>                       <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">'.chain'</span>, <span class="st">'.iteration'</span>, <span class="st">'.draw'</span>))</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>  x_draws_df_l[, .chain <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(.chain)]</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(x_draws_df_l, <span class="fu">aes</span>(<span class="at">x =</span> .iteration, <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> .chain, <span class="at">color =</span> .chain), <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> .<span class="dv">125</span>) <span class="sc">+</span> </span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span> </span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">'mako'</span>, <span class="at">begin =</span> <span class="dv">0</span>, <span class="at">end =</span> .<span class="dv">65</span>) <span class="sc">+</span> </span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">'lines'</span>),</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>theme_clean <span class="ot">&lt;-</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> font_name),</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">'lines'</span>)</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>objects_in_mem <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Load the data.table package</span></span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(data.table)</span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get all objects in the global environment</span></span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>  all_objects <span class="ot">&lt;-</span> <span class="fu">ls</span>(<span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data table with object names and sizes</span></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>  object_sizes <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>    <span class="at">Object =</span> all_objects,</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>    <span class="at">Size =</span> <span class="fu">sapply</span>(all_objects, <span class="cf">function</span>(x) <span class="fu">object.size</span>(<span class="fu">get</span>(x, <span class="at">envir =</span> .GlobalEnv)))</span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sort the data table by size in descending order</span></span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setorder</span>(object_sizes, <span class="sc">-</span>Size)</span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the sorted list</span></span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(object_sizes)</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>filename_do <span class="ot">&lt;-</span> <span class="cf">function</span>(filename, do_this){</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(filename)){</span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> do_this</span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>    <span class="fu">saveRDS</span>(result, filename)</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(filename)</span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [2]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data_dir <span class="ot">&lt;-</span> <span class="st">'~/remote'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>full_df <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="fu">file.path</span>(data_dir, <span class="st">'productivity-project/ind_full_df.csv'</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>ct_20240829 <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="fu">file.path</span>(data_dir, <span class="st">'productivity-project/cycle_time_and_tickets_20240829.csv'</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>comments_20240903 <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="fu">file.path</span>(data_dir, <span class="st">'productivity-project/comments_pr.csv'</span>))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>defecttkts_20240903 <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="fu">file.path</span>(data_dir, <span class="st">'productivity-project/defect_tickets.csv'</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>centr_20240903 <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="fu">file.path</span>(data_dir, <span class="st">'productivity-project/degree_cent_month.csv'</span>))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>full_df[, month_num <span class="sc">:</span><span class="er">=</span> <span class="fu">match</span>(<span class="fu">tolower</span>(month), <span class="fu">tolower</span>(month.abb))]</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>ct_20240829 <span class="ot">&lt;-</span> <span class="fu">unique</span>(ct_20240829[, <span class="sc">-</span><span class="st">'TEAM_ID'</span>])</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>ct_20240829[<span class="sc">!</span><span class="fu">is.na</span>(CT_TIME_END) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(TK_TIME_END) <span class="sc">&amp;</span> <span class="sc">!</span>CT_TIME_END <span class="sc">==</span> <span class="st">''</span> <span class="sc">&amp;</span> <span class="sc">!</span>TK_TIME_END <span class="sc">==</span> <span class="st">''</span>, </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>            .(<span class="fu">sum</span>(CT_TIME_END <span class="sc">==</span> TK_TIME_END), .N)]</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>ct_20240829[<span class="sc">!</span><span class="fu">is.na</span>(CT_CYCLE_TIME_S) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(TK_CYCLE_TIME_S) <span class="sc">&amp;</span> <span class="sc">!</span>CT_CYCLE_TIME_S <span class="sc">==</span> <span class="st">''</span> <span class="sc">&amp;</span> <span class="sc">!</span>TK_CYCLE_TIME_S <span class="sc">==</span> <span class="st">''</span>, </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>            .(<span class="fu">sum</span>(CT_CYCLE_TIME_S <span class="sc">==</span> TK_CYCLE_TIME_S), .N)]</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>ct_20240829[(<span class="fu">is.na</span>(CT_CYCLE_TIME_S) <span class="sc">|</span> CT_CYCLE_TIME_S <span class="sc">==</span> <span class="st">''</span>) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">is.na</span>(TK_CYCLE_TIME_S) <span class="sc">&amp;</span> <span class="sc">!</span>TK_CYCLE_TIME_S <span class="sc">==</span> <span class="st">''</span>), </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>            .(.N, <span class="at">N_user_id =</span> <span class="fu">uniqueN</span>(ASSIGNEE_APEX_USER_ID))]</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>ct_20240829[, new_cycle_time <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(<span class="fu">is.na</span>(CT_CYCLE_TIME_S) <span class="sc">|</span> CT_CYCLE_TIME_S <span class="sc">==</span> <span class="st">''</span>, TK_CYCLE_TIME_S, CT_CYCLE_TIME_S)]</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>ct_20240829[, .(<span class="at">na_new_ct =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(new_cycle_time)),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">na_old_ct =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(CT_CYCLE_TIME_S) <span class="sc">|</span> CT_CYCLE_TIME_S <span class="sc">==</span> <span class="st">''</span>))]</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>ct_20240829_agg <span class="ot">&lt;-</span> ct_20240829[, .(<span class="at">N_tickets_old =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(CT_CYCLE_TIME_S) <span class="sc">&amp;</span> <span class="sc">!</span>CT_CYCLE_TIME_S <span class="sc">==</span> <span class="st">''</span>),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">N_tickets_new =</span> <span class="fu">uniqueN</span>(TICKET_IDENTITY_ID),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">N_unclosed =</span> <span class="fu">sum</span>(CT_TIME_END <span class="sc">==</span> <span class="st">''</span> <span class="sc">&amp;</span> TK_TIME_END <span class="sc">==</span> <span class="st">''</span>),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">P_unclosed =</span> <span class="fu">sum</span>(CT_TIME_END <span class="sc">==</span> <span class="st">''</span> <span class="sc">&amp;</span> TK_TIME_END <span class="sc">==</span> <span class="st">''</span>) <span class="sc">/</span> <span class="fu">uniqueN</span>(TICKET_IDENTITY_ID),</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">cycle_time_old =</span> <span class="fu">as.numeric</span>(<span class="fu">median</span>(CT_CYCLE_TIME_S, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">cycle_time_new =</span> <span class="fu">as.numeric</span>(<span class="fu">median</span>(new_cycle_time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))),</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                               by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'ASSIGNEE_APEX_USER_ID'</span>, <span class="st">'ORG_ID'</span>, <span class="st">'TICKET_CREATED_MONTH'</span>, <span class="st">'TICKET_CREATED_YEAR'</span>)]</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>minmaxp <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">01</span>, .<span class="dv">99</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>range_non01_punclosed <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(minmaxp)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>ct_20240829_agg[, q_unclosed <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(P_unclosed <span class="sc">&lt;</span> minmaxp[[<span class="dv">1</span>]], range_non01_punclosed[<span class="dv">1</span>], </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">fifelse</span>(P_unclosed <span class="sc">&gt;</span> minmaxp[[<span class="dv">2</span>]], range_non01_punclosed[<span class="dv">2</span>], </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">qlogis</span>(P_unclosed)))]</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(ct_20240829_agg, </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">old =</span> <span class="fu">c</span>(<span class="st">'ORG_ID'</span>, <span class="st">'ASSIGNEE_APEX_USER_ID'</span>, <span class="st">'TICKET_CREATED_YEAR'</span>, <span class="st">'TICKET_CREATED_MONTH'</span>),</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'user_id'</span>,               <span class="st">'year'</span>,                <span class="st">'month_num'</span>))</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(comments_20240903, </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">old =</span> <span class="fu">c</span>(<span class="st">'ORG_ID'</span>, <span class="st">'APEX_USER_ID'</span>, <span class="st">'PR_YEAR'</span>, <span class="st">'PR_MONTH'</span>,  <span class="st">'COMMENTS_PER_PR'</span>),</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'user_id'</span>,      <span class="st">'year'</span>,    <span class="st">'month_num'</span>, <span class="st">'comments_per_pr'</span>))</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(defecttkts_20240903,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">old =</span> <span class="fu">c</span>(<span class="st">'ORG_ID'</span>, <span class="st">'USER_ID'</span>, <span class="st">'YEAR'</span>, <span class="st">'MONTH_NUM'</span>, <span class="st">'DEFECT_TICKET_PCT'</span>),</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'user_id'</span>, <span class="st">'year'</span>, <span class="st">'month_num'</span>, <span class="st">'defect_tickets_pct_indiv'</span>))</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(centr_20240903,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>         <span class="at">old =</span> <span class="fu">c</span>(<span class="st">'ORG_ID'</span>, <span class="st">'APEX_USER_ID'</span>, <span class="st">'PR_MONTH'</span>,  <span class="st">'DEGREE_CENTRALITY'</span>),</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'user_id'</span>,      <span class="st">'month_num'</span>, <span class="st">'degree_centrality_monthly'</span>))</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed <span class="ot">&lt;-</span> <span class="fu">merge</span>(ct_20240829_agg[<span class="sc">!</span><span class="fu">is.na</span>(cycle_time_new)], full_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'user_id'</span>, <span class="st">'year'</span>, <span class="st">'month_num'</span>), <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed <span class="ot">&lt;-</span> <span class="fu">merge</span>(comments_20240903, full_df_cleaned_unclosed, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'user_id'</span>, <span class="st">'year'</span>, <span class="st">'month_num'</span>), <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed <span class="ot">&lt;-</span> <span class="fu">merge</span>(defecttkts_20240903, full_df_cleaned_unclosed, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'user_id'</span>, <span class="st">'year'</span>, <span class="st">'month_num'</span>), <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed <span class="ot">&lt;-</span> <span class="fu">merge</span>(centr_20240903, full_df_cleaned_unclosed, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'user_id'</span>, <span class="st">'month_num'</span>), <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span> <span class="fu">get_unique_N</span>(full_df_cleaned_unclosed) <span class="sc">&gt;=</span> <span class="fu">get_unique_N</span>(full_df)){</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">'Error in merging'</span>)</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed[, median_cycle_time_s <span class="sc">:</span><span class="er">=</span> cycle_time_new]</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed[, degree_centrality_monthly_100 <span class="sc">:</span><span class="er">=</span> <span class="dv">100</span><span class="sc">*</span>degree_centrality_monthly]</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed[, within_quarter_month_num <span class="sc">:</span><span class="er">=</span> (month_num <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%%</span> <span class="dv">3</span>]</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>yr_avg_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'avg_coding_days_per_week'</span>, <span class="st">'total_merged_prs'</span>, </span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'defect_tickets_pct_indiv'</span>, <span class="st">'degree_centrality_monthly_100'</span>, </span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'comments_per_pr'</span>)</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>within_vars_new <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'wi_'</span>, yr_avg_vars)</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>yr_avg_vars_new <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'yr_avg_'</span>, yr_avg_vars)</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>yr_avg_vars_new_c <span class="ot">&lt;-</span> <span class="fu">paste0</span>(yr_avg_vars_new, <span class="st">'_c'</span>)</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>center_vars_ <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'q_unclosed'</span>, <span class="st">'avg_coding_days_per_week'</span>, </span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'total_merged_prs'</span>, <span class="st">'defect_tickets_pct_indiv'</span>,  </span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'comments_per_pr'</span>, <span class="st">'degree_centrality_monthly_100'</span>) </span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>team_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'team_size'</span>)</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>team_vars_new <span class="ot">&lt;-</span> <span class="fu">paste0</span>(team_vars, <span class="st">'_c'</span>)</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>factor_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'user_id'</span>)</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>factor_vars_new <span class="ot">&lt;-</span> <span class="fu">paste0</span>(factor_vars, <span class="st">'_fac'</span>)</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>time_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'month_num'</span>, <span class="st">'within_quarter_month_num'</span>)</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>time_vars_new <span class="ot">&lt;-</span> <span class="fu">paste0</span>(time_vars, <span class="st">'_c'</span>)</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>outcome_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'median_cycle_time_s'</span>)</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed_team_size_info <span class="ot">&lt;-</span> <span class="fu">unique</span>(</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>  full_df_cleaned_unclosed[, <span class="fu">c</span>(<span class="st">'team_size'</span>, <span class="st">'org_id'</span>, <span class="st">'user_id'</span>, <span class="st">'team_id'</span>)]</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>)[, .(<span class="at">team_size =</span> <span class="fu">mean</span>(team_size, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'user_id'</span>)]</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed_old <span class="ot">&lt;-</span> <span class="fu">copy</span>(full_df_cleaned_unclosed)</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed <span class="ot">&lt;-</span> <span class="fu">unique</span>(full_df_cleaned_unclosed[, <span class="fu">c</span>(..outcome_vars,</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>                                                                ..center_vars_,</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>                                                                ..factor_vars,</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">'org_name'</span>,</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>                                                                ..time_vars)]) </span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed[, (yr_avg_vars_new) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), .SDcols <span class="ot">=</span> yr_avg_vars, by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'user_id'</span>)]</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed[, (within_vars_new) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, \(x) x <span class="sc">-</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>                         .SDcols <span class="ot">=</span> yr_avg_vars, </span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>                         by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'user_id'</span>)]</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>center_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(center_vars_, yr_avg_vars_new)</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>center_vars_new <span class="ot">&lt;-</span> <span class="fu">paste0</span>(center_vars, <span class="st">'_c'</span>)</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed <span class="ot">&lt;-</span> <span class="fu">merge</span>(full_df_cleaned_unclosed, full_df_cleaned_unclosed_team_size_info)</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed[, (center_vars) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, round, <span class="at">digits =</span> <span class="dv">4</span>), .SDcols <span class="ot">=</span> center_vars]</span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed[, (team_vars) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, round, <span class="at">digits =</span> <span class="dv">4</span>), .SDcols <span class="ot">=</span> team_vars]</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed[, (center_vars_new) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, \(x) <span class="fu">scale</span>(x, <span class="at">scale =</span> <span class="cn">FALSE</span>)[,<span class="dv">1</span>]), .SDcols <span class="ot">=</span> center_vars]</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed[, (team_vars_new) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, \(x) <span class="fu">scale</span>(x, <span class="at">scale =</span> <span class="cn">FALSE</span>)[,<span class="dv">1</span>]), .SDcols <span class="ot">=</span> team_vars]</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed[, (factor_vars_new) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, factor), .SDcols <span class="ot">=</span> factor_vars]</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed[, <span class="fu">c</span>(<span class="st">'month_num_c'</span>, <span class="st">'within_quarter_month_num_c'</span>) <span class="sc">:</span><span class="er">=</span> </span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>                           .(month_num <span class="sc">-</span> <span class="dv">7</span>, within_quarter_month_num <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>model_vars <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(factor_vars, factor_vars_new,</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>                outcome_vars,</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>                center_vars,</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>                center_vars_new,</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>                within_vars_new, yr_avg_vars_new_c,</span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>                team_vars, team_vars_new,</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>                time_vars, time_vars_new))</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>model_vars_yrpred <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(factor_vars, factor_vars_new,</span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>                       outcome_vars, </span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>                       <span class="st">'q_unclosed'</span>, <span class="st">'q_unclosed_c'</span>,</span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>                       yr_avg_vars_new, yr_avg_vars_new_c, </span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>                       team_vars, team_vars_new,</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>                       time_vars, time_vars_new))</span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a><span class="co">#model_vars &lt;- model_vars[which(! model_vars %in% c('q_unclosed', 'q_unclosed_c'))]</span></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed <span class="ot">&lt;-</span> full_df_cleaned_unclosed[<span class="sc">!</span><span class="fu">is.na</span>(org_name)]</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>unique_users_dropping_col <span class="ot">&lt;-</span> <span class="fu">lapply</span>(center_vars_, \(x){</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">uniqueN</span>(<span class="fu">na.omit</span>(full_df_cleaned_unclosed[, <span class="fu">c</span>(..center_vars, <span class="st">'user_id'</span>)][, .SD, <span class="at">.SDcols =</span> <span class="sc">!</span><span class="fu">c</span>(x)])<span class="sc">$</span>user_id)</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(unique_users_dropping_col) <span class="ot">&lt;-</span> center_vars_</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>unique_users_dropping_col_yr <span class="ot">&lt;-</span> <span class="fu">lapply</span>(yr_avg_vars_new, \(x){</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">uniqueN</span>(<span class="fu">na.omit</span>(full_df_cleaned_unclosed[, <span class="fu">c</span>(..yr_avg_vars_new, <span class="st">'user_id'</span>)][, .SD, <span class="at">.SDcols =</span> <span class="sc">!</span><span class="fu">c</span>(x)])<span class="sc">$</span>user_id)</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(unique_users_dropping_col_yr) <span class="ot">&lt;-</span> yr_avg_vars_new</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>unique_users_dropping_col</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>unique_users_dropping_col_yr</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a><span class="co">#This is a considerably smaller data set due to missingness in the predictors</span></span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>month_level_dt <span class="ot">&lt;-</span> full_df_cleaned_unclosed[, .SD, .SDcols <span class="ot">=</span> <span class="fu">unique</span>(model_vars, model_vars_yrpred)]</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>month_level_dt <span class="ot">&lt;-</span> month_level_dt[median_cycle_time_s <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>month_level_dt <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(month_level_dt[, ..model_vars])</span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>month_level_yrpred_dt <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(full_df_cleaned_unclosed[median_cycle_time_s <span class="sc">&gt;</span> <span class="dv">0</span>, ..model_vars_yrpred])</span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>month_level_midq_dt <span class="ot">&lt;-</span> month_level_dt[within_quarter_month_num <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>month_level_ptyp_dt <span class="ot">&lt;-</span> <span class="fu">copy</span>(month_level_dt)</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">451</span>)</span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>month_level_ptyp_dt[, chunk_id <span class="sc">:</span><span class="er">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>), by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'org_id'</span>)] <span class="co">#make N chunks of data stratified by org, team</span></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>month_level_ptyp_dt <span class="ot">&lt;-</span> month_level_ptyp_dt[chunk_id <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_step9 <span class="ot">&lt;-</span> full_df[month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Feb'</span>, <span class="st">'May'</span>, <span class="st">'Aug'</span>, <span class="st">'Nov'</span>), </span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">c</span>(..factor_vars, <span class="st">'team_id'</span>, <span class="st">'cycle_time'</span>, <span class="st">'month'</span>, </span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'yr_avg_coding_days_per_week'</span>, </span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'yr_total_merged_prs'</span>, </span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'yr_defect_tickets_pct'</span>, </span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'degree_centrality'</span>, </span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'yr_comments'</span>)]</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_step9 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(full_df_cleaned_step9[cycle_time <span class="sc">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a><span class="co">#Has fewer unique_id because of missing month-level covariates</span></span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>month_level_dt[, .(<span class="at">N_user =</span> <span class="fu">uniqueN</span>(user_id_fac),</span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">N_org =</span> <span class="fu">uniqueN</span>(org_id_fac),</span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">N_obs =</span> .N)]</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>month_level_yrpred_dt[, .(<span class="at">N_user =</span> <span class="fu">uniqueN</span>(user_id_fac),</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">N_org =</span> <span class="fu">uniqueN</span>(org_id_fac),</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">N_obs =</span> .N)]</span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_step9[, .(<span class="at">N_user =</span> <span class="fu">uniqueN</span>(user_id),</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>                          <span class="at">N_team =</span> <span class="fu">uniqueN</span>(team_id),</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>                          <span class="at">N_teamuser =</span> <span class="fu">uniqueN</span>(<span class="fu">paste</span>(team_id, user_id)),</span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>                          <span class="at">N_org =</span> <span class="fu">uniqueN</span>(org_id),</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>                          <span class="at">N_obs =</span> .N)]</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>full_df_cleaned_unclosed[, .(<span class="at">N_user =</span> <span class="fu">uniqueN</span>(user_id_fac),</span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>                             <span class="at">N_org =</span> <span class="fu">uniqueN</span>(org_id_fac),</span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>                             <span class="at">N_obs =</span> .N)]</span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>month_level_dt[, <span class="fu">lapply</span>(.SD, \(x) <span class="fu">fifelse</span>(.N <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))), </span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a>               .SDcols <span class="ot">=</span> <span class="fu">c</span>(outcome_vars, center_vars_new, time_vars),</span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>               by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, <span class="st">'org_id_fac'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p>A lot happens here. I take the data that Carol was using it and then integrate it with ticket-level data which also includes some updated ticket-end timestamps. I then re-aggregate at the month level within-person, so that we get median cycle times for each person over that month. The predictor variables all come from the previous data set and are already aggregated at the month level or the year level.</p>
<p>I also keep or create some control variables. I discard repeat rows due to users working in multiple teams but I keep their average team size as a control variable. I also take the proportion of unclosed tickets for each month and transform it from <span class="math inline">\(P(unclosed) \in [0,1]\)</span> to be <span class="math inline">\(Q(unclosed) \in (-\inf, +\inf)\)</span> using the logistic quantile function.</p>
<p>I planned to run models where the predictors, where possible, vary by month, as well as where they are aggregated across the year to be individually varying but time invariant. There are trade-offs here. The time-varying data gives us a more granular view of correlated change across time, and a much closer sense of what might be causal processes. That is, we can say things like, within the same person when X changes from month to month we also see a change in cycle time. However, there are a lot of missing observations of our predictors so this reduces the size of the data to some extent. When all is cleaned up we have <code>formatC(dim(month_level_dt)[[1]], format="f", big.mark=",", digits=0)</code> rows comprised of <code>formatC(length(unique(month_level_dt$user_id_fac)), format="f", big.mark=",", digits=0)</code> unique users across <code>formatC(length(unique(month_level_dt$org_id_fac)), format="f", big.mark=",", digits=0)</code>, with a median of <code>formatC(month_level_dt[, .N, by = 'user_id_fac'][, .(median(N))][[1]], format="f", big.mark=",", digits=0)</code> (interquartile range = <code>tmprange &lt;- quantile(month_level_dt[, .N, by = 'user_id_fac']$N, c(.25, .75)); sprintf('[%d, %d]', tmprange[[1]], tmprange[[2]])</code>) observations per user.</p>
<p>From the data aggregated across the year we simply use all available information for each person to compute their average on each predictor, thereby “recovering” quite a few monthly observations of cycle time but with the cost of only being able to make inferences back to correlated stable individual differences. That is, we can say the sort of person who tends to have N coding days per week also tends to have lower cycle time and a steeper decrease in cycle time across the year (for example). In the data with yearly-average predictors, we have <code>formatC(dim(month_level_yrpred_dt)[[1]], format="f", big.mark=",", digits=0)</code> rows comprised of <code>formatC(length(unique(month_level_yrpred_dt$user_id_fac)), format="f", big.mark=",", digits=0)</code> unique users across <code>formatC(length(unique(month_level_yrpred_dt$org_id_fac)), format="f", big.mark=",", digits=0)</code>, with a median of <code>formatC(month_level_yrpred_dt[, .N, by = 'user_id_fac'][, .(median(N))][[1]], format="f", big.mark=",", digits=0)</code> (interquartile range = <code>tmprange &lt;- quantile(month_level_yrpred_dt[, .N, by = 'user_id_fac']$N, c(.25, .75)); sprintf('[%d, %d]', tmprange[[1]], tmprange[[2]])</code>) observations per user.</p>
</section>
<section id="data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration">Data exploration</h2>
<p>These plots helped me get a sense of the data distribution of the outcome (cycle time) and other variables that we were concerned might have undue influence on either the outcome itself or as a potential confound between the outcome and predictors (or their effect on the growth of our outcome over time).</p>
<section id="outcome-distribution" class="level3">
<h3 class="anchored" data-anchor-id="outcome-distribution">Outcome distribution</h3>
<div class="cell-container"><div class="cell-decorator"><pre>In [3]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_yrpred_dt, <span class="fu">aes</span>(<span class="at">x =</span> median_cycle_time_s)) <span class="sc">+</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">'area'</span>, <span class="at">fill =</span> <span class="st">'blue'</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">position =</span> <span class="st">'identity'</span>, <span class="fu">aes</span>(<span class="at">group =</span> org_id)) <span class="sc">+</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">'line'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">alpha =</span> .<span class="dv">8</span>, <span class="at">position =</span> <span class="st">'identity'</span>, <span class="fu">aes</span>(<span class="at">group =</span> org_id)) <span class="sc">+</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> org_id, <span class="at">scales =</span> <span class="st">'free_y'</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Density of observations'</span>, <span class="at">x =</span> <span class="st">'Median Cycle Time'</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_yrpred_dt, <span class="fu">aes</span>(<span class="at">x =</span> median_cycle_time_s)) <span class="sc">+</span> </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">'area'</span>, <span class="at">fill =</span> <span class="st">'blue'</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">position =</span> <span class="st">'identity'</span>, <span class="fu">aes</span>(<span class="at">group =</span> org_id)) <span class="sc">+</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">'line'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">alpha =</span> .<span class="dv">8</span>, <span class="at">position =</span> <span class="st">'identity'</span>, <span class="fu">aes</span>(<span class="at">group =</span> org_id)) <span class="sc">+</span> </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> org_id, <span class="at">scales =</span> <span class="st">'free_y'</span>) <span class="sc">+</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Density of observations'</span>, <span class="at">x =</span> <span class="st">'Log Median Cycle Time'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p>In the above, we see extreme right skew that is often a feature of time-to-event data.</p>
</section>
<section id="outcome-across-months" class="level3">
<h3 class="anchored" data-anchor-id="outcome-across-months">Outcome across months</h3>
<div class="cell-container"><div class="cell-decorator"><pre>In [4]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>hours_width <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="dv">28</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">60</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>N_weeks <span class="ot">&lt;-</span> hours_width <span class="sc">/</span> (<span class="dv">7</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">60</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_yrpred_dt, <span class="fu">aes</span>(<span class="at">y =</span> median_cycle_time_s, <span class="at">x =</span> month_num)) <span class="sc">+</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">binwidth =</span> <span class="fu">c</span>(<span class="dv">1</span>, hours_width)) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">12000</span>, <span class="at">by =</span> hours_width), <span class="at">labels =</span> N_weeks<span class="sc">*</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>(<span class="fu">length</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">12000</span>, <span class="at">by =</span> hours_width)) <span class="sc">-</span> <span class="dv">1</span>))) <span class="sc">+</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_continuous</span>(</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">trans =</span> <span class="st">"log"</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Count"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Month'</span>, <span class="at">y =</span> <span class="st">'Cycle time'</span>) <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> org_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p>We can see a slight downward trend in the outliers across months for many orgs.</p>
</section>
<section id="outlier-trends" class="level3">
<h3 class="anchored" data-anchor-id="outlier-trends">Outlier trends</h3>
<div class="cell-container"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_yrpred_dt, <span class="fu">aes</span>(<span class="at">x =</span> month_num, <span class="at">y =</span> median_cycle_time_s)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_yrpred_dt[, .(<span class="at">max_cycle_time =</span> <span class="fu">max</span>(median_cycle_time_s, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'month_num'</span>)],</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num, <span class="at">y =</span> max_cycle_time)) <span class="sc">+</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>) <span class="sc">+</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p>In the above we see the monthly trend in outliers more clearly. This is what gave rise to our diving back into ticket close dates to try to recover what we didn’t have from before as well as thinking about including a measure of proportion open tickets to try to control for the possibility that we were systematically mis-measuring cycle time because of systematic differences in missing ticket data over time.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [6]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ct_20240829_agg[, .(<span class="at">med_p_unclosed =</span> <span class="fu">median</span>(P_unclosed), <span class="at">N =</span> .N), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'month_num'</span>)][N <span class="sc">&gt;</span> <span class="dv">10</span>],</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num, <span class="at">y =</span> med_p_unclosed)) <span class="sc">+</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> org_id, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#View(ind_perf_agg[, .(med_p_unclosed = median(P_unclosed), N = .N), by = c('org_id', 'month_num')][N &gt; 10])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p>Above we see that across many orgs we have an uptick in unclosed tickets at the end of the year. These unclosed tickets can’t be included in the cycle time data and so will potentially have the effect of reducing observed cycle time for that month.</p>
</section>
<section id="predictor-plots" class="level3">
<h3 class="anchored" data-anchor-id="predictor-plots">Predictor plots</h3>
<ul class="task-list">
<li><label><input type="checkbox">A kind of question people ask: are there clusters of orgs based on eg across these variables and over time, “hit by the wave of planning and resists it”, how much variability and chaos, stability.</label></li>
</ul>
<div class="cell-container"><div class="cell-decorator"><pre>In [7]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_dt[, .(<span class="at">avg_coding_days_per_week =</span> <span class="fu">median</span>(avg_coding_days_per_week), <span class="at">N =</span> .N), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'month_num'</span>)][N <span class="sc">&gt;</span> <span class="dv">10</span>],</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num, <span class="at">y =</span> avg_coding_days_per_week)) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">'smooth'</span>, <span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> org_id, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [8]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>month_level_dt_plot <span class="ot">&lt;-</span> <span class="fu">copy</span>(month_level_dt)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>month_level_dt_plot[, group <span class="sc">:</span><span class="er">=</span> <span class="fu">rep</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">144</span>, <span class="at">size =</span> <span class="dv">1</span>), .N), by <span class="ot">=</span> <span class="st">'user_id_fac'</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_dt_plot, <span class="fu">aes</span>(<span class="at">x =</span> month_num, <span class="at">y =</span> avg_coding_days_per_week)) <span class="sc">+</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac), </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">size =</span> .<span class="dv">1</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">stat =</span> <span class="st">'smooth'</span>, <span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> group) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [9]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_dt[, .(<span class="at">total_merged_prs =</span> <span class="fu">median</span>(total_merged_prs), <span class="at">N =</span> .N), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'month_num'</span>)][N <span class="sc">&gt;</span> <span class="dv">10</span>],</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num, <span class="at">y =</span> total_merged_prs)) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">'smooth'</span>, <span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> org_id, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [10]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>month_level_dt_plot <span class="ot">&lt;-</span> <span class="fu">copy</span>(month_level_dt)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>month_level_dt_plot[, group <span class="sc">:</span><span class="er">=</span> <span class="fu">rep</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">144</span>, <span class="at">size =</span> <span class="dv">1</span>), .N), by <span class="ot">=</span> <span class="st">'user_id_fac'</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_dt_plot, <span class="fu">aes</span>(<span class="at">x =</span> month_num, <span class="at">y =</span> total_merged_prs)) <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac), </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">size =</span> .<span class="dv">1</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">stat =</span> <span class="st">'smooth'</span>, <span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> group, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [11]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_dt[, .(<span class="at">defect_tickets_pct_indiv =</span> <span class="fu">median</span>(defect_tickets_pct_indiv), <span class="at">N =</span> .N), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'month_num'</span>)][N <span class="sc">&gt;</span> <span class="dv">10</span>],</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num, <span class="at">y =</span> defect_tickets_pct_indiv)) <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">'smooth'</span>, <span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> org_id, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [12]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>month_level_dt_plot <span class="ot">&lt;-</span> <span class="fu">copy</span>(month_level_dt)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>month_level_dt_plot[, group <span class="sc">:</span><span class="er">=</span> <span class="fu">rep</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">144</span>, <span class="at">size =</span> <span class="dv">1</span>), .N), by <span class="ot">=</span> <span class="st">'user_id_fac'</span>]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_dt_plot, <span class="fu">aes</span>(<span class="at">x =</span> month_num, <span class="at">y =</span> defect_tickets_pct_indiv)) <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac), </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">size =</span> .<span class="dv">1</span>, </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">stat =</span> <span class="st">'smooth'</span>, <span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> group, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [13]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_dt[, .(<span class="at">degree_centrality_monthly_100 =</span> <span class="fu">median</span>(degree_centrality_monthly_100), <span class="at">N =</span> .N), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'month_num'</span>)][N <span class="sc">&gt;</span> <span class="dv">10</span>],</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num, <span class="at">y =</span> degree_centrality_monthly_100)) <span class="sc">+</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">'smooth'</span>, <span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> org_id, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [14]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>month_level_dt_plot <span class="ot">&lt;-</span> <span class="fu">copy</span>(month_level_dt)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>month_level_dt_plot[, group <span class="sc">:</span><span class="er">=</span> <span class="fu">rep</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">144</span>, <span class="at">size =</span> <span class="dv">1</span>), .N), by <span class="ot">=</span> <span class="st">'user_id_fac'</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_dt_plot, <span class="fu">aes</span>(<span class="at">x =</span> month_num, <span class="at">y =</span> degree_centrality_monthly_100)) <span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac), </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">size =</span> .<span class="dv">1</span>, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">stat =</span> <span class="st">'smooth'</span>, <span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> group, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [15]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_dt[, .(<span class="at">comments_per_pr =</span> <span class="fu">median</span>(comments_per_pr), <span class="at">N =</span> .N), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'org_id'</span>, <span class="st">'month_num'</span>)][N <span class="sc">&gt;</span> <span class="dv">10</span>],</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num, <span class="at">y =</span> comments_per_pr)) <span class="sc">+</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">'smooth'</span>, <span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> org_id, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [16]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>month_level_dt_plot <span class="ot">&lt;-</span> <span class="fu">copy</span>(month_level_dt)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>month_level_dt_plot[, group <span class="sc">:</span><span class="er">=</span> <span class="fu">rep</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">144</span>, <span class="at">size =</span> <span class="dv">1</span>), .N), by <span class="ot">=</span> <span class="st">'user_id_fac'</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(month_level_dt_plot, <span class="fu">aes</span>(<span class="at">x =</span> month_num, <span class="at">y =</span> comments_per_pr)) <span class="sc">+</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac), </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">size =</span> .<span class="dv">1</span>, </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">stat =</span> <span class="st">'smooth'</span>, <span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> group, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [17]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>rm_ls_pattern <span class="ot">&lt;-</span> <span class="st">"(centr_20240903|comments_20240903|ct_20240829|ct_20240829_agg|defecttkts_20240903|full_df|full_df_cleaned_step9|full_df_cleaned_unclosed|full_df_cleaned_unclosed_old|full_df_cleaned_unclosed_team_size_info|month_level_dt_plot|month_level_midq_dt|month_level_ptyp_dt)"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ls_list <span class="ot">&lt;-</span> <span class="fu">ls</span>(<span class="at">pattern =</span> rm_ls_pattern)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(ls_list) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">rm</span>(<span class="at">list =</span> ls_list)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>
</section>
<section id="modeling" class="level2">
<h2 class="anchored" data-anchor-id="modeling">Modeling</h2>
<p>These are the goals that informed my modelling decisions (beyond those that Carol already set forth, e.g., accounting for nesting):</p>
<ol type="1">
<li>Allow non-linear effects of certain predictors, especially month number, on the outcome.
<ul>
<li>requirement: <code>s()</code> and related syntax from <code>mgcv</code> package</li>
</ul></li>
<li>Model the outcome using a distribution appropriate for its observed shape and for its hypothesized data generating process
<ul>
<li>requirement: response distributions for time-to-event data (i.e., log normal, gamma, Weibull)</li>
</ul></li>
<li>Include group-varying effects for intercepts and predictor variables when groups are nested and crossed (as in Carol’s original models)
<ul>
<li>requirement: <code>lme4</code>-style random effects specifications</li>
</ul></li>
<li>Uncertaint quantification across the range of effects of interest including individually-varying effects
<ul>
<li>requirement: simulation or draws from the posterior distribution</li>
</ul></li>
</ol>
<p>The above requirements are met by <code>brms</code> which uses the Bayesian probabilistic programming language Stan. Added benefits of this method include good model diagnostics, robust fitting due to control via weakly-informative priors, and modeling</p>
<section id="likelihood-and-prior-definitions" class="level3">
<h3 class="anchored" data-anchor-id="likelihood-and-prior-definitions">Likelihood and prior definitions</h3>
<p>In the code blocks below I define the likelihood (i.e., model) and priors for a set of models going from most complicated to least complicated. This was part of the process of diagnosing any fitting problems starting with very simple models, and optimizing them to fit in a reasonable amount of time. I iterated through some trial and error finding reasonable prior distributions that constrained possible model-generated values to a reasonable range without being overly restrictive. This was particularly helpful in stabilizing the estimate of the shape parameter and intercept of the Weibull distribution.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Likelihoods</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Default Priors</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Set priors</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell-container"><div class="cell-decorator"><pre>In [18]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_yrpred_f <span class="ot">&lt;-</span> <span class="fu">bf</span>(median_cycle_time_s <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                                                  within_quarter_month_num_c <span class="sc">+</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                                                  team_size_c <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">s</span>(q_unclosed_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">s</span>(month_num_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">s</span>(month_num_c, <span class="at">by =</span> team_size_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">s</span>(month_num_c, <span class="at">by =</span> q_unclosed_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                                                  yr_avg_avg_coding_days_per_week_c <span class="sc">+</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                                                  yr_avg_total_merged_prs_c <span class="sc">+</span> </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                                                  yr_avg_defect_tickets_pct_indiv_c <span class="sc">+</span> </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                                                  yr_avg_degree_centrality_monthly_100_c <span class="sc">+</span> </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                                                  yr_avg_comments_per_pr_c <span class="sc">+</span> </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>                                                  month_num_c<span class="sc">:</span>yr_avg_avg_coding_days_per_week_c <span class="sc">+</span> </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>                                                  month_num_c<span class="sc">:</span>yr_avg_total_merged_prs_c <span class="sc">+</span> </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>                                                  month_num_c<span class="sc">:</span>yr_avg_defect_tickets_pct_indiv_c <span class="sc">+</span> </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                                                  month_num_c<span class="sc">:</span>yr_avg_degree_centrality_monthly_100_c <span class="sc">+</span> </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>                                                  month_num_c<span class="sc">:</span>yr_avg_comments_per_pr_c <span class="sc">+</span> </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>                                                  (month_num_c <span class="sc">|</span> org_id_fac) <span class="sc">+</span> (month_num_c <span class="sc">|</span> org_id_fac<span class="sc">:</span>user_id_fac),</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>                                                shape <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> org_id_fac),</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">family =</span> brms<span class="sc">::</span><span class="fu">weibull</span>())</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_f <span class="ot">&lt;-</span> <span class="fu">bf</span>(median_cycle_time_s <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>                                           within_quarter_month_num_c <span class="sc">+</span> </span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>                                           team_size_c <span class="sc">+</span> </span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">s</span>(q_unclosed_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">s</span>(month_num_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">s</span>(month_num_c, <span class="at">by =</span> team_size_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">s</span>(month_num_c, <span class="at">by =</span> q_unclosed_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>                                           wi_avg_coding_days_per_week <span class="sc">+</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>                                           yr_avg_avg_coding_days_per_week_c <span class="sc">+</span> </span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>                                           wi_total_merged_prs <span class="sc">+</span> </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>                                           yr_avg_total_merged_prs_c <span class="sc">+</span> </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>                                           wi_defect_tickets_pct_indiv <span class="sc">+</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>                                           yr_avg_defect_tickets_pct_indiv_c <span class="sc">+</span> </span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>                                           wi_degree_centrality_monthly_100 <span class="sc">+</span> </span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>                                           yr_avg_degree_centrality_monthly_100_c <span class="sc">+</span> </span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>                                           wi_comments_per_pr <span class="sc">+</span> </span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>                                           yr_avg_comments_per_pr_c <span class="sc">+</span> </span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>                                           month_num_c<span class="sc">:</span>yr_avg_avg_coding_days_per_week_c <span class="sc">+</span> </span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>                                           month_num_c<span class="sc">:</span>yr_avg_total_merged_prs_c <span class="sc">+</span> </span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>                                           month_num_c<span class="sc">:</span>yr_avg_defect_tickets_pct_indiv_c <span class="sc">+</span> </span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>                                           month_num_c<span class="sc">:</span>yr_avg_degree_centrality_monthly_100_c <span class="sc">+</span> </span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>                                           month_num_c<span class="sc">:</span>yr_avg_comments_per_pr_c <span class="sc">+</span> </span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>                                           (month_num_c <span class="sc">|</span> org_id_fac) <span class="sc">+</span> (month_num_c <span class="sc">|</span> org_id_fac<span class="sc">:</span>user_id_fac),</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>                                         shape <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> org_id_fac),</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">family =</span> brms<span class="sc">::</span><span class="fu">weibull</span>())</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_f <span class="ot">&lt;-</span> <span class="fu">bf</span>(median_cycle_time_s <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>                                   within_quarter_month_num_c <span class="sc">+</span> </span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>                                   team_size_c <span class="sc">+</span> </span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">s</span>(q_unclosed_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">s</span>(month_num_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">s</span>(month_num_c, <span class="at">by =</span> team_size_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">s</span>(month_num_c, <span class="at">by =</span> q_unclosed_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>                                   wi_avg_coding_days_per_week <span class="sc">+</span></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>                                   yr_avg_avg_coding_days_per_week_c <span class="sc">+</span> </span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>                                   wi_total_merged_prs <span class="sc">+</span> </span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>                                   yr_avg_total_merged_prs_c <span class="sc">+</span> </span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>                                   wi_defect_tickets_pct_indiv <span class="sc">+</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>                                   yr_avg_defect_tickets_pct_indiv_c <span class="sc">+</span> </span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>                                   wi_degree_centrality_monthly_100 <span class="sc">+</span> </span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>                                   yr_avg_degree_centrality_monthly_100_c <span class="sc">+</span> </span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>                                   wi_comments_per_pr <span class="sc">+</span> </span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>                                   yr_avg_comments_per_pr_c <span class="sc">+</span> </span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>                                   month_num_c<span class="sc">:</span>yr_avg_avg_coding_days_per_week_c <span class="sc">+</span> </span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>                                   month_num_c<span class="sc">:</span>yr_avg_total_merged_prs_c <span class="sc">+</span> </span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>                                   month_num_c<span class="sc">:</span>yr_avg_defect_tickets_pct_indiv_c <span class="sc">+</span> </span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>                                   month_num_c<span class="sc">:</span>yr_avg_degree_centrality_monthly_100_c <span class="sc">+</span> </span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>                                   month_num_c<span class="sc">:</span>yr_avg_comments_per_pr_c <span class="sc">+</span> </span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>                                   (<span class="dv">1</span> <span class="sc">|</span> org_id_fac) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> org_id_fac<span class="sc">:</span>user_id_fac),</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>                                 shape <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> org_id_fac),</span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">family =</span> brms<span class="sc">::</span><span class="fu">weibull</span>())</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_f <span class="ot">&lt;-</span> <span class="fu">bf</span>(median_cycle_time_s <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>                                   within_quarter_month_num_c <span class="sc">+</span> </span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>                                   team_size_c <span class="sc">+</span> </span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">s</span>(q_unclosed_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">s</span>(month_num_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">s</span>(month_num_c, <span class="at">by =</span> team_size_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">s</span>(month_num_c, <span class="at">by =</span> q_unclosed_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>                                   wi_avg_coding_days_per_week <span class="sc">+</span></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>                                   yr_avg_avg_coding_days_per_week_c <span class="sc">+</span> </span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>                                   wi_total_merged_prs <span class="sc">+</span> </span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>                                   yr_avg_total_merged_prs_c <span class="sc">+</span> </span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>                                   wi_defect_tickets_pct_indiv <span class="sc">+</span></span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>                                   yr_avg_defect_tickets_pct_indiv_c <span class="sc">+</span> </span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>                                   wi_degree_centrality_monthly_100 <span class="sc">+</span> </span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>                                   yr_avg_degree_centrality_monthly_100_c <span class="sc">+</span> </span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>                                   wi_comments_per_pr <span class="sc">+</span> </span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>                                   yr_avg_comments_per_pr_c <span class="sc">+</span></span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_avg_coding_days_per_week_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_total_merged_prs_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_defect_tickets_pct_indiv_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_degree_centrality_monthly_100_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_comments_per_pr_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>                                   (month_num_c <span class="sc">|</span> org_id_fac) <span class="sc">+</span> (month_num_c <span class="sc">|</span> org_id_fac<span class="sc">:</span>user_id_fac),</span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>                                 shape <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> org_id_fac),</span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">family =</span> brms<span class="sc">::</span><span class="fu">weibull</span>())</span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_f <span class="ot">&lt;-</span> <span class="fu">bf</span>(median_cycle_time_s <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a>                               within_quarter_month_num_c <span class="sc">+</span> </span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a>                               team_size_c <span class="sc">+</span> </span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>                               q_unclosed_c <span class="sc">+</span> </span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">s</span>(month_num_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">s</span>(month_num_c, <span class="at">by =</span> team_size_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">s</span>(month_num_c, <span class="at">by =</span> q_unclosed_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>                               wi_avg_coding_days_per_week <span class="sc">+</span></span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>                               yr_avg_avg_coding_days_per_week_c <span class="sc">+</span> </span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>                               wi_total_merged_prs <span class="sc">+</span> </span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a>                               yr_avg_total_merged_prs_c <span class="sc">+</span> </span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a>                               wi_defect_tickets_pct_indiv <span class="sc">+</span></span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a>                               yr_avg_defect_tickets_pct_indiv_c <span class="sc">+</span> </span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a>                               wi_degree_centrality_monthly_100 <span class="sc">+</span> </span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a>                               yr_avg_degree_centrality_monthly_100_c <span class="sc">+</span> </span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a>                               wi_comments_per_pr <span class="sc">+</span> </span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a>                               yr_avg_comments_per_pr_c <span class="sc">+</span></span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_avg_coding_days_per_week_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_total_merged_prs_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_defect_tickets_pct_indiv_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_degree_centrality_monthly_100_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_comments_per_pr_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a>                               (month_num_c <span class="sc">|</span> org_id_fac) <span class="sc">+</span> (month_num_c <span class="sc">|</span> org_id_fac<span class="sc">:</span>user_id_fac),</span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a>                             shape <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> org_id_fac),</span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a>                             <span class="at">family =</span> brms<span class="sc">::</span><span class="fu">weibull</span>())</span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_ptyp_f <span class="ot">&lt;-</span> <span class="fu">bf</span>(median_cycle_time_s <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a>                                    within_quarter_month_num_c <span class="sc">+</span> </span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a>                                    team_size_c <span class="sc">+</span> </span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a>                                    q_unclosed_c <span class="sc">+</span> </span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">s</span>(month_num_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">s</span>(month_num_c, <span class="at">by =</span> team_size_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">s</span>(month_num_c, <span class="at">by =</span> q_unclosed_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a>                                    wi_avg_coding_days_per_week <span class="sc">+</span></span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a>                                    yr_avg_avg_coding_days_per_week_c <span class="sc">+</span> </span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a>                                    wi_total_merged_prs <span class="sc">+</span> </span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a>                                    yr_avg_total_merged_prs_c <span class="sc">+</span> </span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a>                                    wi_defect_tickets_pct_indiv <span class="sc">+</span></span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a>                                    yr_avg_defect_tickets_pct_indiv_c <span class="sc">+</span> </span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a>                                    wi_degree_centrality_monthly_100 <span class="sc">+</span> </span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a>                                    yr_avg_degree_centrality_monthly_100_c <span class="sc">+</span> </span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a>                                    wi_comments_per_pr <span class="sc">+</span> </span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a>                                    yr_avg_comments_per_pr_c <span class="sc">+</span></span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_avg_coding_days_per_week_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_total_merged_prs_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_defect_tickets_pct_indiv_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_degree_centrality_monthly_100_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">s</span>(month_num_c, <span class="at">by =</span> yr_avg_comments_per_pr_c, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true" tabindex="-1"></a>                                    (<span class="dv">1</span> <span class="sc">|</span> org_id_fac) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> org_id_fac<span class="sc">:</span>user_id_fac),</span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true" tabindex="-1"></a>                                  shape <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> org_id_fac),</span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">family =</span> brms<span class="sc">::</span><span class="fu">weibull</span>())</span>
<span id="cb18-146"><a href="#cb18-146" aria-hidden="true" tabindex="-1"></a>cycle_time_full_ptyp_f <span class="ot">&lt;-</span> <span class="fu">bf</span>(median_cycle_time_s <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb18-147"><a href="#cb18-147" aria-hidden="true" tabindex="-1"></a>                               within_quarter_month_num_c <span class="sc">+</span> </span>
<span id="cb18-148"><a href="#cb18-148" aria-hidden="true" tabindex="-1"></a>                               team_size_c <span class="sc">+</span> </span>
<span id="cb18-149"><a href="#cb18-149" aria-hidden="true" tabindex="-1"></a>                               q_unclosed_c <span class="sc">+</span> </span>
<span id="cb18-150"><a href="#cb18-150" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">s</span>(month_num_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-151"><a href="#cb18-151" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">s</span>(month_num_c, <span class="at">by =</span> team_size_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-152"><a href="#cb18-152" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">s</span>(month_num_c, <span class="at">by =</span> q_unclosed_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-153"><a href="#cb18-153" aria-hidden="true" tabindex="-1"></a>                               wi_avg_coding_days_per_week <span class="sc">+</span></span>
<span id="cb18-154"><a href="#cb18-154" aria-hidden="true" tabindex="-1"></a>                               yr_avg_avg_coding_days_per_week_c <span class="sc">+</span> </span>
<span id="cb18-155"><a href="#cb18-155" aria-hidden="true" tabindex="-1"></a>                               wi_total_merged_prs <span class="sc">+</span> </span>
<span id="cb18-156"><a href="#cb18-156" aria-hidden="true" tabindex="-1"></a>                               yr_avg_total_merged_prs_c <span class="sc">+</span> </span>
<span id="cb18-157"><a href="#cb18-157" aria-hidden="true" tabindex="-1"></a>                               wi_defect_tickets_pct_indiv <span class="sc">+</span></span>
<span id="cb18-158"><a href="#cb18-158" aria-hidden="true" tabindex="-1"></a>                               yr_avg_defect_tickets_pct_indiv_c <span class="sc">+</span> </span>
<span id="cb18-159"><a href="#cb18-159" aria-hidden="true" tabindex="-1"></a>                               wi_degree_centrality_monthly_100 <span class="sc">+</span> </span>
<span id="cb18-160"><a href="#cb18-160" aria-hidden="true" tabindex="-1"></a>                               yr_avg_degree_centrality_monthly_100_c <span class="sc">+</span> </span>
<span id="cb18-161"><a href="#cb18-161" aria-hidden="true" tabindex="-1"></a>                               wi_comments_per_pr <span class="sc">+</span> </span>
<span id="cb18-162"><a href="#cb18-162" aria-hidden="true" tabindex="-1"></a>                               yr_avg_comments_per_pr_c <span class="sc">+</span></span>
<span id="cb18-163"><a href="#cb18-163" aria-hidden="true" tabindex="-1"></a>                               (<span class="dv">1</span> <span class="sc">|</span> org_id_fac) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> org_id_fac<span class="sc">:</span>user_id_fac),</span>
<span id="cb18-164"><a href="#cb18-164" aria-hidden="true" tabindex="-1"></a>                             shape <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> org_id_fac),</span>
<span id="cb18-165"><a href="#cb18-165" aria-hidden="true" tabindex="-1"></a>                             <span class="at">family =</span> brms<span class="sc">::</span><span class="fu">weibull</span>())</span>
<span id="cb18-166"><a href="#cb18-166" aria-hidden="true" tabindex="-1"></a>growth_ptyp_f <span class="ot">&lt;-</span> <span class="fu">bf</span>(median_cycle_time_s <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb18-167"><a href="#cb18-167" aria-hidden="true" tabindex="-1"></a>                      team_size_c <span class="sc">+</span> </span>
<span id="cb18-168"><a href="#cb18-168" aria-hidden="true" tabindex="-1"></a>                      q_unclosed_c <span class="sc">+</span> </span>
<span id="cb18-169"><a href="#cb18-169" aria-hidden="true" tabindex="-1"></a>                      within_quarter_month_num_c <span class="sc">+</span> </span>
<span id="cb18-170"><a href="#cb18-170" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">s</span>(month_num_c, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-171"><a href="#cb18-171" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">|</span> org_id_fac) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> org_id_fac<span class="sc">:</span>user_id_fac),</span>
<span id="cb18-172"><a href="#cb18-172" aria-hidden="true" tabindex="-1"></a>                    shape <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> org_id_fac),</span>
<span id="cb18-173"><a href="#cb18-173" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> brms<span class="sc">::</span><span class="fu">weibull</span>())</span>
<span id="cb18-174"><a href="#cb18-174" aria-hidden="true" tabindex="-1"></a>growth_ptyp_shape_f <span class="ot">&lt;-</span> <span class="fu">bf</span>(median_cycle_time_s <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb18-175"><a href="#cb18-175" aria-hidden="true" tabindex="-1"></a>                            (<span class="dv">1</span> <span class="sc">|</span> org_id_fac) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> org_id_fac<span class="sc">:</span>user_id_fac),</span>
<span id="cb18-176"><a href="#cb18-176" aria-hidden="true" tabindex="-1"></a>                          shape <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> org_id_fac),</span>
<span id="cb18-177"><a href="#cb18-177" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family =</span> brms<span class="sc">::</span><span class="fu">weibull</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Here I get a list of all the parameters and the default priors as a starting point (not evaluated here because the output is so long).</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [19]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(cycle_time_full_intx_lin_remonth_yrpred_f, <span class="at">data =</span> month_level_yrpred_dt)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(cycle_time_full_intx_lin_remonth_f, <span class="at">data =</span> month_level_dt)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(cycle_time_full_intx_lin_f, <span class="at">data =</span> month_level_dt)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(cycle_time_full_intx_nlq_f, <span class="at">data =</span> month_level_dt)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(cycle_time_full_intx_f, <span class="at">data =</span> month_level_dt)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(cycle_time_full_intx_ptyp_f, <span class="at">data =</span> month_level_dt)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(cycle_time_full_ptyp_f, <span class="at">data =</span> month_level_dt)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(growth_ptyp_f, <span class="at">data =</span> month_level_dt)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(growth_ptyp_shape_f, <span class="at">data =</span> month_level_dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell-container"><div class="cell-decorator"><pre>In [20]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_yrpred_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="st">'normal(0,.1)'</span>, <span class="at">class =</span> <span class="st">'b'</span>),</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">prior</span>(<span class="st">'normal(14, 2.5)'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">prior</span>(<span class="st">'normal(.29, .25)'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">prior</span>(<span class="st">'normal(.25, .5)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">prior</span>(<span class="st">'normal(.05, .1)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">coef =</span> <span class="st">'month_num_c'</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">prior</span>(<span class="st">'lkj(1.5)'</span>, <span class="at">class =</span> <span class="st">'cor'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>, <span class="at">coef =</span> <span class="st">'month_num_c'</span>),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">prior</span>(<span class="st">'lkj(1.5)'</span>, <span class="at">class =</span> <span class="st">'cor'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">prior</span>(<span class="st">'normal(.15, .15)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">prior</span>(<span class="st">'normal(0, 1)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, k = 5)'</span>))</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="st">'normal(0,.1)'</span>, <span class="at">class =</span> <span class="st">'b'</span>),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">prior</span>(<span class="st">'normal(14, 2.5)'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">prior</span>(<span class="st">'normal(.1, .75)'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">prior</span>(<span class="st">'normal(.25, .5)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">prior</span>(<span class="st">'normal(.05, .1)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">coef =</span> <span class="st">'month_num_c'</span>),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">prior</span>(<span class="st">'lkj(1.5)'</span>, <span class="at">class =</span> <span class="st">'cor'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>, <span class="at">coef =</span> <span class="st">'month_num_c'</span>),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">prior</span>(<span class="st">'lkj(1.5)'</span>, <span class="at">class =</span> <span class="st">'cor'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>),</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">prior</span>(<span class="st">'normal(.15, .15)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">prior</span>(<span class="st">'normal(0, .5)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(q_unclosed_c, k = 5)'</span>),</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">prior</span>(<span class="st">'normal(0, .5)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, k = 5)'</span>),</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = q_unclosed_c, k = 5)'</span>),</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = team_size_c, k = 5)'</span>))</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="st">'normal(0,.1)'</span>, <span class="at">class =</span> <span class="st">'b'</span>),</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(14, 2.5)'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(.29, .25)'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(.25, .5)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>                                    <span class="co"># prior('normal(.05, .1)', class = 'sd', group = 'org_id_fac', coef = 'month_num_c'),</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>                                    <span class="co"># prior('normal(.15, .25)', class = 'sd', group = 'org_id_fac:user_id_fac', coef = 'month_num_c'),</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>                                    <span class="co"># prior('normal(.15, .25)', class = 'sd', group = 'org_id_fac:team_id_fac', coef = 'Intercept'),</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(.15, .15)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(0, 1)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, k = 5)'</span>))</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="st">'normal(0,.1)'</span>, <span class="at">class =</span> <span class="st">'b'</span>),</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(14, 2.5)'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(.1, .75)'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(.25, .5)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(.05, .1)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">coef =</span> <span class="st">'month_num_c'</span>),</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'lkj(1.5)'</span>, <span class="at">class =</span> <span class="st">'cor'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>),</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>, <span class="at">coef =</span> <span class="st">'month_num_c'</span>),</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'lkj(1.5)'</span>, <span class="at">class =</span> <span class="st">'cor'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>),</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(.15, .15)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(0, .5)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(q_unclosed_c, k = 5)'</span>),</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(0, .5)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, k = 5)'</span>),</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = q_unclosed_c, k = 5)'</span>),</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = team_size_c, k = 5)'</span>),</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_avg_coding_days_per_week_c, k = 3)'</span>),</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_total_merged_prs_c, k = 3)'</span>),</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_defect_tickets_pct_indiv_c, k = 3)'</span>),</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_degree_centrality_monthly_100_c, k = 3)'</span>),</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_comments_per_pr_c, k = 3)'</span>))</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="st">'normal(0,.1)'</span>, <span class="at">class =</span> <span class="st">'b'</span>),</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(14, 2.5)'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(.1, .75)'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(.25, .5)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(.05, .1)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">coef =</span> <span class="st">'month_num_c'</span>),</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'lkj(1.5)'</span>, <span class="at">class =</span> <span class="st">'cor'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>),</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>, <span class="at">coef =</span> <span class="st">'month_num_c'</span>),</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'lkj(1.5)'</span>, <span class="at">class =</span> <span class="st">'cor'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>),</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(.15, .15)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(0, .5)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, k = 5)'</span>),</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = q_unclosed_c, k = 5)'</span>),</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = team_size_c, k = 5)'</span>),</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_avg_coding_days_per_week_c, k = 3)'</span>),</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_total_merged_prs_c, k = 3)'</span>),</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_defect_tickets_pct_indiv_c, k = 3)'</span>),</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_degree_centrality_monthly_100_c, k = 3)'</span>),</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_comments_per_pr_c, k = 3)'</span>))</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_ptyp_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="st">'normal(0,.1)'</span>, <span class="at">class =</span> <span class="st">'b'</span>),</span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">prior</span>(<span class="st">'normal(14, 2.5)'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">prior</span>(<span class="st">'normal(.1, .75)'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">prior</span>(<span class="st">'normal(.15, .15)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">prior</span>(<span class="st">'normal(0, .5)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, k = 5)'</span>),</span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = q_unclosed_c, k = 5)'</span>),</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = team_size_c, k = 5)'</span>),</span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_avg_coding_days_per_week_c, k = 3)'</span>),</span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_total_merged_prs_c, k = 3)'</span>),</span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_defect_tickets_pct_indiv_c, k = 3)'</span>),</span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_degree_centrality_monthly_100_c, k = 3)'</span>),</span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = yr_avg_comments_per_pr_c, k = 3)'</span>))</span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>cycle_time_full_ptyp_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="st">'normal(0,.1)'</span>, <span class="at">class =</span> <span class="st">'b'</span>),</span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(14, 2.5)'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(.1, .75)'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(.15, .15)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(0, .5)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, k = 5)'</span>),</span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = q_unclosed_c, k = 5)'</span>),</span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior</span>(<span class="st">'normal(0, .25)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, by = team_size_c, k = 5)'</span>))</span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a>growth_ptyp_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="st">'normal(0,.1)'</span>, <span class="at">class =</span> <span class="st">'b'</span>),</span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">prior</span>(<span class="st">'normal(14, 2.5)'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">prior</span>(<span class="st">'normal(.1, .75)'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">prior</span>(<span class="st">'normal(.15, .15)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">prior</span>(<span class="st">'normal(0, .5)'</span>, <span class="at">class =</span> <span class="st">'sds'</span>, <span class="at">coef =</span> <span class="st">'s(month_num_c, k = 5)'</span>))</span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a>growth_ptyp_shape_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="st">'normal(14, 2.5)'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">prior</span>(<span class="st">'normal(.1, .75)'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">class =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">prior</span>(<span class="st">'normal(.15, .25)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac:user_id_fac'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>),</span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">prior</span>(<span class="st">'normal(.15, .15)'</span>, <span class="at">class =</span> <span class="st">'sd'</span>, <span class="at">group =</span> <span class="st">'org_id_fac'</span>, <span class="at">dpar =</span> <span class="st">'shape'</span>, <span class="at">coef =</span> <span class="st">'Intercept'</span>))</span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_prior <span class="ot">&lt;-</span> cycle_time_full_intx_ptyp_prior</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</div>
</div>
</div>
</section>
<section id="non-linear-predictors-interacting-with-non-linear-unclosed-control-full-data" class="level3">
<h3 class="anchored" data-anchor-id="non-linear-predictors-interacting-with-non-linear-unclosed-control-full-data">Non-linear Predictors interacting with non-linear unclosed control (Full data)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Prior check</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Model fit</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">Table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false" href="">Plot model expectations</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell-container"><div class="cell-decorator"><pre>In [21]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_prior_m <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> cycle_time_full_intx_nlq_f, <span class="at">data =</span> month_level_dt, <span class="at">prior =</span> cycle_time_full_intx_nlq_prior,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">file =</span> <span class="st">'cycle_time_full_intx_nlq_prior'</span>,   </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">sample_prior =</span> <span class="st">'only'</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">750</span>, <span class="at">warmup =</span> <span class="dv">500</span>, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">init =</span> <span class="dv">0</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">backend =</span> <span class="st">'cmdstanr'</span>, <span class="at">silent =</span> <span class="dv">0</span>, <span class="at">refresh =</span> <span class="dv">500</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">file_refit =</span> <span class="st">'never'</span>, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">stan_model_args =</span> <span class="fu">list</span>(<span class="at">cpp_options =</span> <span class="fu">list</span>(</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">PRECOMPILED_HEADERS =</span> <span class="cn">FALSE</span>, <span class="at">STAN_CPP_OPTIMS =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"CXXFLAGS+= -O1 -march=native -mtune=native"</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"CXXFLAGS+= -DEIGEN_USE_BLAS -DEIGEN_USE_LAPACKE"</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"LDLIBS += -lblas -llapack -llapacke"</span>), </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">force_recompile =</span> <span class="cn">TRUE</span>))</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cycle_time_full_intx_nlq_prior_m)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_prior_pred <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(cycle_time_full_intx_nlq_prior_m)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_prior_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(<span class="fu">t</span>(cycle_time_full_intx_nlq_prior_pred))</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_prior_l <span class="ot">&lt;-</span> <span class="fu">melt</span>(cycle_time_full_intx_nlq_prior_dt, </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">measure.vars =</span> <span class="fu">names</span>(cycle_time_full_intx_nlq_prior_dt), </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">variable.name =</span> <span class="st">'iter'</span>, <span class="at">value.name =</span> <span class="st">'y_hat'</span>)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycle_time_full_intx_nlq_prior_l, <span class="fu">aes</span>(<span class="at">x =</span> y_hat)) <span class="sc">+</span> </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">200</span>, <span class="at">fill =</span> <span class="st">'blue'</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> median_cycle_time_s, <span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">data =</span> month_level_dt,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">200</span>, <span class="at">fill =</span> <span class="st">'gray'</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">modulus_trans</span>(<span class="at">p =</span> <span class="sc">-</span><span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  theme_clean</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(cycle_time_full_intx_nlq_prior_m)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="co"># growth_ptyp_shape_prior_pp &lt;- pp_check(growth_ptyp_shape_prior_m)</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="co"># growth_ptyp_shape_prior_pp + scale_y_log10()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [22]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get objects matching the pattern</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>matching_objects <span class="ot">&lt;-</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">'_prior_(l|dt|pred)$'</span>, <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a logical vector indicating which objects inherit from 'data.frame'</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>is_data <span class="ot">&lt;-</span> <span class="fu">sapply</span>(matching_objects, <span class="cf">function</span>(x) <span class="fu">inherits</span>(<span class="fu">get</span>(x, <span class="at">envir =</span> .GlobalEnv), <span class="st">'data.frame'</span>) <span class="sc">|</span> <span class="fu">inherits</span>(<span class="fu">get</span>(x, <span class="at">envir =</span> .GlobalEnv), <span class="st">'array'</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(is_data) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">rm</span>(<span class="at">list =</span> matching_objects[is_data])</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">'_m$'</span>))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>(<span class="at">verbose =</span> <span class="cn">TRUE</span>, <span class="at">full =</span> <span class="cn">TRUE</span>, <span class="at">reset =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell-container"><div class="cell-decorator"><pre>In [23]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>make_init <span class="ot">&lt;-</span> <span class="cf">function</span>(N_org, N_user){</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(){</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">Intercept =</span> <span class="dv">14</span>, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">b =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">12</span>),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">bs =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">16</span>), </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">zs_1_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">sds_1 =</span> .<span class="dv">1</span>, </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">zs_2_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">sds_2 =</span> .<span class="dv">1</span>, </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">zs_3_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">sds_3 =</span> .<span class="dv">1</span>, </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">zs_4_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">sds_4 =</span> .<span class="dv">1</span>, </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">zs_5_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">sds_5 =</span> .<span class="dv">1</span>, </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">zs_6_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">sds_6 =</span> .<span class="dv">1</span>, </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">zs_7_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">sds_7 =</span> .<span class="dv">1</span>, </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">zs_8_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">sds_8 =</span> .<span class="dv">1</span>, </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">zs_9_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">sds_9 =</span> .<span class="dv">1</span>, </span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">Intercept_shape =</span> .<span class="dv">29</span>, </span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>             <span class="co">#org</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">sd_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">z_1 =</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, N_org<span class="sc">*</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>),</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">L_1 =</span> <span class="fu">t</span>(<span class="fu">chol</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">2</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))),</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>             <span class="co">#user</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">sd_2 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">z_2 =</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, N_user<span class="sc">*</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>),</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">L_2 =</span> <span class="fu">t</span>(<span class="fu">chol</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">2</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))),</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>             <span class="co">#org</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">sd_3 =</span> .<span class="dv">1</span>, </span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">z_3 =</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, N_org), <span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>init <span class="ot">&lt;-</span> <span class="fu">make_init</span>(<span class="fu">length</span>(<span class="fu">unique</span>(month_level_dt<span class="sc">$</span>org_id_fac)),</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(<span class="fu">unique</span>(month_level_dt<span class="sc">$</span>user_id_fac)))</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> cycle_time_full_intx_nlq_f, <span class="at">data =</span> month_level_dt, <span class="at">prior =</span> cycle_time_full_intx_nlq_prior,</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">file =</span> <span class="st">'cycle_time_full_intx_nlq'</span>,   </span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>                <span class="co"># control = list(adapt_delta = .99, max_treedepth = 20),</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>                <span class="at">sample_prior =</span> <span class="st">'no'</span>,</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>                <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, </span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">cores =</span> <span class="dv">1</span>, <span class="at">threads =</span> <span class="dv">19</span>, </span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>                <span class="at">init =</span> init,</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>                <span class="at">backend =</span> <span class="st">'cmdstanr'</span>, <span class="at">silent =</span> <span class="dv">0</span>, <span class="at">refresh =</span> <span class="dv">1</span>,</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">file_refit =</span> <span class="st">'never'</span>, </span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>                <span class="at">stan_model_args =</span> <span class="fu">list</span>(<span class="at">cpp_options =</span> <span class="fu">list</span>(</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>                  <span class="at">PRECOMPILED_HEADERS =</span> <span class="cn">FALSE</span>, <span class="at">STAN_CPP_OPTIMS =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"CXXFLAGS+= -O1 -march=native -mtune=native"</span>,</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"CXXFLAGS+= -DEIGEN_USE_BLAS -DEIGEN_USE_LAPACKE"</span>,</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"LDLIBS += -lblas -llapack -llapacke"</span>), </span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>                  <span class="at">force_recompile =</span> <span class="cn">TRUE</span>))</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(cycle_time_full_intx_nlq_m)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [24]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">traceplot_manyvars</span>(cycle_time_full_intx_nlq_m, <span class="at">variables =</span> <span class="fu">variables</span>(cycle_time_full_intx_nlq_m)[<span class="dv">1</span><span class="sc">:</span><span class="dv">46</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell-container"><div class="cell-decorator"><pre>In [25]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>apa <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">|&gt;</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.top.color =</span> <span class="st">"white"</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="fu">px</span>(<span class="dv">16</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.width =</span> <span class="dv">3</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.bottom.width =</span> <span class="dv">3</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">table_body.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.bottom.color =</span> <span class="st">"white"</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">100</span>),</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.background.color =</span> <span class="st">"white"</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="at">align=</span><span class="st">"auto"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_borders</span>(</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">sides =</span> <span class="fu">c</span>(<span class="st">"top"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">weight =</span> <span class="fu">px</span>(<span class="dv">1</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="cn">NULL</span>)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="fu">everything</span>()</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_draws <span class="ot">&lt;-</span> <span class="fu">brms_to_draws</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">variables =</span> <span class="fu">variables</span>(cycle_time_full_intx_nlq_m)[<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>])</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_pars <span class="ot">&lt;-</span> parameters<span class="sc">::</span><span class="fu">model_parameters</span>(cycle_time_full_intx_nlq_m_draws, </span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">centrality =</span> <span class="st">'median'</span>, <span class="at">ci =</span> .<span class="dv">95</span>, <span class="at">ci_method =</span> <span class="st">'hdi'</span>)</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(cycle_time_full_intx_nlq_m_pars) <span class="sc">|&gt;</span> </span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Model parameters"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">2</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">'Median'</span>, <span class="st">'CI_low'</span>, <span class="st">'CI_high'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="st">'pd'</span>, <span class="at">scale_by =</span> <span class="dv">100</span>, <span class="at">decimals =</span> <span class="dv">0</span>, <span class="at">pattern =</span> <span class="st">'{x}%'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">Median =</span> <span class="st">'Posterior Median'</span>,</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">CI_low =</span> <span class="st">'2.5% HDI'</span>,</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">CI_high =</span> <span class="st">'97.5% HDI'</span>,</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>             <span class="at">pd =</span> <span class="fu">md</span>(<span class="st">'P(Sign)'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apa</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell-container"><div class="cell-decorator"><pre>In [26]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_ppcheck <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(cycle_time_full_intx_nlq_m)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_ppcheck <span class="sc">+</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_ppcheck <span class="sc">+</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">7.5e6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [27]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_nlq_m, <span class="st">'month_num_c'</span>, <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>)))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_nlq_m, <span class="st">'within_quarter_month_num_c'</span>, <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(.<span class="dv">25</span>, <span class="dv">10</span>)))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>q_unclosed_center <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">round</span>(month_level_dt<span class="sc">$</span>q_unclosed <span class="sc">-</span> month_level_dt<span class="sc">$</span>q_unclosed_c, <span class="dv">5</span>))[[<span class="dv">1</span>]]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_nlq_m, <span class="fu">list</span>(<span class="st">'month_num_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">12</span>, <span class="dv">3</span>)) <span class="sc">-</span> <span class="dv">7</span>, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">'q_unclosed_c'</span> <span class="ot">=</span> <span class="fu">round</span>(</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                                                        <span class="fu">quantile</span>(cycle_time_full_intx_nlq_m<span class="sc">$</span>data<span class="sc">$</span>q_unclosed_c, </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">5</span>, .<span class="dv">9</span>)), </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                                                        <span class="dv">1</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>                                                      )), <span class="at">translabels.x =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(<span class="dv">7</span>), </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>                                                                             <span class="fu">create_label_transform</span>(q_unclosed_center,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>                                                                                                    <span class="at">inverse_logit =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_nlq_m, <span class="fu">c</span>(<span class="st">'month_num_c'</span>, <span class="st">'team_size_c'</span>))</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>yr_avg_avg_coding_days_per_week_center <span class="ot">&lt;-</span> <span class="fu">get_center</span>(month_level_dt, <span class="st">'yr_avg_avg_coding_days_per_week'</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'wi_avg_coding_days_per_week'</span>, </span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">10</span>)), </span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Coding days per week</span><span class="sc">\n</span><span class="st">(within-person deviation)'</span>,</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>))) <span class="sc">+</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">list</span>(<span class="st">'month_num_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">7</span>,</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'yr_avg_avg_coding_days_per_week_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>) <span class="sc">-</span> yr_avg_avg_coding_days_per_week_center),</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">10</span>)),</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.x =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(<span class="dv">7</span>),</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">create_label_transform</span>(yr_avg_avg_coding_days_per_week_center)),</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Month'</span>,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>,</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Avg coding</span><span class="sc">\n</span><span class="st">days/week'</span>,</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Avg coding</span><span class="sc">\n</span><span class="st">days/week'</span>),</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>,</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">x =</span> <span class="st">'Average coding days per week'</span>,</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Month'</span>,</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Month'</span>)),</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>                       <span class="at">patchwork_args =</span> <span class="fu">list</span>(<span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> <span class="st">'AB'</span>)</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>yr_avg_total_merged_prs_center <span class="ot">&lt;-</span> <span class="fu">get_center</span>(month_level_dt, <span class="st">'yr_avg_total_merged_prs'</span>)</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'wi_total_merged_prs'</span>,</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>                     <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">10</span>)), </span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>                     <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Total merged PRs</span><span class="sc">\n</span><span class="st">(within-person deviation)'</span>,</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>))) <span class="sc">+</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">list</span>(<span class="st">'month_num_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">7</span>, </span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'yr_avg_total_merged_prs_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">100</span>) <span class="sc">-</span> yr_avg_total_merged_prs_center),</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.x =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(<span class="dv">7</span>),</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">create_label_transform</span>(yr_avg_total_merged_prs_center)),</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>                       <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Month'</span>,</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>,</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Total merged PRs'</span>,</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Total merged PRs'</span>),</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>,</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">x =</span> <span class="st">'Total merged PRs'</span>,</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Month'</span>,</span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Month'</span>)),</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>                       <span class="at">patchwork_args =</span> <span class="fu">list</span>(<span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> <span class="st">'AB'</span>)</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>yr_avg_defect_tickets_pct_indiv_center <span class="ot">&lt;-</span> <span class="fu">get_center</span>(month_level_dt, <span class="st">'yr_avg_defect_tickets_pct_indiv'</span>)</span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'wi_defect_tickets_pct_indiv'</span>,</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>                     <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>)),</span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>                     <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Defect ticket percent</span><span class="sc">\n</span><span class="st">(within-person deviation)'</span>,</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>))) <span class="sc">+</span> </span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">list</span>(<span class="st">'month_num_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">7</span>, </span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'yr_avg_defect_tickets_pct_indiv_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>) <span class="sc">-</span> yr_avg_defect_tickets_pct_indiv_center),</span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.x =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(<span class="dv">7</span>),</span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">create_label_transform</span>(yr_avg_defect_tickets_pct_indiv_center)),</span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>                       <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Month'</span>,</span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>,</span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Defect ticket percent'</span>,</span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Defect ticket percent'</span>),</span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>,</span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">x =</span> <span class="st">'Defect ticket percent'</span>,</span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Month'</span>,</span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Month'</span>)),</span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>                       <span class="at">patchwork_args =</span> <span class="fu">list</span>(<span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> <span class="st">'AB'</span>)</span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>yr_avg_degree_centrality_monthly_100_center <span class="ot">&lt;-</span> <span class="fu">get_center</span>(month_level_dt, <span class="st">'yr_avg_degree_centrality_monthly_100'</span>)</span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'wi_degree_centrality_monthly_100'</span>,</span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>                     <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span>)),</span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>                     <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Degree centrality</span><span class="sc">\n</span><span class="st">(within-person deviation)'</span>,</span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>))) <span class="sc">+</span> </span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">list</span>(<span class="st">'month_num_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">7</span>, </span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'yr_avg_degree_centrality_monthly_100_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>) <span class="sc">-</span> yr_avg_degree_centrality_monthly_100_center), </span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.x =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(<span class="dv">7</span>),</span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">create_label_transform</span>(yr_avg_degree_centrality_monthly_100_center)),</span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>                       <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Month'</span>,</span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>,</span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Degree centrality'</span>,</span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Degree centrality'</span>),</span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>,</span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">x =</span> <span class="st">'Degree centrality'</span>,</span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Month'</span>,</span>
<span id="cb27-101"><a href="#cb27-101" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Month'</span>)),</span>
<span id="cb27-102"><a href="#cb27-102" aria-hidden="true" tabindex="-1"></a>                       <span class="at">patchwork_args =</span> <span class="fu">list</span>(<span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb27-103"><a href="#cb27-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> <span class="st">'AB'</span>)</span>
<span id="cb27-104"><a href="#cb27-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-105"><a href="#cb27-105" aria-hidden="true" tabindex="-1"></a>yr_avg_comments_per_pr_center <span class="ot">&lt;-</span> <span class="fu">get_center</span>(month_level_dt, <span class="st">'yr_avg_comments_per_pr'</span>)</span>
<span id="cb27-106"><a href="#cb27-106" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb27-107"><a href="#cb27-107" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'wi_comments_per_pr'</span>,</span>
<span id="cb27-108"><a href="#cb27-108" aria-hidden="true" tabindex="-1"></a>                     <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">10</span>)),</span>
<span id="cb27-109"><a href="#cb27-109" aria-hidden="true" tabindex="-1"></a>                     <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Comments per PR</span><span class="sc">\n</span><span class="st">(within-person deviation)'</span>,</span>
<span id="cb27-110"><a href="#cb27-110" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>))) <span class="sc">+</span> </span>
<span id="cb27-111"><a href="#cb27-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb27-112"><a href="#cb27-112" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">list</span>(<span class="st">'month_num_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">7</span>, </span>
<span id="cb27-113"><a href="#cb27-113" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'yr_avg_comments_per_pr_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">12</span>, <span class="dv">18</span>) <span class="sc">-</span> yr_avg_comments_per_pr_center), </span>
<span id="cb27-114"><a href="#cb27-114" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.x =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(<span class="dv">7</span>),</span>
<span id="cb27-115"><a href="#cb27-115" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">create_label_transform</span>(yr_avg_comments_per_pr_center)),</span>
<span id="cb27-116"><a href="#cb27-116" aria-hidden="true" tabindex="-1"></a>                       <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Month'</span>,</span>
<span id="cb27-117"><a href="#cb27-117" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>,</span>
<span id="cb27-118"><a href="#cb27-118" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Comments per PR'</span>,</span>
<span id="cb27-119"><a href="#cb27-119" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Comments per PR'</span>),</span>
<span id="cb27-120"><a href="#cb27-120" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>,</span>
<span id="cb27-121"><a href="#cb27-121" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">x =</span> <span class="st">'Comments per PR'</span>,</span>
<span id="cb27-122"><a href="#cb27-122" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Month'</span>,</span>
<span id="cb27-123"><a href="#cb27-123" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Month'</span>)),</span>
<span id="cb27-124"><a href="#cb27-124" aria-hidden="true" tabindex="-1"></a>                       <span class="at">patchwork_args =</span> <span class="fu">list</span>(<span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb27-125"><a href="#cb27-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> <span class="st">'AB'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [28]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(cycle_time_full_intx_nlq_m, <span class="at">re_formula =</span> <span class="cn">NULL</span>, <span class="at">ndraws =</span> <span class="dv">500</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_w_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.table</span>(cycle_time_full_intx_nlq_m<span class="sc">$</span>data), </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">as.data.table</span>(<span class="fu">t</span>(cycle_time_full_intx_nlq_pp_draws)))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l <span class="ot">&lt;-</span> <span class="fu">melt</span>(cycle_time_full_intx_nlq_pp_draws_w_data, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">'V'</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>)))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l[, N <span class="sc">:</span><span class="er">=</span> .N, by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'org_id_fac'</span>, <span class="st">'variable'</span>)]</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_filtered <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_pp_draws_l[N <span class="sc">&gt;</span> <span class="dv">10</span>]</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>mod_trans <span class="ot">&lt;-</span> scales<span class="sc">::</span><span class="fu">transform_modulus</span>(<span class="at">p =</span> .<span class="dv">325</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_filtered[, transformed_value <span class="sc">:</span><span class="er">=</span> mod_trans<span class="sc">$</span><span class="fu">transform</span>(value)]</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_density <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_pp_draws_l_filtered[</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  N <span class="sc">&gt;</span> <span class="dv">10</span>, </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fu">density</span>(transformed_value, <span class="at">n =</span> <span class="dv">50</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">x =</span> d<span class="sc">$</span>x, <span class="at">y =</span> d<span class="sc">$</span>y, <span class="at">median_x =</span> <span class="fu">suppressWarnings</span>(<span class="fu">approx</span>(<span class="fu">cumsum</span>(d<span class="sc">$</span>y)<span class="sc">/</span><span class="fu">sum</span>(d<span class="sc">$</span>y), d<span class="sc">$</span>x, <span class="at">xout=</span><span class="fl">0.5</span>)<span class="sc">$</span>y), <span class="at">N =</span> <span class="fu">unique</span>(N))</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  }, </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'org_id_fac'</span>, <span class="st">'variable'</span>)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_density[, median_median_x <span class="sc">:</span><span class="er">=</span> <span class="fu">median</span>(median_x), by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'org_id_fac'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [29]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>N_col <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>get_col <span class="ot">&lt;-</span> <span class="cf">function</span>(ranks, n_rows, n_cols) {</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  base <span class="ot">&lt;-</span> <span class="fu">floor</span>(n_rows<span class="sc">/</span>n_cols)  <span class="co"># base rows per column</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  extra <span class="ot">&lt;-</span> n_rows <span class="sc">%%</span> n_cols     <span class="co"># how many columns need an extra row</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  cutoffs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="fu">rep</span>(base <span class="sc">+</span> <span class="dv">1</span>, extra), <span class="fu">rep</span>(base, n_cols <span class="sc">-</span> extra))))</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Map to columns based on ranks</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">findInterval</span>(ranks <span class="sc">-</span> <span class="dv">1</span>, cutoffs)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>unique_orders <span class="ot">&lt;-</span> <span class="fu">unique</span>(cycle_time_full_intx_nlq_pp_draws_l_density[, <span class="fu">c</span>(<span class="st">'org_id_fac'</span>, <span class="st">'N'</span>, <span class="st">'median_median_x'</span>)])</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>unique_orders[, N_rank <span class="sc">:</span><span class="er">=</span> <span class="fu">frankv</span>(.SD, <span class="at">ties.method =</span> <span class="st">'dense'</span>), .SDcols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'N'</span>, <span class="st">'org_id_fac'</span>)]</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>unique_orders[, col_num <span class="sc">:</span><span class="er">=</span> <span class="fu">get_col</span>(N_rank, .N, <span class="dv">4</span>) <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="fu">setorder</span>(unique_orders, col_num, median_median_x, org_id_fac)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>unique_orders[, I <span class="sc">:</span><span class="er">=</span> .I]</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>unique_orders[, row_num <span class="sc">:</span><span class="er">=</span> .N<span class="sc">:</span><span class="dv">1</span>, by <span class="ot">=</span> col_num]</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_density_orders <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_pp_draws_l_density[</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  unique_orders[, <span class="fu">c</span>(<span class="st">'org_id_fac'</span>, <span class="st">'col_num'</span>, <span class="st">'row_num'</span>, <span class="st">'I'</span>)], </span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  on <span class="ot">=</span> <span class="st">'org_id_fac'</span>]</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_density_orders[, org_id_fac <span class="sc">:</span><span class="er">=</span> <span class="fu">reorder</span>(org_id_fac, I, <span class="at">decreasing =</span> <span class="cn">FALSE</span>)]</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>y_separation <span class="ot">&lt;-</span> <span class="fu">max</span>(cycle_time_full_intx_nlq_pp_draws_l_density_orders<span class="sc">$</span>y)<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>y_mag <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_density_orders[, y_ridges <span class="sc">:</span><span class="er">=</span> (y<span class="sc">*</span>y_mag <span class="sc">+</span> y_separation<span class="sc">*</span>row_num)]</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_density_orders[, y_ridges_min <span class="sc">:</span><span class="er">=</span> y_separation<span class="sc">*</span>row_num]</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>breaks_seconds_to_days <span class="ot">&lt;-</span> mod_trans<span class="sc">$</span><span class="fu">transform</span>(<span class="fu">c</span>(<span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">12</span><span class="sc">*</span><span class="dv">1</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">4</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">1</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">13</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">1</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">52</span>))</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(breaks_seconds_to_days) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"12h"</span>, <span class="st">"1w"</span>, <span class="st">"4w"</span>, <span class="st">"1q"</span>, <span class="st">"1y"</span>)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_density_orders_filtered <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_pp_draws_l_density_orders[variable <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">'V'</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>)]</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycle_time_full_intx_nlq_pp_draws_l_density_orders_filtered, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y_ridges, <span class="at">group =</span> <span class="fu">interaction</span>(org_id_fac, variable))) <span class="sc">+</span> </span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> breaks_seconds_to_days[<span class="st">'4w'</span>], <span class="at">xend =</span> breaks_seconds_to_days[<span class="st">'4w'</span>],</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="fu">max</span>(cycle_time_full_intx_nlq_pp_draws_l_density_orders_filtered<span class="sc">$</span>y_ridges), </span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> viridis<span class="sc">::</span><span class="fu">mako</span>(<span class="dv">1</span>, <span class="at">begin =</span> .<span class="dv">2</span>),</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> y_ridges_min, <span class="at">ymax =</span> y_ridges, <span class="at">fill =</span> N), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> .<span class="dv">05</span>, <span class="at">alpha =</span> .<span class="dv">25</span>, <span class="at">color =</span> viridis<span class="sc">::</span><span class="fu">mako</span>(<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> breaks_seconds_to_days, <span class="at">labels =</span> <span class="fu">names</span>(breaks_seconds_to_days)) <span class="sc">+</span> </span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">quantile</span>(cycle_time_full_intx_nlq_pp_draws_l_density_orders_filtered<span class="sc">$</span>x, .<span class="dv">975</span>))) <span class="sc">+</span> </span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>col_num) <span class="sc">+</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),  </span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(),</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> font_name, <span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">'mako'</span>, <span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">transform_modulus</span>(<span class="at">p =</span> .<span class="dv">1</span>), </span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">min</span>(cycle_time_full_intx_nlq_pp_draws_l_density_orders_filtered<span class="sc">$</span>N), </span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">100</span>, <span class="dv">1000</span>, </span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">max</span>(cycle_time_full_intx_nlq_pp_draws_l_density_orders_filtered<span class="sc">$</span>N)),</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">c</span>(<span class="fu">min</span>(cycle_time_full_intx_nlq_pp_draws_l_density_orders_filtered<span class="sc">$</span>N), </span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">100</span>, <span class="dv">1000</span>, </span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">max</span>(cycle_time_full_intx_nlq_pp_draws_l_density_orders_filtered<span class="sc">$</span>N)), <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>                       <span class="at">begin =</span> .<span class="dv">2</span>,</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>                         <span class="at">barwidth =</span> .<span class="dv">5</span>,</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>                         <span class="at">barheight =</span> <span class="dv">5</span></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>                       )) <span class="sc">+</span> </span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Cycle time"</span>, <span class="at">y =</span> <span class="st">"Posterior prediction probability density"</span>)</span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_nlq_pp_check.png'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">'in'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [30]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_summary_density <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_pp_draws_l_filtered[</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  N <span class="sc">&gt;</span> <span class="dv">10</span>, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fu">density</span>(transformed_value, <span class="at">n =</span> <span class="dv">500</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">x =</span> d<span class="sc">$</span>x, <span class="at">y =</span> d<span class="sc">$</span>y)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  }, </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'variable'</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_summary_data <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(cycle_time_full_intx_nlq_m<span class="sc">$</span>data)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_summary_data[, N <span class="sc">:</span><span class="er">=</span> .N, by <span class="ot">=</span> org_id_fac]</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_summary_data <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_pp_draws_l_summary_data[N <span class="sc">&gt;</span> <span class="dv">10</span>]</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_summary_data[, median_cycle_time_s_modulus <span class="sc">:</span><span class="er">=</span> mod_trans<span class="sc">$</span><span class="fu">transform</span>(median_cycle_time_s)]</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>breakpoints <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(cycle_time_full_intx_nlq_pp_draws_l_summary_data<span class="sc">$</span>median_cycle_time_s_modulus),</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">max</span>(cycle_time_full_intx_nlq_pp_draws_l_summary_data<span class="sc">$</span>median_cycle_time_s_modulus), <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_summary_data[, intervals <span class="sc">:</span><span class="er">=</span> <span class="fu">findInterval</span>(median_cycle_time_s_modulus, breakpoints)]</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>bin_width <span class="ot">&lt;-</span> <span class="fu">diff</span>(breakpoints)[<span class="dv">1</span>]  <span class="co"># Width of each bin</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(cycle_time_full_intx_nlq_pp_draws_l_summary_data)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_summary_data_hist <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_pp_draws_l_summary_data[, .(<span class="at">density =</span> .N <span class="sc">/</span> (bin_width<span class="sc">*</span>total_n)), by <span class="ot">=</span> intervals]</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="fu">setorder</span>(cycle_time_full_intx_nlq_pp_draws_l_summary_data_hist, intervals)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>breakpoints_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">bin_value =</span> breakpoints[<span class="sc">-</span><span class="dv">1</span>], <span class="at">intervals =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(breakpoints[<span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_summary_data_hist <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_pp_draws_l_summary_data_hist[breakpoints_dt, on <span class="ot">=</span> <span class="st">'intervals'</span>]</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_pp_draws_l_summary_data_hist[, density <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(<span class="fu">is.na</span>(density), <span class="dv">0</span>, density)]</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycle_time_full_intx_nlq_pp_draws_l_summary_density, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">group =</span> variable)) <span class="sc">+</span> </span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">data =</span> cycle_time_full_intx_nlq_pp_draws_l_summary_data_hist, <span class="fu">aes</span>(<span class="at">x =</span> bin_value, <span class="at">y =</span> density, <span class="at">group =</span> <span class="cn">NULL</span>),</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> viridis<span class="sc">::</span><span class="fu">mako</span>(<span class="dv">1</span>, <span class="at">begin =</span> .<span class="dv">35</span>)) <span class="sc">+</span> </span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> y), <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">fill =</span> viridis<span class="sc">::</span><span class="fu">mako</span>(<span class="dv">1</span>, <span class="at">begin =</span> .<span class="dv">65</span>), <span class="at">alpha =</span> <span class="fl">0.025</span>) <span class="sc">+</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> .<span class="dv">015</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">color =</span> viridis<span class="sc">::</span><span class="fu">mako</span>(<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> breaks_seconds_to_days, <span class="at">labels =</span> <span class="fu">names</span>(breaks_seconds_to_days)) <span class="sc">+</span> </span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">quantile</span>(cycle_time_full_intx_nlq_pp_draws_l_summary_density<span class="sc">$</span>x, .<span class="dv">60</span>))) <span class="sc">+</span> </span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),  </span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(),</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> font_name, <span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Cycle time"</span>, <span class="at">y =</span> <span class="st">"Posterior prediction</span><span class="sc">\n</span><span class="st">probability density"</span>)</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_nlq_pp_check_summary.png'</span>, <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">'in'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [31]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>re_draws_org_fn <span class="ot">&lt;-</span> <span class="st">'cycle_time_full_intx_nlq_draws_re_sum.rds'</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>re_draws_id_fn <span class="ot">&lt;-</span> <span class="st">'cycle_time_full_intx_nlq_draws_uidre_sum.rds'</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(re_draws_org_fn)){</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_nlq_draws_re <span class="ot">&lt;-</span> <span class="fu">spread_draws</span>(cycle_time_full_intx_nlq_m, r_org_id_fac[org_id_fac,par])</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_nlq_draws_re_sum <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">summarize_draws</span>(cycle_time_full_intx_nlq_draws_re, median, <span class="sc">~</span>posterior<span class="sc">::</span><span class="fu">quantile2</span>(.x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="fl">-.8</span>, (<span class="dv">1</span><span class="fl">+.8</span>))<span class="sc">/</span><span class="dv">2</span>), <span class="sc">~</span>posterior<span class="sc">::</span><span class="fu">quantile2</span>(.x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="fl">-.5</span>, (<span class="dv">1</span><span class="fl">+.5</span>))<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(cycle_time_full_intx_nlq_draws_re_sum, re_draws_org_fn)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_nlq_draws_re_sum <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(re_draws_org_fn)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(re_draws_id_fn)){</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_nlq_draws_uidre <span class="ot">&lt;-</span> <span class="fu">spread_draws</span>(cycle_time_full_intx_nlq_m, <span class="st">`</span><span class="at">r_.*user_id_fac</span><span class="st">`</span>[org_id_fac,par], <span class="at">regex =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_nlq_draws_uidre_sum <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">summarize_draws</span>(cycle_time_full_intx_nlq_draws_uidre, median, <span class="sc">~</span>posterior<span class="sc">::</span><span class="fu">quantile2</span>(.x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="fl">-.8</span>, (<span class="dv">1</span><span class="fl">+.8</span>))<span class="sc">/</span><span class="dv">2</span>), <span class="sc">~</span>posterior<span class="sc">::</span><span class="fu">quantile2</span>(.x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="fl">-.5</span>, (<span class="dv">1</span><span class="fl">+.5</span>))<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_nlq_draws_uidre_sum <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(cycle_time_full_intx_nlq_draws_uidre_sum)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(cycle_time_full_intx_nlq_draws_uidre_sum, re_draws_id_fn)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_nlq_draws_uidre_sum <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(re_draws_id_fn)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [32]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_draws_uidre_sum[, order <span class="sc">:</span><span class="er">=</span> <span class="fu">rank</span>(median), by <span class="ot">=</span> <span class="st">'par'</span>]</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_draws_uidre_sum[, pp <span class="sc">:</span><span class="er">=</span> order <span class="sc">/</span> (.N <span class="sc">+</span> <span class="dv">1</span>), by <span class="ot">=</span> <span class="st">'par'</span>]</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_draws_uidre_sum[, qq <span class="sc">:</span><span class="er">=</span> <span class="fu">qnorm</span>(pp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sd</span>(median)), by <span class="ot">=</span> <span class="st">'par'</span>]</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycle_time_full_intx_nlq_draws_uidre_sum, <span class="fu">aes</span>(<span class="at">x =</span> order)) <span class="sc">+</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_interval</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> q10, <span class="at">ymax =</span> q90), <span class="at">size =</span> .<span class="dv">125</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> .<span class="dv">25</span>, <span class="at">orientation =</span> <span class="st">'vertical'</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_interval</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> q25, <span class="at">ymax =</span> q75), <span class="at">size =</span> .<span class="dv">25</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> .<span class="dv">25</span>, <span class="at">orientation =</span> <span class="st">'vertical'</span>) <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> qq), <span class="at">color =</span> <span class="st">'white'</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(par<span class="sc">~</span>., <span class="at">scales =</span> <span class="st">'free_y'</span>) <span class="sc">+</span> </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  theme_clean <span class="sc">+</span> </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Individual deviation from population parameter'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [33]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_draws_uidre_sum_l <span class="ot">&lt;-</span> <span class="fu">melt</span>(cycle_time_full_intx_nlq_draws_uidre_sum[, <span class="fu">c</span>(<span class="st">'median'</span>, <span class="st">'q10'</span>, <span class="st">'q25'</span>, <span class="st">'q75'</span>, <span class="st">'q90'</span>, <span class="st">'par'</span>, <span class="st">'org_id_fac'</span>)], </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">'median'</span>, <span class="st">'q10'</span>, <span class="st">'q25'</span>, <span class="st">'q75'</span>, <span class="st">'q90'</span>), </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">variable.name =</span> <span class="st">'quantile'</span>, <span class="at">value.name =</span> <span class="st">'y_hat'</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_draws_uidre_sum_l[, var <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(par, <span class="st">'_'</span>, quantile)]</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_draws_uidre_sum_w <span class="ot">&lt;-</span> <span class="fu">dcast</span>(cycle_time_full_intx_nlq_draws_uidre_sum_l[, <span class="sc">-</span><span class="st">'par'</span>], org_id_fac <span class="sc">~</span> var, <span class="at">value.var =</span> <span class="st">'y_hat'</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycle_time_full_intx_nlq_draws_uidre_sum_w, <span class="fu">aes</span>(<span class="at">x =</span> Intercept_median, <span class="at">y =</span> month_num_c_median)) <span class="sc">+</span> </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> Intercept_q25, <span class="at">xend =</span> Intercept_q75), <span class="at">size =</span> .<span class="dv">125</span>, <span class="at">alpha =</span> .<span class="dv">35</span>) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> month_num_c_q25, <span class="at">yend =</span> month_num_c_q75), <span class="at">size =</span> .<span class="dv">125</span>, <span class="at">alpha =</span> .<span class="dv">35</span>) <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">bins =</span> <span class="dv">120</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">'fill'</span>, <span class="st">'color'</span>), <span class="at">option =</span> <span class="st">'plasma'</span>, <span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">modulus_trans</span>(<span class="at">p =</span> <span class="sc">-</span>.<span class="dv">3</span>),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  theme_clean <span class="sc">+</span> </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [34]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">34232</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(cycle_time_full_intx_nlq_m<span class="sc">$</span>data)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#using frank (fast rank)</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>quantile_labeler <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n_quantiles =</span> <span class="dv">20</span>){</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span> <span class="sc">+</span> (<span class="fu">frank</span>(x, <span class="at">ties.method =</span> <span class="st">"min"</span>)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%/%</span> (N<span class="sc">/</span>n_quantiles)) <span class="sc">/</span> n_quantiles</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data[, yr_avg_avg_coding_days_per_week_c_quantile <span class="sc">:</span><span class="er">=</span> <span class="fu">quantile_labeler</span>(yr_avg_avg_coding_days_per_week_c)]</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data[, wi_avg_coding_days_per_week_quantile <span class="sc">:</span><span class="er">=</span> <span class="fu">quantile_labeler</span>(wi_avg_coding_days_per_week)]</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data[, N_obs <span class="sc">:</span><span class="er">=</span> .N, by <span class="ot">=</span> <span class="st">'user_id_fac'</span>]</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(cycle_time_full_intx_nlq_m_data[N_obs <span class="sc">&gt;=</span> <span class="dv">4</span>, <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, <span class="st">'yr_avg_avg_coding_days_per_week_c_quantile'</span>)])</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>nsamples <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_ids[, yr_avg_avg_coding_days_per_week_c_subsample <span class="sc">:</span><span class="er">=</span> </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, nsamples), <span class="fu">rep</span>(<span class="dv">0</span>, .N<span class="sc">-</span>nsamples)), .N), </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>                                              by <span class="ot">=</span> yr_avg_avg_coding_days_per_week_c_quantile]</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cycle_time_full_intx_nlq_m_data_subsample_ids<span class="sc">$</span>yr_avg_avg_coding_days_per_week_c_subsample,</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>      cycle_time_full_intx_nlq_m_data_subsample_ids<span class="sc">$</span>yr_avg_avg_coding_days_per_week_c_quantile)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_ids <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_m_data_subsample_ids[</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  yr_avg_avg_coding_days_per_week_c_subsample <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_m_data[cycle_time_full_intx_nlq_m_data_subsample_ids, on <span class="ot">=</span> <span class="st">'user_id_fac'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [35]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>raw_data_ct_example_for_plot <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_m_data_subsample[, <span class="fu">CJ</span>(<span class="at">user_id_fac =</span> <span class="fu">unique</span>(user_id_fac), </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                                                                               <span class="at">month_num_c =</span> <span class="fu">unique</span>(month_num_c))]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>raw_data_ct_example_for_plot <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="fu">unique</span>(cycle_time_full_intx_nlq_m_data_subsample[, <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, <span class="st">'yr_avg_avg_coding_days_per_week_c_quantile'</span>)]),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                                      raw_data_ct_example_for_plot, </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">on =</span> <span class="fu">c</span>(<span class="st">'user_id_fac'</span>))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>raw_data_ct_example_for_plot <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="fu">unique</span>(cycle_time_full_intx_nlq_m_data_subsample[, <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                                                                                           <span class="st">'month_num_c'</span>, </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                                                                                           <span class="st">'median_cycle_time_s'</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                                                                                           <span class="st">'yr_avg_avg_coding_days_per_week_c'</span>)]),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>                                      raw_data_ct_example_for_plot, </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>med_med_ct <span class="ot">&lt;-</span> <span class="fu">median</span>(raw_data_ct_example_for_plot<span class="sc">$</span>median_cycle_time_s, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(raw_data_ct_example_for_plot[yr_avg_avg_coding_days_per_week_c_quantile <span class="sc">%in%</span> <span class="fu">seq</span>(.<span class="dv">05</span>, <span class="dv">1</span>, .<span class="dv">25</span>)], </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num_c, <span class="at">y =</span> median_cycle_time_s)) <span class="sc">+</span> </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> med_med_ct) <span class="sc">+</span> </span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac, <span class="at">color =</span> yr_avg_avg_coding_days_per_week_c), <span class="at">linewidth =</span> .<span class="dv">125</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">modulus_trans</span>(<span class="at">p =</span> .<span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">'plasma'</span>, <span class="at">end =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>yr_avg_avg_coding_days_per_week_c_quantile) <span class="sc">+</span> </span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [36]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>subsample_predictions <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(<span class="fu">predictions</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">newdata =</span> <span class="fu">unique</span>(cycle_time_full_intx_nlq_m_data_subsample),</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">re_formula =</span> <span class="cn">NULL</span>))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(cycle_time_full_intx_nlq_m_data_subsample)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_m_data_subsample[, <span class="fu">CJ</span>(<span class="at">user_id_fac =</span> <span class="fu">unique</span>(user_id_fac), </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                                                                                <span class="at">month_num_c =</span> <span class="fu">unique</span>(month_num_c))]</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot <span class="ot">&lt;-</span> <span class="fu">merge</span>(</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(cycle_time_full_intx_nlq_m_data_subsample[, <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, <span class="st">'yr_avg_avg_coding_days_per_week_c_quantile'</span>)]),</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>                                      pred_data_ct_example_for_plot, </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">on =</span> <span class="fu">c</span>(<span class="st">'user_id_fac'</span>))</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="fu">unique</span>(subsample_predictions[, <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'month_num_c'</span>, </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'estimate'</span>,</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'conf.low'</span>, <span class="st">'conf.high'</span>,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'yr_avg_avg_coding_days_per_week_c'</span>,</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'wi_avg_coding_days_per_week'</span>)]),</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>                                      pred_data_ct_example_for_plot, </span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>med_med_ct <span class="ot">&lt;-</span> <span class="fu">median</span>(pred_data_ct_example_for_plot<span class="sc">$</span>estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>mod_trans <span class="ot">&lt;-</span> scales<span class="sc">::</span><span class="fu">transform_modulus</span>(<span class="at">p =</span> .<span class="dv">325</span>)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>breaks_seconds_to_days <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">12</span><span class="sc">*</span><span class="dv">1</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">4</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">1</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">13</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">1</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">26</span>)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(breaks_seconds_to_days) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"12h"</span>, <span class="st">"1w"</span>, <span class="st">"4w"</span>, <span class="st">"1q"</span>, <span class="st">"6m"</span>)</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot[, quantile_name <span class="sc">:</span><span class="er">=</span> <span class="fu">reorder</span>(<span class="fu">sprintf</span>(<span class="st">'%.0f%% - %.0f%%'</span>, </span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>                                                                 yr_avg_avg_coding_days_per_week_c_quantile<span class="sc">*</span><span class="dv">100</span> <span class="sc">-</span> <span class="dv">5</span>,</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>                                                                 yr_avg_avg_coding_days_per_week_c_quantile<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>                                                         yr_avg_avg_coding_days_per_week_c_quantile)]</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_data_ct_example_for_plot[yr_avg_avg_coding_days_per_week_c_quantile <span class="sc">%in%</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">5</span>, .<span class="dv">85</span>, .<span class="dv">95</span>)], </span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num_c, <span class="at">y =</span> estimate)) <span class="sc">+</span> </span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> med_med_ct) <span class="sc">+</span> </span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">alpha =</span> .<span class="dv">025</span>) <span class="sc">+</span> </span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac), <span class="at">linewidth =</span> .<span class="dv">125</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> mod_trans, <span class="at">breaks =</span> breaks_seconds_to_days, <span class="at">labels =</span> <span class="fu">names</span>(breaks_seconds_to_days)) <span class="sc">+</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>quantile_name) <span class="sc">+</span> </span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Calendar time'</span>, <span class="at">y =</span> <span class="st">'Cycle time'</span>)</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_nlq_post_pred_ids.png'</span>, <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">'in'</span>)</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [37]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot_wi <span class="ot">&lt;-</span> <span class="fu">copy</span>(pred_data_ct_example_for_plot)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot_wi[, median_estimate <span class="sc">:</span><span class="er">=</span> <span class="fu">median</span>(estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), by <span class="ot">=</span> user_id_fac]</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot_wi[, <span class="fu">c</span>(<span class="st">'wi_estimate'</span>, <span class="st">'wi_conf.high'</span>, <span class="st">'wi_conf.low'</span>) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                                   .(estimate <span class="sc">-</span> median_estimate, conf.high <span class="sc">-</span> median_estimate, conf.low <span class="sc">-</span> median_estimate)]</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot_wi[, quantile_name <span class="sc">:</span><span class="er">=</span> <span class="fu">reorder</span>(<span class="fu">sprintf</span>(<span class="st">'%.0f%% - %.0f%%'</span>, </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                                                                 yr_avg_avg_coding_days_per_week_c_quantile<span class="sc">*</span><span class="dv">100</span> <span class="sc">-</span> <span class="dv">5</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                                                                 yr_avg_avg_coding_days_per_week_c_quantile<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>                                                         yr_avg_avg_coding_days_per_week_c_quantile)]</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_data_ct_example_for_plot_wi[yr_avg_avg_coding_days_per_week_c_quantile <span class="sc">%in%</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">5</span>, .<span class="dv">85</span>, .<span class="dv">95</span>)], </span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num_c, <span class="at">y =</span> wi_estimate)) <span class="sc">+</span> </span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac, <span class="at">ymin =</span> wi_conf.low, <span class="at">ymax =</span> wi_conf.high), <span class="at">alpha =</span> .<span class="dv">025</span>) <span class="sc">+</span> </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac, <span class="at">color =</span> wi_avg_coding_days_per_week), <span class="at">linewidth =</span> .<span class="dv">125</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> wi_avg_coding_days_per_week), <span class="at">size =</span> .<span class="dv">75</span>) <span class="sc">+</span> </span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">'plasma'</span>, <span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">modulus_trans</span>(<span class="at">p =</span> <span class="sc">-</span>.<span class="dv">5</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="fu">guide_colorbar</span>(<span class="at">direction =</span> <span class="st">"horizontal"</span>, <span class="at">title.position =</span> <span class="st">"top"</span>,</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">position =</span> <span class="st">'bottom'</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> mod_trans, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">rev</span>(breaks_seconds_to_days), breaks_seconds_to_days), </span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">'-'</span>, <span class="fu">rev</span>(<span class="fu">names</span>(breaks_seconds_to_days))), <span class="fu">names</span>(breaks_seconds_to_days))) <span class="sc">+</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>quantile_name) <span class="sc">+</span> </span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Calendar time'</span>, <span class="at">y =</span> <span class="st">'Deviation in cycle time'</span>, <span class="at">color =</span> <span class="st">'Within-person deviation in average coding days per week'</span>)</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_nlq_post_pred_ids_win.png'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">'in'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [38]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7331</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(cycle_time_full_intx_nlq_m_data[N_obs <span class="sc">==</span> <span class="dv">12</span>, <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, <span class="st">'yr_avg_avg_coding_days_per_week_c_quantile'</span>)])</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">#hist(cycle_time_full_intx_nlq_m_data_subsample_ids$yr_avg_avg_coding_days_per_week_c_quantile)</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>nsamples <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_ids[, yr_avg_avg_coding_days_per_week_c_subsample <span class="sc">:</span><span class="er">=</span> </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, nsamples), <span class="fu">rep</span>(<span class="dv">0</span>, .N<span class="sc">-</span>nsamples)), .N), </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                                              by <span class="ot">=</span> yr_avg_avg_coding_days_per_week_c_quantile]</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_ids <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_m_data_subsample_ids[</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  yr_avg_avg_coding_days_per_week_c_quantile <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">8</span>, .<span class="dv">7</span>, .<span class="dv">6</span>, .<span class="dv">5</span>, .<span class="dv">4</span>, .<span class="dv">3</span>, .<span class="dv">2</span>, .<span class="dv">1</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_ids <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_m_data_subsample_ids[</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  yr_avg_avg_coding_days_per_week_c_subsample <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample <span class="ot">&lt;-</span> cycle_time_full_intx_nlq_m_data[cycle_time_full_intx_nlq_m_data_subsample_ids, on <span class="ot">=</span> <span class="st">'user_id_fac'</span>]</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycle_time_full_intx_nlq_m_data_subsample, </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num_c, <span class="at">y =</span> median_cycle_time_s)) <span class="sc">+</span> </span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac, <span class="at">color =</span> yr_avg_avg_coding_days_per_week_c_quantile), <span class="at">linewidth =</span> .<span class="dv">5</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">modulus_trans</span>(<span class="at">p =</span> .<span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">end =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [39]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_posterior_summary <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(<span class="fu">posterior_epred</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                                                                                                 <span class="at">newdata =</span> cycle_time_full_intx_nlq_m_data_subsample,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                                                                                                 <span class="at">re_formula =</span> <span class="cn">NULL</span>))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_posterior_preds <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                                                                               <span class="at">newdata =</span> cycle_time_full_intx_nlq_m_data_subsample,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                                                                               <span class="at">re_formula =</span> <span class="cn">NULL</span>, <span class="at">ndraws =</span> <span class="dv">100</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_posterior_preds_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(cycle_time_full_intx_nlq_m_data_subsample,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="fu">as.data.table</span>(<span class="fu">t</span>(cycle_time_full_intx_nlq_m_data_subsample_posterior_preds)))</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_posterior_preds_data_l <span class="ot">&lt;-</span> <span class="fu">melt</span>(cycle_time_full_intx_nlq_m_data_subsample_posterior_preds_data,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="at">measure.vars =</span> <span class="fu">paste0</span>(<span class="st">'V'</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>))</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_posterior_summary <span class="ot">&lt;-</span> <span class="fu">cbind</span>(cycle_time_full_intx_nlq_m_data_subsample,</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>                                                                     <span class="fu">as.data.table</span>(cycle_time_full_intx_nlq_m_data_subsample_posterior_summary))</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>breaks_seconds_to_days <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">12</span><span class="sc">*</span><span class="dv">1</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">4</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">1</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">13</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">1</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">26</span>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(breaks_seconds_to_days) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"12h"</span>, <span class="st">"1w"</span>, <span class="st">"4w"</span>, <span class="st">"1q"</span>, <span class="st">"6m"</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_posterior_summary <span class="ot">&lt;-</span> month_level_dt[</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  , </span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">'yr_avg_avg_coding_days_per_week'</span>, <span class="st">'month_num_c'</span>, <span class="st">'user_id_fac'</span>, <span class="st">'org_id_fac'</span>)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>][</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_nlq_m_data_subsample_posterior_summary, </span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  on <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'month_num_c'</span>, <span class="st">'user_id_fac'</span>, <span class="st">'org_id_fac'</span>)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_posterior_summary[, user_id_fac_sorted <span class="sc">:</span><span class="er">=</span> <span class="fu">reorder</span>(user_id_fac, yr_avg_avg_coding_days_per_week)]</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_nlq_m_data_subsample_posterior_preds_data_l[, user_id_fac_sorted <span class="sc">:</span><span class="er">=</span> <span class="fu">reorder</span>(user_id_fac, yr_avg_avg_coding_days_per_week_c)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [40]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>real_data_and_prediction_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cycle_time_full_intx_nlq_m_data_subsample_posterior_summary, </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num_c, <span class="at">y =</span> median_cycle_time_s)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> median_cycle_time_s), <span class="at">linewidth =</span> .<span class="dv">125</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> median_cycle_time_s), <span class="at">size =</span> .<span class="dv">125</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> cycle_time_full_intx_nlq_m_data_subsample_posterior_preds_data_l,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">interaction</span>(user_id_fac_sorted, variable), <span class="at">y =</span> value), </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> .<span class="dv">15</span>, <span class="at">alpha =</span> .<span class="dv">0625</span>) <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>, <span class="at">group =</span> user_id_fac, <span class="at">fill =</span> yr_avg_avg_coding_days_per_week), </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> .<span class="dv">0625</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">color =</span> <span class="st">'white'</span>) <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">group =</span> user_id_fac), <span class="at">color =</span> <span class="st">'white'</span>, <span class="at">linewidth =</span> .<span class="dv">65</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">group =</span> user_id_fac, <span class="at">color =</span> yr_avg_avg_coding_days_per_week), <span class="at">linewidth =</span> .<span class="dv">5</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> mod_trans,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> breaks_seconds_to_days, <span class="at">labels =</span> <span class="fu">names</span>(breaks_seconds_to_days)) <span class="sc">+</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> user_id_fac_sorted, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">end =</span> .<span class="dv">7</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">'fill'</span>, <span class="st">'color'</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">'Year-average coding-days-per-week'</span>,</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_colorbar</span>(<span class="at">direction =</span> <span class="st">"horizontal"</span>, <span class="at">title.position =</span> <span class="st">"top"</span>,</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">position =</span> <span class="st">'bottom'</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="at">units =</span> <span class="st">'mm'</span>),</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>),</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">#legend.key.width = unit(0.4, "cm"),</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>)</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Calendar time'</span>, <span class="at">y =</span> <span class="st">'Cycle time'</span>) <span class="sc">+</span> </span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">25</span>))</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(real_data_and_prediction_plot)</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(real_data_and_prediction_plot, <span class="at">file =</span> <span class="st">'cycle_time_full_intx_nlq_post_pred_samples.png'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">'in'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [41]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>yr_avg_avg_coding_days_per_week_c_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    cycle_time_full_intx_nlq_m<span class="sc">$</span>data[</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>      , <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, <span class="st">'yr_avg_avg_coding_days_per_week_c'</span>)]</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  )[[<span class="st">'yr_avg_avg_coding_days_per_week_c'</span>]],</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, <span class="at">length.out =</span> <span class="dv">3</span>))</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>cf_data <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="fu">names</span>(yr_avg_avg_coding_days_per_week_c_quantiles),</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>         \(x){</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>           a_dt <span class="ot">&lt;-</span> <span class="fu">copy</span>(cycle_time_full_intx_nlq_m_data_subsample)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>           a_dt[, yr_avg_avg_coding_days_per_week_c <span class="sc">:</span><span class="er">=</span> <span class="fu">rep</span>(yr_avg_avg_coding_days_per_week_c_quantiles[x], .N)]</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>           a_dt[, quantiles <span class="sc">:</span><span class="er">=</span> <span class="fu">rep</span>(x, .N)]</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>           <span class="fu">return</span>(a_dt)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>         })</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>ndraws <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>cf_post_pred <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">newdata =</span> cf_data,</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">re_formula =</span> <span class="cn">NULL</span>, </span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ndraws =</span> ndraws)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>cf_post_epred_sum <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(<span class="fu">posterior_epred</span>(cycle_time_full_intx_nlq_m, </span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">newdata =</span> cf_data,</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">re_formula =</span> <span class="cn">NULL</span>))</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>cf_data_post_pred <span class="ot">&lt;-</span> <span class="fu">cbind</span>(cf_data,</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.data.table</span>(<span class="fu">t</span>(cf_post_pred)))</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>cf_data_post_epred <span class="ot">&lt;-</span> <span class="fu">cbind</span>(cf_data,</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">as.data.table</span>(cf_post_epred_sum))</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>cf_data_post_pred[, user_id_fac_sorted <span class="sc">:</span><span class="er">=</span> <span class="fu">reorder</span>(user_id_fac, yr_avg_avg_coding_days_per_week_c_quantile)]</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>cf_data_post_epred[, user_id_fac_sorted <span class="sc">:</span><span class="er">=</span> <span class="fu">reorder</span>(user_id_fac, yr_avg_avg_coding_days_per_week_c_quantile)]</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>cf_data_post_pred_l <span class="ot">&lt;-</span> <span class="fu">melt</span>(cf_data_post_pred, <span class="at">measure.vars =</span> <span class="fu">paste0</span>(<span class="st">'V'</span>, <span class="dv">1</span><span class="sc">:</span>ndraws))</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(cycle_time_full_intx_nlq_m_data_subsample_posterior_summary[, .(<span class="at">diff =</span> <span class="sc">-</span>yr_avg_avg_coding_days_per_week_c <span class="sc">+</span> yr_avg_avg_coding_days_per_week)])[[<span class="dv">1</span>]] <span class="sc">+</span> yr_avg_avg_coding_days_per_week_c_quantiles</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>cf_data_post_epred[, .(<span class="at">diff =</span> Estimate[quantiles <span class="sc">==</span> <span class="st">'50%'</span>] <span class="sc">-</span> Estimate[quantiles <span class="sc">==</span> <span class="st">'90%'</span>]), </span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>                   by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, <span class="st">'month_num_c'</span>)][, .(<span class="at">med_diff =</span> <span class="fu">median</span>(diff)), by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'user_id_fac'</span>)][</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>                     , .(<span class="at">med_diff =</span> <span class="fu">median</span>(med_diff) <span class="sc">/</span> (<span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span>))</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>                   ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [42]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>real_data_and_cf_prediction_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cf_data_post_pred_l, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num_c, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point(aes(group = interaction(variable, quantiles), color = quantiles), size = .25, alpha = .25) +</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bin2d</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">interaction</span>(quantiles, month_num_c), <span class="at">fill =</span> quantiles, <span class="at">alpha =</span> <span class="fu">after_stat</span>(count)), <span class="at">binwidth =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">25</span>), </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">preserve =</span> <span class="st">'total'</span>)) <span class="sc">+</span> </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(aes(group = interaction(variable, quantiles), color = quantiles), linewidth = .25, alpha = .0625) +</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> cf_data_post_epred, <span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">group =</span> quantiles), <span class="at">color =</span> <span class="st">'white'</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> cf_data_post_epred, <span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">group =</span> quantiles, <span class="at">color =</span> quantiles), <span class="at">linewidth =</span> .<span class="dv">75</span>) <span class="sc">+</span> </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> mod_trans,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> breaks_seconds_to_days, <span class="at">labels =</span> <span class="fu">names</span>(breaks_seconds_to_days)) <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(.<span class="dv">4</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">20</span>),</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">guide =</span> <span class="st">'none'</span>, <span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">transform_modulus</span>(<span class="at">p =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">'fill'</span>, <span class="st">'color'</span>), <span class="at">option =</span> <span class="st">'cividis'</span>, <span class="at">end =</span> .<span class="dv">7</span>,</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">'Counterfactual year-average-coding-days quantile'</span>,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">direction =</span> <span class="st">"horizontal"</span>, <span class="at">title.position =</span> <span class="st">"top"</span>,</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">position =</span> <span class="st">'bottom'</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(aesthetics = c('fill', 'color'), </span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                    breaks = c("10%", "50%", "90%"), </span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                    values = c("#29483A", "#759C44", "#DF3383"),</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                    name = 'Counterfactual Year Average Coding Days quantiles',</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                    guide = guide_legend(direction = "horizontal", title.position = "top",</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                           position = 'bottom', title.hjust = 0.5)) +</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> user_id_fac_sorted, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="at">units =</span> <span class="st">'mm'</span>),</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>),</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>),</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>)</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Calendar time'</span>, <span class="at">y =</span> <span class="st">'Cycle time'</span>) <span class="sc">+</span> </span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">25</span>))</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(real_data_and_cf_prediction_plot)</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(real_data_and_cf_prediction_plot, <span class="at">file =</span> <span class="st">'cycle_time_full_intx_nlq_post_pred_counterfactual.png'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">'in'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [43]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>combined_prediction_plot <span class="ot">&lt;-</span> real_data_and_prediction_plot <span class="sc">+</span> real_data_and_cf_prediction_plot <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">axis_titles =</span> <span class="st">'collect'</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_prediction_plot)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(combined_prediction_plot, <span class="at">file =</span> <span class="st">'cycle_time_full_intx_nlq_combined_post_pred_counterfactual.png'</span>, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">'in'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [44]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"marginaleffects_posterior_interval"</span> <span class="ot">=</span> <span class="st">"hdi"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"marginaleffects_posterior_center"</span> <span class="ot">=</span> <span class="st">"median"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>coding_days_comparisons_90_50 <span class="ot">&lt;-</span> marginaleffects<span class="sc">::</span><span class="fu">avg_comparisons</span>(</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_nlq_m,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">list</span>(<span class="at">yr_avg_avg_coding_days_per_week_c =</span> yr_avg_avg_coding_days_per_week_c_quantiles[<span class="dv">3</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> cycle_time_full_intx_nlq_m<span class="sc">$</span>data,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">250</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">re_formula =</span> <span class="cn">NULL</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>coding_days_comparisons_50_10 <span class="ot">&lt;-</span> marginaleffects<span class="sc">::</span><span class="fu">avg_comparisons</span>(</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_nlq_m,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">list</span>(<span class="at">yr_avg_avg_coding_days_per_week_c =</span> yr_avg_avg_coding_days_per_week_c_quantiles[<span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>]),</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> cycle_time_full_intx_nlq_m<span class="sc">$</span>data,</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">250</span>,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">re_formula =</span> <span class="cn">NULL</span>)</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>convert_s_to_d <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span>)</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>raw_median_cycle_time <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(cycle_time_full_intx_nlq_m<span class="sc">$</span>data)[, .(<span class="at">median_users =</span> <span class="fu">median</span>(median_cycle_time_s)), by <span class="ot">=</span> <span class="st">'user_id_fac'</span>][, .(<span class="at">median =</span> <span class="fu">median</span>(median_users))]<span class="sc">*</span>convert_s_to_d</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"A difference between the 50th and 90th quantile of coding days is associated with a difference of %.2f (95%% CI = [%.2f, %.2f]) in cycle time (refer to overall median cycle time: %.2f"</span>,</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>        coding_days_comparisons_90_50<span class="sc">$</span>estimate<span class="sc">*</span>convert_s_to_d, </span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>        coding_days_comparisons_90_50<span class="sc">$</span>conf.low<span class="sc">*</span>convert_s_to_d, </span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>        coding_days_comparisons_90_50<span class="sc">$</span>conf.high<span class="sc">*</span>convert_s_to_d,</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>        raw_median_cycle_time)</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"A difference between the 10th and 50th quantile of coding days is associated with a difference of %.2f (95%% CI = [%.2f, %.2f]) in cycle time (refer to overall median cycle time: %.2f"</span>,</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>        coding_days_comparisons_50_10<span class="sc">$</span>estimate<span class="sc">*</span>convert_s_to_d, </span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>        coding_days_comparisons_50_10<span class="sc">$</span>conf.low<span class="sc">*</span>convert_s_to_d, </span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>        coding_days_comparisons_50_10<span class="sc">$</span>conf.high<span class="sc">*</span>convert_s_to_d,</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>        raw_median_cycle_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<pre><code>[1] "A difference between the 50th and 90th quantile of coding days is associated with a difference of -2.10 (95% CI = [-2.74, -1.43]) in cycle time (refer to overall median cycle time: 13.01"
[1] "A difference between the 10th and 50th quantile of coding days is associated with a difference of -1.83 (95% CI = [-2.40, -1.14]) in cycle time (refer to overall median cycle time: 13.01"</code></pre>
<div class="cell-container"><div class="cell-decorator"><pre>In [45]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>coding_days_comparisons_90_50_by_month <span class="ot">&lt;-</span> marginaleffects<span class="sc">::</span><span class="fu">avg_comparisons</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_nlq_m,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">list</span>(<span class="at">yr_avg_avg_coding_days_per_week_c =</span> yr_avg_avg_coding_days_per_week_c_quantiles[<span class="dv">3</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'org_id_fac'</span>, <span class="st">'month_num_c'</span>),</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> cycle_time_full_intx_nlq_m<span class="sc">$</span>data,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">250</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">re_formula =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [46]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>coding_days_comparisons_90_50_by_month<span class="sc">$</span>org_id_fac_reorder <span class="ot">&lt;-</span> <span class="fu">reorder</span>(coding_days_comparisons_90_50_by_month<span class="sc">$</span>org_id_fac, coding_days_comparisons_90_50_by_month<span class="sc">$</span>estimate, <span class="at">FUN =</span> mean)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(coding_days_comparisons_90_50_by_month, <span class="fu">aes</span>(<span class="at">x =</span> month_num_c, <span class="at">y =</span> org_id_fac_reorder)) <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> estimate<span class="sc">*</span>convert_s_to_d)) <span class="sc">+</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">transform_modulus</span>(<span class="at">p =</span> <span class="sc">-</span>.<span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">5</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  theme_clean <span class="sc">+</span> </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="at">units =</span> <span class="st">'mm'</span>),</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>),</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>),</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Calendar time'</span>, <span class="at">y =</span> <span class="st">'Organization'</span>, <span class="at">fill =</span> <span class="st">'Change in</span><span class="sc">\n</span><span class="st">cycle time (days)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [47]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">'_m$'</span>))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</div>
</div>
</div>
</section>
<section id="linear-predictors-interacting-with-month-random-effect-full-data" class="level3">
<h3 class="anchored" data-anchor-id="linear-predictors-interacting-with-month-random-effect-full-data">Linear predictors interacting with “month” random effect (full data)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Prior check</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Model fit</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">Table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false" href="">Big pairs plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false" href="">Plot model expectations</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell-container"><div class="cell-decorator"><pre>In [48]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_prior_m <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> cycle_time_full_intx_lin_remonth_f, <span class="at">data =</span> month_level_dt, <span class="at">prior =</span> cycle_time_full_intx_lin_remonth_prior,</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">file =</span> <span class="st">'cycle_time_full_intx_lin_remonth_prior'</span>,    </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">sample_prior =</span> <span class="st">'only'</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">750</span>, <span class="at">warmup =</span> <span class="dv">500</span>, </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">init =</span> <span class="dv">0</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">backend =</span> <span class="st">'cmdstanr'</span>, <span class="at">silent =</span> <span class="dv">0</span>, <span class="at">refresh =</span> <span class="dv">500</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">file_refit =</span> <span class="st">'never'</span>, </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">stan_model_args =</span> <span class="fu">list</span>(<span class="at">cpp_options =</span> <span class="fu">list</span>(</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">PRECOMPILED_HEADERS =</span> <span class="cn">FALSE</span>, <span class="at">STAN_CPP_OPTIMS =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"CXXFLAGS+= -O1 -march=native -mtune=native"</span>,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"CXXFLAGS+= -DEIGEN_USE_BLAS -DEIGEN_USE_LAPACKE"</span>,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"LDLIBS += -lblas -llapack -llapacke"</span>), </span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">force_recompile =</span> <span class="cn">TRUE</span>))</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cycle_time_full_intx_lin_remonth_prior_m)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_prior_pred <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(cycle_time_full_intx_lin_remonth_prior_m)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_prior_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(<span class="fu">t</span>(cycle_time_full_intx_lin_remonth_prior_pred))</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_prior_l <span class="ot">&lt;-</span> <span class="fu">melt</span>(cycle_time_full_intx_lin_remonth_prior_dt, </span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>                             <span class="at">measure.vars =</span> <span class="fu">names</span>(cycle_time_full_intx_lin_remonth_prior_dt), </span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>                             <span class="at">variable.name =</span> <span class="st">'iter'</span>, <span class="at">value.name =</span> <span class="st">'y_hat'</span>)</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycle_time_full_intx_lin_remonth_prior_l, <span class="fu">aes</span>(<span class="at">x =</span> y_hat)) <span class="sc">+</span> </span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">200</span>, <span class="at">fill =</span> <span class="st">'blue'</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> median_cycle_time_s, <span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">data =</span> month_level_dt,</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">200</span>, <span class="at">fill =</span> <span class="st">'gray'</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> </span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(cycle_time_full_intx_lin_remonth_prior_m)</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="co"># growth_ptyp_shape_prior_pp &lt;- pp_check(growth_ptyp_shape_prior_m)</span></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a><span class="co"># growth_ptyp_shape_prior_pp + scale_y_log10()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell-container"><div class="cell-decorator"><pre>In [49]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>make_init <span class="ot">&lt;-</span> <span class="cf">function</span>(N_org, N_user){</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(){</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">Intercept =</span> <span class="dv">14</span>, </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">b =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">17</span>), <span class="co">#runif(n = 15, min = -.05, max = .05),</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">bs =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">6</span>), <span class="co">#runif(n = 1, min = -.1, max = .1),</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">zs_1_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">3</span>), <span class="co">#runif(n = 3, min = -.1, max = .1), </span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">sds_1 =</span> .<span class="dv">1</span>, <span class="co">#runif(n = 1, min = 0, max = .1), </span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">zs_2_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">3</span>), <span class="co">#runif(n = 3, min = -.1, max = .1), </span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">sds_2 =</span> .<span class="dv">1</span>, <span class="co">#runif(n = 1, min = 0, max = .1), </span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">zs_3_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">3</span>), <span class="co">#runif(n = 3, min = -.1, max = .1), </span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">sds_3 =</span> .<span class="dv">1</span>, <span class="co">#runif(n = 1, min = 0, max = .1), </span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">zs_4_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">3</span>), <span class="co">#runif(n = 3, min = -.1, max = .1), </span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">sds_4 =</span> .<span class="dv">1</span>, <span class="co">#runif(n = 1, min = 0, max = .1), </span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">Intercept_shape =</span> .<span class="dv">29</span>, </span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>             <span class="co">#org</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">sd_1 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">2</span>), <span class="co">#runif(n = 1, min = 0, max = .1), </span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">z_1 =</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, N_org<span class="sc">*</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>), </span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">L_1 =</span> <span class="fu">t</span>(<span class="fu">chol</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">2</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))),</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>             <span class="co">#user</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">sd_2 =</span> <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">2</span>), <span class="co">#runif(n = 1, min = 0, max = .1), </span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">z_2 =</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, N_user<span class="sc">*</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>), </span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">L_2 =</span> <span class="fu">t</span>(<span class="fu">chol</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">2</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))),</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>             <span class="co">#org</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">sd_3 =</span> .<span class="dv">1</span>, </span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">z_3 =</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, N_org), <span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>init <span class="ot">&lt;-</span> <span class="fu">make_init</span>(<span class="fu">length</span>(<span class="fu">unique</span>(month_level_dt<span class="sc">$</span>org_id_fac)),</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(<span class="fu">unique</span>(month_level_dt<span class="sc">$</span>user_id_fac)))</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> cycle_time_full_intx_lin_remonth_f, <span class="at">data =</span> month_level_dt, </span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">prior =</span> cycle_time_full_intx_lin_remonth_prior,</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">save_model =</span> <span class="st">'cycle_time_full_intx_lin_remonth.stan'</span>,</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>                                       <span class="co">#control = list(adapt_delta = .99, max_treedepth = 20),</span></span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">file =</span> <span class="st">'cycle_time_full_intx_lin_remonth'</span>,    </span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">sample_prior =</span> <span class="st">'no'</span>,</span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, </span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">cores =</span> <span class="dv">1</span>, <span class="at">threads =</span> <span class="dv">19</span>, </span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">init =</span> init,</span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">backend =</span> <span class="st">'cmdstanr'</span>, <span class="at">silent =</span> <span class="dv">0</span>, <span class="at">refresh =</span> <span class="dv">1</span>,</span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">file_refit =</span> <span class="st">'never'</span>, </span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">stan_model_args =</span> <span class="fu">list</span>(<span class="at">cpp_options =</span> <span class="fu">list</span>(</span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">PRECOMPILED_HEADERS =</span> <span class="cn">FALSE</span>, <span class="at">STAN_CPP_OPTIMS =</span> <span class="cn">TRUE</span>,</span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"CXXFLAGS+= -O1 -march=native -mtune=native"</span>,</span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"CXXFLAGS+= -DEIGEN_USE_BLAS -DEIGEN_USE_LAPACKE"</span>,</span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"LDLIBS += -lblas -llapack -llapacke"</span>), </span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">force_recompile =</span> <span class="cn">TRUE</span>))</span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(cycle_time_full_intx_lin_remonth_m)</span></span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a><span class="co">#traceplot_manyvars(cycle_time_full_intx_lin_remonth_m, variables = variables(cycle_time_full_intx_lin_remonth_m)[1:26])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell-container"><div class="cell-decorator"><pre>In [50]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_draws <span class="ot">&lt;-</span> <span class="fu">brms_to_draws</span>(cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">variables =</span> <span class="fu">variables</span>(cycle_time_full_intx_lin_remonth_m)[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>])</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_pars <span class="ot">&lt;-</span> parameters<span class="sc">::</span><span class="fu">model_parameters</span>(cycle_time_full_intx_lin_remonth_m_draws, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">centrality =</span> <span class="st">'median'</span>, <span class="at">ci =</span> .<span class="dv">95</span>, <span class="at">ci_method =</span> <span class="st">'hdi'</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_param_table <span class="ot">&lt;-</span> kableExtra<span class="sc">::</span><span class="fu">kbl</span>(cycle_time_full_intx_lin_remonth_m_pars, </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">format =</span> <span class="st">'pipe'</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">tabular =</span> <span class="cn">TRUE</span>, </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">caption =</span> <span class="st">"Model parameter estimates"</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(knitr<span class="sc">::</span><span class="fu">is_html_output</span>()){</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">knit_print</span>(kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(cycle_time_full_intx_lin_remonth_m_param_table, </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">'striped'</span>, <span class="st">'hover'</span>)))</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">knit_print</span>(cycle_time_full_intx_lin_remonth_m_param_table)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell-container"><div class="cell-decorator"><pre>In [51]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_pairs</span>(cycle_time_full_intx_lin_remonth_m, <span class="at">pars =</span> <span class="fu">variables</span>(cycle_time_full_intx_lin_remonth_m)[<span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>], <span class="at">off_diag_fun =</span> <span class="st">'hex'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell-container"><div class="cell-decorator"><pre>In [52]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_quarter <span class="ot">&lt;-</span> <span class="fu">plot_marginal_effect</span>(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'within_quarter_month_num_c'</span>, </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(.<span class="dv">1</span>, <span class="dv">10</span>)), <span class="at">translabels.x =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(<span class="dv">2</span>)),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Within-quarter month number'</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>))) <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  theme_clean <span class="sc">+</span> </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>())</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_lin_remonth_quarter.png'</span>, </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>       cycle_time_full_intx_lin_remonth_quarter,</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cycle_time_full_intx_lin_remonth_quarter)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_month_num_c <span class="ot">&lt;-</span> <span class="fu">plot_marginal_effect</span>(</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">'month_num_c'</span>, </span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(.<span class="dv">25</span>, <span class="dv">10</span>)), <span class="at">translabels.x =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(<span class="dv">7</span>)),</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Month'</span>,</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>))) <span class="sc">+</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  theme_clean <span class="sc">+</span> </span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>())</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_lin_remonth_month_num.png'</span>, </span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>       cycle_time_full_intx_lin_remonth_month_num_c,</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cycle_time_full_intx_lin_remonth_month_num_c)</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>yr_avg_avg_coding_days_per_week_center <span class="ot">&lt;-</span> <span class="fu">get_center</span>(month_level_dt, <span class="st">'yr_avg_avg_coding_days_per_week'</span>)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_coding_days <span class="ot">&lt;-</span> <span class="fu">plot_marginal_effect</span>(</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">'wi_avg_coding_days_per_week'</span>, </span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">10</span>)), </span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Coding days per week</span><span class="sc">\n</span><span class="st">(within-person deviation)'</span>,</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>))) <span class="sc">+</span></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>  theme_clean <span class="sc">+</span></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">list</span>(<span class="st">'yr_avg_avg_coding_days_per_week_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>) <span class="sc">-</span> yr_avg_avg_coding_days_per_week_center,</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'month_num_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">7</span>),</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>                       <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">10</span>)),</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.x =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(yr_avg_avg_coding_days_per_week_center)),</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.fill =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(<span class="dv">7</span>)),</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>                       <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>,</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">x =</span> <span class="st">'Average coding days per week</span><span class="sc">\n</span><span class="st">(year average)'</span>,</span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Month'</span>,</span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Month'</span>))) <span class="sc">+</span> </span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>  theme_clean <span class="sc">+</span> </span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> <span class="st">'AB'</span>)</span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_lin_remonth_coding_days.png'</span>, </span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a>       cycle_time_full_intx_lin_remonth_coding_days,</span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cycle_time_full_intx_lin_remonth_coding_days)</span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>yr_avg_total_merged_prs_center <span class="ot">&lt;-</span> <span class="fu">get_center</span>(month_level_dt, <span class="st">'yr_avg_total_merged_prs'</span>)</span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_merged_prs <span class="ot">&lt;-</span> <span class="fu">plot_marginal_effect</span>(</span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a>  <span class="st">'wi_total_merged_prs'</span>,</span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>)), </span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Total merged PRs</span><span class="sc">\n</span><span class="st">(within-person deviation)'</span>,</span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>))) <span class="sc">+</span> </span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a>  theme_clean <span class="sc">+</span></span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">list</span>(<span class="st">'yr_avg_total_merged_prs_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">100</span>) <span class="sc">-</span> yr_avg_total_merged_prs_center,</span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'month_num_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">7</span>),</span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.x =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(yr_avg_total_merged_prs_center)),</span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.fill =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(<span class="dv">7</span>)),</span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a>                       <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Median cycle time (days)</span><span class="sc">\n</span><span class="st">(year average)'</span>,</span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">x =</span> <span class="st">'Total merged PRs'</span>,</span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Month'</span>,</span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Month'</span>))) <span class="sc">+</span> </span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a>  theme_clean <span class="sc">+</span> </span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> <span class="st">'AB'</span>)</span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_lin_remonth_merged_prs.png'</span>, </span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a>       cycle_time_full_intx_lin_remonth_merged_prs,</span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cycle_time_full_intx_lin_remonth_merged_prs)</span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-76"><a href="#cb53-76" aria-hidden="true" tabindex="-1"></a>yr_avg_defect_tickets_pct_indiv_center <span class="ot">&lt;-</span> <span class="fu">get_center</span>(month_level_dt, <span class="st">'yr_avg_defect_tickets_pct_indiv'</span>)</span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_defect_tickets <span class="ot">&lt;-</span> <span class="fu">plot_marginal_effect</span>(</span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a>  <span class="st">'wi_defect_tickets_pct_indiv'</span>,</span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>)),</span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Defect ticket percent</span><span class="sc">\n</span><span class="st">(within-person deviation)'</span>,</span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>))) <span class="sc">+</span> </span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">list</span>(<span class="st">'yr_avg_defect_tickets_pct_indiv_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>) <span class="sc">-</span> yr_avg_defect_tickets_pct_indiv_center,</span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'month_num_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">7</span>),</span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.x =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(yr_avg_defect_tickets_pct_indiv_center)),</span>
<span id="cb53-87"><a href="#cb53-87" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.fill =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(<span class="dv">7</span>)),</span>
<span id="cb53-88"><a href="#cb53-88" aria-hidden="true" tabindex="-1"></a>                       <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>,</span>
<span id="cb53-89"><a href="#cb53-89" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">x =</span> <span class="st">'Defect ticket percent</span><span class="sc">\n</span><span class="st">(year average)'</span>,</span>
<span id="cb53-90"><a href="#cb53-90" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Month'</span>,</span>
<span id="cb53-91"><a href="#cb53-91" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Month'</span>))) <span class="sc">+</span> </span>
<span id="cb53-92"><a href="#cb53-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> <span class="st">'AB'</span>)</span>
<span id="cb53-93"><a href="#cb53-93" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_lin_remonth_defect_tickets.png'</span>, </span>
<span id="cb53-94"><a href="#cb53-94" aria-hidden="true" tabindex="-1"></a>       cycle_time_full_intx_lin_remonth_defect_tickets,</span>
<span id="cb53-95"><a href="#cb53-95" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb53-96"><a href="#cb53-96" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cycle_time_full_intx_lin_remonth_defect_tickets)</span>
<span id="cb53-97"><a href="#cb53-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-98"><a href="#cb53-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-99"><a href="#cb53-99" aria-hidden="true" tabindex="-1"></a>yr_avg_degree_centrality_monthly_100_center <span class="ot">&lt;-</span> <span class="fu">get_center</span>(month_level_dt, <span class="st">'yr_avg_degree_centrality_monthly_100'</span>)</span>
<span id="cb53-100"><a href="#cb53-100" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_degree_cent <span class="ot">&lt;-</span> <span class="fu">plot_marginal_effect</span>(</span>
<span id="cb53-101"><a href="#cb53-101" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb53-102"><a href="#cb53-102" aria-hidden="true" tabindex="-1"></a>  <span class="st">'wi_degree_centrality_monthly_100'</span>,</span>
<span id="cb53-103"><a href="#cb53-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span>)),</span>
<span id="cb53-104"><a href="#cb53-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Degree centrality</span><span class="sc">\n</span><span class="st">(within-person deviation)'</span>,</span>
<span id="cb53-105"><a href="#cb53-105" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>))) <span class="sc">+</span> </span>
<span id="cb53-106"><a href="#cb53-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb53-107"><a href="#cb53-107" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">list</span>(<span class="st">'yr_avg_degree_centrality_monthly_100_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>) <span class="sc">-</span> yr_avg_degree_centrality_monthly_100_center,</span>
<span id="cb53-108"><a href="#cb53-108" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'month_num_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">7</span>), </span>
<span id="cb53-109"><a href="#cb53-109" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.x =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(yr_avg_degree_centrality_monthly_100_center)),</span>
<span id="cb53-110"><a href="#cb53-110" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.fill =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(<span class="dv">7</span>)),</span>
<span id="cb53-111"><a href="#cb53-111" aria-hidden="true" tabindex="-1"></a>                       <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>,</span>
<span id="cb53-112"><a href="#cb53-112" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">x =</span> <span class="st">'Degree centrality</span><span class="sc">\n</span><span class="st">(year average)'</span>,</span>
<span id="cb53-113"><a href="#cb53-113" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Month'</span>,</span>
<span id="cb53-114"><a href="#cb53-114" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Month'</span>))) <span class="sc">+</span> </span>
<span id="cb53-115"><a href="#cb53-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> <span class="st">'AB'</span>)</span>
<span id="cb53-116"><a href="#cb53-116" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_lin_remonth_degree_cent.png'</span>, </span>
<span id="cb53-117"><a href="#cb53-117" aria-hidden="true" tabindex="-1"></a>       cycle_time_full_intx_lin_remonth_degree_cent,</span>
<span id="cb53-118"><a href="#cb53-118" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb53-119"><a href="#cb53-119" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cycle_time_full_intx_lin_remonth_degree_cent)</span>
<span id="cb53-120"><a href="#cb53-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-121"><a href="#cb53-121" aria-hidden="true" tabindex="-1"></a>yr_avg_comments_per_pr_center <span class="ot">&lt;-</span> <span class="fu">get_center</span>(month_level_dt, <span class="st">'yr_avg_comments_per_pr'</span>)</span>
<span id="cb53-122"><a href="#cb53-122" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pr_comments <span class="ot">&lt;-</span> <span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb53-123"><a href="#cb53-123" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'wi_comments_per_pr'</span>,</span>
<span id="cb53-124"><a href="#cb53-124" aria-hidden="true" tabindex="-1"></a>                     <span class="at">binwidth =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">10</span>)),</span>
<span id="cb53-125"><a href="#cb53-125" aria-hidden="true" tabindex="-1"></a>                     <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Comments per PR</span><span class="sc">\n</span><span class="st">(within-person deviation)'</span>,</span>
<span id="cb53-126"><a href="#cb53-126" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>))) <span class="sc">+</span> </span>
<span id="cb53-127"><a href="#cb53-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_marginal_effect</span>(cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb53-128"><a href="#cb53-128" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">list</span>(<span class="st">'yr_avg_comments_per_pr_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">12</span>, <span class="dv">18</span>) <span class="sc">-</span> yr_avg_comments_per_pr_center,</span>
<span id="cb53-129"><a href="#cb53-129" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'month_num_c'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">7</span>), </span>
<span id="cb53-130"><a href="#cb53-130" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.x =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(yr_avg_comments_per_pr_center)),</span>
<span id="cb53-131"><a href="#cb53-131" aria-hidden="true" tabindex="-1"></a>                       <span class="at">translabels.fill =</span> <span class="fu">list</span>(<span class="fu">create_label_transform</span>(<span class="dv">7</span>)),</span>
<span id="cb53-132"><a href="#cb53-132" aria-hidden="true" tabindex="-1"></a>                       <span class="at">plot_labels =</span> <span class="fu">list</span>(<span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Median cycle time (days)'</span>,</span>
<span id="cb53-133"><a href="#cb53-133" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">x =</span> <span class="st">'Comments per PR</span><span class="sc">\n</span><span class="st">(year average)'</span>,</span>
<span id="cb53-134"><a href="#cb53-134" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">fill =</span> <span class="st">'Month'</span>,</span>
<span id="cb53-135"><a href="#cb53-135" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">color =</span> <span class="st">'Month'</span>))) <span class="sc">+</span> </span>
<span id="cb53-136"><a href="#cb53-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> <span class="st">'AB'</span>)</span>
<span id="cb53-137"><a href="#cb53-137" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_lin_remonth_pr_comments.png'</span>, </span>
<span id="cb53-138"><a href="#cb53-138" aria-hidden="true" tabindex="-1"></a>       cycle_time_full_intx_lin_remonth_pr_comments,</span>
<span id="cb53-139"><a href="#cb53-139" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">'in'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb53-140"><a href="#cb53-140" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cycle_time_full_intx_lin_remonth_pr_comments)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [53]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(cycle_time_full_intx_lin_remonth_m, <span class="at">re_formula =</span> <span class="cn">NULL</span>, <span class="at">ndraws =</span> <span class="dv">500</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_w_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.table</span>(cycle_time_full_intx_lin_remonth_m<span class="sc">$</span>data), </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">as.data.table</span>(<span class="fu">t</span>(cycle_time_full_intx_lin_remonth_pp_draws)))</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l <span class="ot">&lt;-</span> <span class="fu">melt</span>(cycle_time_full_intx_lin_remonth_pp_draws_w_data, </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">'V'</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>)))</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l[, N <span class="sc">:</span><span class="er">=</span> .N, by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'org_id_fac'</span>, <span class="st">'variable'</span>)]</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_filtered <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_pp_draws_l[N <span class="sc">&gt;</span> <span class="dv">10</span>]</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>mod_trans <span class="ot">&lt;-</span> scales<span class="sc">::</span><span class="fu">transform_modulus</span>(<span class="at">p =</span> .<span class="dv">325</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_filtered[, transformed_value <span class="sc">:</span><span class="er">=</span> mod_trans<span class="sc">$</span><span class="fu">transform</span>(value)]</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_density <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_pp_draws_l_filtered[</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  N <span class="sc">&gt;</span> <span class="dv">10</span>, </span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fu">density</span>(transformed_value, <span class="at">n =</span> <span class="dv">50</span>)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">x =</span> d<span class="sc">$</span>x, <span class="at">y =</span> d<span class="sc">$</span>y, <span class="at">median_x =</span> <span class="fu">suppressWarnings</span>(<span class="fu">approx</span>(<span class="fu">cumsum</span>(d<span class="sc">$</span>y)<span class="sc">/</span><span class="fu">sum</span>(d<span class="sc">$</span>y), d<span class="sc">$</span>x, <span class="at">xout=</span><span class="fl">0.5</span>)<span class="sc">$</span>y), <span class="at">N =</span> <span class="fu">unique</span>(N))</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  }, </span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'org_id_fac'</span>, <span class="st">'variable'</span>)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_density[, median_median_x <span class="sc">:</span><span class="er">=</span> <span class="fu">median</span>(median_x), by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'org_id_fac'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [54]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>N_col <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>get_col <span class="ot">&lt;-</span> <span class="cf">function</span>(ranks, n_rows, n_cols) {</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  base <span class="ot">&lt;-</span> <span class="fu">floor</span>(n_rows<span class="sc">/</span>n_cols)  <span class="co"># base rows per column</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  extra <span class="ot">&lt;-</span> n_rows <span class="sc">%%</span> n_cols     <span class="co"># how many columns need an extra row</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  cutoffs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="fu">rep</span>(base <span class="sc">+</span> <span class="dv">1</span>, extra), <span class="fu">rep</span>(base, n_cols <span class="sc">-</span> extra))))</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Map to columns based on ranks</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">findInterval</span>(ranks <span class="sc">-</span> <span class="dv">1</span>, cutoffs)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>unique_orders <span class="ot">&lt;-</span> <span class="fu">unique</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_density[, <span class="fu">c</span>(<span class="st">'org_id_fac'</span>, <span class="st">'N'</span>, <span class="st">'median_median_x'</span>)])</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>unique_orders[, N_rank <span class="sc">:</span><span class="er">=</span> <span class="fu">frankv</span>(.SD, <span class="at">ties.method =</span> <span class="st">'dense'</span>), .SDcols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'N'</span>, <span class="st">'org_id_fac'</span>)]</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>unique_orders[, col_num <span class="sc">:</span><span class="er">=</span> <span class="fu">get_col</span>(N_rank, .N, <span class="dv">4</span>) <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="fu">setorder</span>(unique_orders, col_num, median_median_x, org_id_fac)</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>unique_orders[, I <span class="sc">:</span><span class="er">=</span> .I]</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>unique_orders[, row_num <span class="sc">:</span><span class="er">=</span> .N<span class="sc">:</span><span class="dv">1</span>, by <span class="ot">=</span> col_num]</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_density_orders <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_pp_draws_l_density[</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  unique_orders[, <span class="fu">c</span>(<span class="st">'org_id_fac'</span>, <span class="st">'col_num'</span>, <span class="st">'row_num'</span>, <span class="st">'I'</span>)], </span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  on <span class="ot">=</span> <span class="st">'org_id_fac'</span>]</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_density_orders[, org_id_fac <span class="sc">:</span><span class="er">=</span> <span class="fu">reorder</span>(org_id_fac, I, <span class="at">decreasing =</span> <span class="cn">FALSE</span>)]</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>y_separation <span class="ot">&lt;-</span> <span class="fu">max</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_density_orders<span class="sc">$</span>y)<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>y_mag <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_density_orders[, y_ridges <span class="sc">:</span><span class="er">=</span> (y<span class="sc">*</span>y_mag <span class="sc">+</span> y_separation<span class="sc">*</span>row_num)]</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_density_orders[, y_ridges_min <span class="sc">:</span><span class="er">=</span> y_separation<span class="sc">*</span>row_num]</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>breaks_seconds_to_days <span class="ot">&lt;-</span> mod_trans<span class="sc">$</span><span class="fu">transform</span>(<span class="fu">c</span>(<span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">12</span><span class="sc">*</span><span class="dv">1</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">4</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">1</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">13</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">1</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">52</span>))</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(breaks_seconds_to_days) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"12h"</span>, <span class="st">"1w"</span>, <span class="st">"4w"</span>, <span class="st">"1q"</span>, <span class="st">"1y"</span>)</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_density_orders_filtered <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_pp_draws_l_density_orders[variable <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">'V'</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>)]</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_density_orders_filtered, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y_ridges, <span class="at">group =</span> <span class="fu">interaction</span>(org_id_fac, variable))) <span class="sc">+</span> </span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> breaks_seconds_to_days[<span class="st">'4w'</span>], <span class="at">xend =</span> breaks_seconds_to_days[<span class="st">'4w'</span>],</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="fu">max</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_density_orders_filtered<span class="sc">$</span>y_ridges), </span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> viridis<span class="sc">::</span><span class="fu">mako</span>(<span class="dv">1</span>, <span class="at">begin =</span> .<span class="dv">2</span>),</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> y_ridges_min, <span class="at">ymax =</span> y_ridges, <span class="at">fill =</span> N), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> .<span class="dv">05</span>, <span class="at">alpha =</span> .<span class="dv">25</span>, <span class="at">color =</span> viridis<span class="sc">::</span><span class="fu">mako</span>(<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> breaks_seconds_to_days, <span class="at">labels =</span> <span class="fu">names</span>(breaks_seconds_to_days)) <span class="sc">+</span> </span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">quantile</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_density_orders_filtered<span class="sc">$</span>x, .<span class="dv">975</span>))) <span class="sc">+</span> </span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>col_num) <span class="sc">+</span></span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),  </span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(),</span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> font_name, <span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">'mako'</span>, <span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">transform_modulus</span>(<span class="at">p =</span> .<span class="dv">1</span>), </span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">min</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_density_orders_filtered<span class="sc">$</span>N), </span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">100</span>, <span class="dv">1000</span>, </span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">max</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_density_orders_filtered<span class="sc">$</span>N)),</span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">c</span>(<span class="fu">min</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_density_orders_filtered<span class="sc">$</span>N), </span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">100</span>, <span class="dv">1000</span>, </span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">max</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_density_orders_filtered<span class="sc">$</span>N)), <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a>                       <span class="at">begin =</span> .<span class="dv">2</span>,</span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a>                         <span class="at">barwidth =</span> .<span class="dv">5</span>,</span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a>                         <span class="at">barheight =</span> <span class="dv">5</span></span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a>                       )) <span class="sc">+</span> </span>
<span id="cb55-68"><a href="#cb55-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Cycle time"</span>, <span class="at">y =</span> <span class="st">"Posterior prediction probability density"</span>)</span>
<span id="cb55-69"><a href="#cb55-69" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_lin_remonth_pp_check.png'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">'in'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [55]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_summary_density <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_pp_draws_l_filtered[</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  N <span class="sc">&gt;</span> <span class="dv">10</span>, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fu">density</span>(transformed_value, <span class="at">n =</span> <span class="dv">500</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">x =</span> d<span class="sc">$</span>x, <span class="at">y =</span> d<span class="sc">$</span>y)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  }, </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'variable'</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(cycle_time_full_intx_lin_remonth_m<span class="sc">$</span>data)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data[, N <span class="sc">:</span><span class="er">=</span> .N, by <span class="ot">=</span> org_id_fac]</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data[N <span class="sc">&gt;</span> <span class="dv">10</span>]</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data[, median_cycle_time_s_modulus <span class="sc">:</span><span class="er">=</span> mod_trans<span class="sc">$</span><span class="fu">transform</span>(median_cycle_time_s)]</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>breakpoints <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data<span class="sc">$</span>median_cycle_time_s_modulus),</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">max</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data<span class="sc">$</span>median_cycle_time_s_modulus), <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data[, intervals <span class="sc">:</span><span class="er">=</span> <span class="fu">findInterval</span>(median_cycle_time_s_modulus, breakpoints)]</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>bin_width <span class="ot">&lt;-</span> <span class="fu">diff</span>(breakpoints)[<span class="dv">1</span>]  <span class="co"># Width of each bin</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data)</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data_hist <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data[, .(<span class="at">density =</span> .N <span class="sc">/</span> (bin_width<span class="sc">*</span>total_n)), by <span class="ot">=</span> intervals]</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="fu">setorder</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data_hist, intervals)</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>breakpoints_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">bin_value =</span> breakpoints[<span class="sc">-</span><span class="dv">1</span>], <span class="at">intervals =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(breakpoints[<span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data_hist <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data_hist[breakpoints_dt, on <span class="ot">=</span> <span class="st">'intervals'</span>]</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data_hist[, density <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(<span class="fu">is.na</span>(density), <span class="dv">0</span>, density)]</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_summary_density, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">group =</span> variable)) <span class="sc">+</span> </span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">data =</span> cycle_time_full_intx_lin_remonth_pp_draws_l_summary_data_hist, <span class="fu">aes</span>(<span class="at">x =</span> bin_value, <span class="at">y =</span> density, <span class="at">group =</span> <span class="cn">NULL</span>),</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> viridis<span class="sc">::</span><span class="fu">mako</span>(<span class="dv">1</span>, <span class="at">begin =</span> .<span class="dv">35</span>)) <span class="sc">+</span> </span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> y), <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">fill =</span> viridis<span class="sc">::</span><span class="fu">mako</span>(<span class="dv">1</span>, <span class="at">begin =</span> .<span class="dv">65</span>), <span class="at">alpha =</span> <span class="fl">0.025</span>) <span class="sc">+</span></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> .<span class="dv">015</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">color =</span> viridis<span class="sc">::</span><span class="fu">mako</span>(<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> breaks_seconds_to_days, <span class="at">labels =</span> <span class="fu">names</span>(breaks_seconds_to_days)) <span class="sc">+</span> </span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">quantile</span>(cycle_time_full_intx_lin_remonth_pp_draws_l_summary_density<span class="sc">$</span>x, .<span class="dv">60</span>))) <span class="sc">+</span> </span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),  </span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(),</span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> font_name, <span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Cycle time"</span>, <span class="at">y =</span> <span class="st">"Posterior prediction</span><span class="sc">\n</span><span class="st">probability density"</span>)</span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_lin_remonth_pp_check_summary.png'</span>, <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">'in'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [56]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>re_draws_org_fn <span class="ot">&lt;-</span> <span class="st">'cycle_time_full_intx_lin_remonth_draws_re_sum.rds'</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>re_draws_id_fn <span class="ot">&lt;-</span> <span class="st">'cycle_time_full_intx_lin_remonth_draws_uidre_sum.rds'</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(re_draws_org_fn)){</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_draws_re <span class="ot">&lt;-</span> <span class="fu">spread_draws</span>(cycle_time_full_intx_lin_remonth_m, r_org_id_fac[org_id_fac,par])</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_draws_re_sum <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">summarize_draws</span>(cycle_time_full_intx_lin_remonth_draws_re, median, <span class="sc">~</span>posterior<span class="sc">::</span><span class="fu">quantile2</span>(.x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="fl">-.8</span>, (<span class="dv">1</span><span class="fl">+.8</span>))<span class="sc">/</span><span class="dv">2</span>), <span class="sc">~</span>posterior<span class="sc">::</span><span class="fu">quantile2</span>(.x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="fl">-.5</span>, (<span class="dv">1</span><span class="fl">+.5</span>))<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(cycle_time_full_intx_lin_remonth_draws_re_sum, re_draws_org_fn)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_draws_re_sum <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(re_draws_org_fn)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(re_draws_id_fn)){</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_draws_uidre <span class="ot">&lt;-</span> <span class="fu">spread_draws</span>(cycle_time_full_intx_lin_remonth_m, <span class="st">`</span><span class="at">r_.*user_id_fac</span><span class="st">`</span>[org_id_fac,par], <span class="at">regex =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_draws_uidre_sum <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">summarize_draws</span>(cycle_time_full_intx_lin_remonth_draws_uidre, median, <span class="sc">~</span>posterior<span class="sc">::</span><span class="fu">quantile2</span>(.x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="fl">-.8</span>, (<span class="dv">1</span><span class="fl">+.8</span>))<span class="sc">/</span><span class="dv">2</span>), <span class="sc">~</span>posterior<span class="sc">::</span><span class="fu">quantile2</span>(.x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="fl">-.5</span>, (<span class="dv">1</span><span class="fl">+.5</span>))<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_draws_uidre_sum <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(cycle_time_full_intx_lin_remonth_draws_uidre_sum)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(cycle_time_full_intx_lin_remonth_draws_uidre_sum, re_draws_id_fn)</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_draws_uidre_sum <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(re_draws_id_fn)</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [57]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_draws_uidre_sum[, order <span class="sc">:</span><span class="er">=</span> <span class="fu">rank</span>(median), by <span class="ot">=</span> <span class="st">'par'</span>]</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_draws_uidre_sum[, pp <span class="sc">:</span><span class="er">=</span> order <span class="sc">/</span> (.N <span class="sc">+</span> <span class="dv">1</span>), by <span class="ot">=</span> <span class="st">'par'</span>]</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_draws_uidre_sum[, qq <span class="sc">:</span><span class="er">=</span> <span class="fu">qnorm</span>(pp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sd</span>(median)), by <span class="ot">=</span> <span class="st">'par'</span>]</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycle_time_full_intx_lin_remonth_draws_uidre_sum, <span class="fu">aes</span>(<span class="at">x =</span> order)) <span class="sc">+</span> </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_interval</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> q10, <span class="at">ymax =</span> q90), <span class="at">size =</span> .<span class="dv">125</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> .<span class="dv">25</span>, <span class="at">orientation =</span> <span class="st">'vertical'</span>) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_interval</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> q25, <span class="at">ymax =</span> q75), <span class="at">size =</span> .<span class="dv">25</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> .<span class="dv">25</span>, <span class="at">orientation =</span> <span class="st">'vertical'</span>) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> qq), <span class="at">color =</span> <span class="st">'white'</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(par<span class="sc">~</span>., <span class="at">scales =</span> <span class="st">'free_y'</span>) <span class="sc">+</span> </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  theme_clean <span class="sc">+</span> </span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Individual deviation from population parameter'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [58]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_draws_uidre_sum_l <span class="ot">&lt;-</span> <span class="fu">melt</span>(cycle_time_full_intx_lin_remonth_draws_uidre_sum[, <span class="fu">c</span>(<span class="st">'median'</span>, <span class="st">'q10'</span>, <span class="st">'q25'</span>, <span class="st">'q75'</span>, <span class="st">'q90'</span>, <span class="st">'par'</span>, <span class="st">'org_id_fac'</span>)], </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">'median'</span>, <span class="st">'q10'</span>, <span class="st">'q25'</span>, <span class="st">'q75'</span>, <span class="st">'q90'</span>), </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">variable.name =</span> <span class="st">'quantile'</span>, <span class="at">value.name =</span> <span class="st">'y_hat'</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_draws_uidre_sum_l[, var <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(par, <span class="st">'_'</span>, quantile)]</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_draws_uidre_sum_w <span class="ot">&lt;-</span> <span class="fu">dcast</span>(cycle_time_full_intx_lin_remonth_draws_uidre_sum_l[, <span class="sc">-</span><span class="st">'par'</span>], org_id_fac <span class="sc">~</span> var, <span class="at">value.var =</span> <span class="st">'y_hat'</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycle_time_full_intx_lin_remonth_draws_uidre_sum_w, <span class="fu">aes</span>(<span class="at">x =</span> Intercept_median, <span class="at">y =</span> month_num_c_median)) <span class="sc">+</span> </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> Intercept_q25, <span class="at">xend =</span> Intercept_q75), <span class="at">size =</span> .<span class="dv">125</span>, <span class="at">alpha =</span> .<span class="dv">35</span>) <span class="sc">+</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> month_num_c_q25, <span class="at">yend =</span> month_num_c_q75), <span class="at">size =</span> .<span class="dv">125</span>, <span class="at">alpha =</span> .<span class="dv">35</span>) <span class="sc">+</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">bins =</span> <span class="dv">120</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">'fill'</span>, <span class="st">'color'</span>), <span class="at">option =</span> <span class="st">'plasma'</span>, <span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">modulus_trans</span>(<span class="at">p =</span> <span class="sc">-</span>.<span class="dv">3</span>),</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  theme_clean <span class="sc">+</span> </span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [59]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">34232</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(cycle_time_full_intx_lin_remonth_m<span class="sc">$</span>data)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">#using frank (fast rank)</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>quantile_labeler <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n_quantiles =</span> <span class="dv">20</span>){</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span> <span class="sc">+</span> (<span class="fu">frank</span>(x, <span class="at">ties.method =</span> <span class="st">"min"</span>)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%/%</span> (N<span class="sc">/</span>n_quantiles)) <span class="sc">/</span> n_quantiles</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data[, yr_avg_avg_coding_days_per_week_c_quantile <span class="sc">:</span><span class="er">=</span> <span class="fu">quantile_labeler</span>(yr_avg_avg_coding_days_per_week_c)]</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data[, wi_avg_coding_days_per_week_quantile <span class="sc">:</span><span class="er">=</span> <span class="fu">quantile_labeler</span>(wi_avg_coding_days_per_week)]</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data[, N_obs <span class="sc">:</span><span class="er">=</span> .N, by <span class="ot">=</span> <span class="st">'user_id_fac'</span>]</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(cycle_time_full_intx_lin_remonth_m_data[N_obs <span class="sc">&gt;=</span> <span class="dv">4</span>, <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, <span class="st">'yr_avg_avg_coding_days_per_week_c_quantile'</span>)])</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>nsamples <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_ids[, yr_avg_avg_coding_days_per_week_c_subsample <span class="sc">:</span><span class="er">=</span> </span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, nsamples), <span class="fu">rep</span>(<span class="dv">0</span>, .N<span class="sc">-</span>nsamples)), .N), </span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>                                              by <span class="ot">=</span> yr_avg_avg_coding_days_per_week_c_quantile]</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cycle_time_full_intx_lin_remonth_m_data_subsample_ids<span class="sc">$</span>yr_avg_avg_coding_days_per_week_c_subsample,</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>      cycle_time_full_intx_lin_remonth_m_data_subsample_ids<span class="sc">$</span>yr_avg_avg_coding_days_per_week_c_quantile)</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_ids <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_m_data_subsample_ids[</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>  yr_avg_avg_coding_days_per_week_c_subsample <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_m_data[cycle_time_full_intx_lin_remonth_m_data_subsample_ids, on <span class="ot">=</span> <span class="st">'user_id_fac'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [60]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>raw_data_ct_example_for_plot <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_m_data_subsample[, <span class="fu">CJ</span>(<span class="at">user_id_fac =</span> <span class="fu">unique</span>(user_id_fac), </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                                                                               <span class="at">month_num_c =</span> <span class="fu">unique</span>(month_num_c))]</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>raw_data_ct_example_for_plot <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="fu">unique</span>(cycle_time_full_intx_lin_remonth_m_data_subsample[, <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, <span class="st">'yr_avg_avg_coding_days_per_week_c_quantile'</span>)]),</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                                      raw_data_ct_example_for_plot, </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">on =</span> <span class="fu">c</span>(<span class="st">'user_id_fac'</span>))</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>raw_data_ct_example_for_plot <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="fu">unique</span>(cycle_time_full_intx_lin_remonth_m_data_subsample[, <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                                                                                           <span class="st">'month_num_c'</span>, </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>                                                                                           <span class="st">'median_cycle_time_s'</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>                                                                                           <span class="st">'yr_avg_avg_coding_days_per_week_c'</span>)]),</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>                                      raw_data_ct_example_for_plot, </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>med_med_ct <span class="ot">&lt;-</span> <span class="fu">median</span>(raw_data_ct_example_for_plot<span class="sc">$</span>median_cycle_time_s, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(raw_data_ct_example_for_plot[yr_avg_avg_coding_days_per_week_c_quantile <span class="sc">%in%</span> <span class="fu">seq</span>(.<span class="dv">05</span>, <span class="dv">1</span>, .<span class="dv">25</span>)], </span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num_c, <span class="at">y =</span> median_cycle_time_s)) <span class="sc">+</span> </span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> med_med_ct) <span class="sc">+</span> </span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac, <span class="at">color =</span> yr_avg_avg_coding_days_per_week_c), <span class="at">linewidth =</span> .<span class="dv">125</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">modulus_trans</span>(<span class="at">p =</span> .<span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">'plasma'</span>, <span class="at">end =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>yr_avg_avg_coding_days_per_week_c_quantile) <span class="sc">+</span> </span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [61]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>subsample_predictions <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(<span class="fu">predictions</span>(cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">newdata =</span> <span class="fu">unique</span>(cycle_time_full_intx_lin_remonth_m_data_subsample),</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">re_formula =</span> <span class="cn">NULL</span>))</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(cycle_time_full_intx_lin_remonth_m_data_subsample)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_m_data_subsample[, <span class="fu">CJ</span>(<span class="at">user_id_fac =</span> <span class="fu">unique</span>(user_id_fac), </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>                                                                                <span class="at">month_num_c =</span> <span class="fu">unique</span>(month_num_c))]</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot <span class="ot">&lt;-</span> <span class="fu">merge</span>(</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(cycle_time_full_intx_lin_remonth_m_data_subsample[, <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, <span class="st">'yr_avg_avg_coding_days_per_week_c_quantile'</span>)]),</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>                                      pred_data_ct_example_for_plot, </span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">on =</span> <span class="fu">c</span>(<span class="st">'user_id_fac'</span>))</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="fu">unique</span>(subsample_predictions[, <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, </span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'month_num_c'</span>, </span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'estimate'</span>,</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'conf.low'</span>, <span class="st">'conf.high'</span>,</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'yr_avg_avg_coding_days_per_week_c'</span>,</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'wi_avg_coding_days_per_week'</span>)]),</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>                                      pred_data_ct_example_for_plot, </span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>med_med_ct <span class="ot">&lt;-</span> <span class="fu">median</span>(pred_data_ct_example_for_plot<span class="sc">$</span>estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>mod_trans <span class="ot">&lt;-</span> scales<span class="sc">::</span><span class="fu">transform_modulus</span>(<span class="at">p =</span> .<span class="dv">325</span>)</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>breaks_seconds_to_days <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">12</span><span class="sc">*</span><span class="dv">1</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">4</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">1</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">13</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">1</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">26</span>)</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(breaks_seconds_to_days) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"12h"</span>, <span class="st">"1w"</span>, <span class="st">"4w"</span>, <span class="st">"1q"</span>, <span class="st">"6m"</span>)</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot[, quantile_name <span class="sc">:</span><span class="er">=</span> <span class="fu">reorder</span>(<span class="fu">sprintf</span>(<span class="st">'%.0f%% - %.0f%%'</span>, </span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>                                                                 yr_avg_avg_coding_days_per_week_c_quantile<span class="sc">*</span><span class="dv">100</span> <span class="sc">-</span> <span class="dv">5</span>,</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>                                                                 yr_avg_avg_coding_days_per_week_c_quantile<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>                                                         yr_avg_avg_coding_days_per_week_c_quantile)]</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_data_ct_example_for_plot[yr_avg_avg_coding_days_per_week_c_quantile <span class="sc">%in%</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">5</span>, .<span class="dv">85</span>, .<span class="dv">95</span>)], </span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num_c, <span class="at">y =</span> estimate)) <span class="sc">+</span> </span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> med_med_ct) <span class="sc">+</span> </span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">alpha =</span> .<span class="dv">025</span>) <span class="sc">+</span> </span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac), <span class="at">linewidth =</span> .<span class="dv">125</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> mod_trans, <span class="at">breaks =</span> breaks_seconds_to_days, <span class="at">labels =</span> <span class="fu">names</span>(breaks_seconds_to_days)) <span class="sc">+</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>quantile_name) <span class="sc">+</span> </span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Calendar time'</span>, <span class="at">y =</span> <span class="st">'Cycle time'</span>)</span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_lin_remonth_post_pred_ids.png'</span>, <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">'in'</span>)</span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [62]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot_wi <span class="ot">&lt;-</span> <span class="fu">copy</span>(pred_data_ct_example_for_plot)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot_wi[, median_estimate <span class="sc">:</span><span class="er">=</span> <span class="fu">median</span>(estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), by <span class="ot">=</span> user_id_fac]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot_wi[, <span class="fu">c</span>(<span class="st">'wi_estimate'</span>, <span class="st">'wi_conf.high'</span>, <span class="st">'wi_conf.low'</span>) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                                   .(estimate <span class="sc">-</span> median_estimate, conf.high <span class="sc">-</span> median_estimate, conf.low <span class="sc">-</span> median_estimate)]</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>pred_data_ct_example_for_plot_wi[, quantile_name <span class="sc">:</span><span class="er">=</span> <span class="fu">reorder</span>(<span class="fu">sprintf</span>(<span class="st">'%.0f%% - %.0f%%'</span>, </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>                                                                 yr_avg_avg_coding_days_per_week_c_quantile<span class="sc">*</span><span class="dv">100</span> <span class="sc">-</span> <span class="dv">5</span>,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>                                                                 yr_avg_avg_coding_days_per_week_c_quantile<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>                                                         yr_avg_avg_coding_days_per_week_c_quantile)]</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_data_ct_example_for_plot_wi[yr_avg_avg_coding_days_per_week_c_quantile <span class="sc">%in%</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">5</span>, .<span class="dv">85</span>, .<span class="dv">95</span>)], </span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num_c, <span class="at">y =</span> wi_estimate)) <span class="sc">+</span> </span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac, <span class="at">ymin =</span> wi_conf.low, <span class="at">ymax =</span> wi_conf.high), <span class="at">alpha =</span> .<span class="dv">025</span>) <span class="sc">+</span> </span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac, <span class="at">color =</span> wi_avg_coding_days_per_week), <span class="at">linewidth =</span> .<span class="dv">125</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> wi_avg_coding_days_per_week), <span class="at">size =</span> .<span class="dv">75</span>) <span class="sc">+</span> </span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">'plasma'</span>, <span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">modulus_trans</span>(<span class="at">p =</span> <span class="sc">-</span>.<span class="dv">5</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="fu">guide_colorbar</span>(<span class="at">direction =</span> <span class="st">"horizontal"</span>, <span class="at">title.position =</span> <span class="st">"top"</span>,</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">position =</span> <span class="st">'bottom'</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> mod_trans, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">rev</span>(breaks_seconds_to_days), breaks_seconds_to_days), </span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">'-'</span>, <span class="fu">rev</span>(<span class="fu">names</span>(breaks_seconds_to_days))), <span class="fu">names</span>(breaks_seconds_to_days))) <span class="sc">+</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>quantile_name) <span class="sc">+</span> </span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Calendar time'</span>, <span class="at">y =</span> <span class="st">'Deviation in cycle time'</span>, <span class="at">color =</span> <span class="st">'Within-person deviation in average coding days per week'</span>)</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cycle_time_full_intx_lin_remonth_post_pred_ids_win.png'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">'in'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [63]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7331</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(cycle_time_full_intx_lin_remonth_m_data[N_obs <span class="sc">==</span> <span class="dv">12</span>, <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, <span class="st">'yr_avg_avg_coding_days_per_week_c_quantile'</span>)])</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co">#hist(cycle_time_full_intx_lin_remonth_m_data_subsample_ids$yr_avg_avg_coding_days_per_week_c_quantile)</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>nsamples <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_ids[, yr_avg_avg_coding_days_per_week_c_subsample <span class="sc">:</span><span class="er">=</span> </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, nsamples), <span class="fu">rep</span>(<span class="dv">0</span>, .N<span class="sc">-</span>nsamples)), .N), </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>                                              by <span class="ot">=</span> yr_avg_avg_coding_days_per_week_c_quantile]</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_ids <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_m_data_subsample_ids[</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  yr_avg_avg_coding_days_per_week_c_quantile <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">8</span>, .<span class="dv">7</span>, .<span class="dv">6</span>, .<span class="dv">5</span>, .<span class="dv">4</span>, .<span class="dv">3</span>, .<span class="dv">2</span>, .<span class="dv">1</span>)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_ids <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_m_data_subsample_ids[</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  yr_avg_avg_coding_days_per_week_c_subsample <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample <span class="ot">&lt;-</span> cycle_time_full_intx_lin_remonth_m_data[cycle_time_full_intx_lin_remonth_m_data_subsample_ids, on <span class="ot">=</span> <span class="st">'user_id_fac'</span>]</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cycle_time_full_intx_lin_remonth_m_data_subsample, </span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num_c, <span class="at">y =</span> median_cycle_time_s)) <span class="sc">+</span> </span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> user_id_fac, <span class="at">color =</span> yr_avg_avg_coding_days_per_week_c_quantile), <span class="at">linewidth =</span> .<span class="dv">5</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">modulus_trans</span>(<span class="at">p =</span> .<span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">end =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(),  <span class="co"># Adjust text size for readability</span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [64]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_summary <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(<span class="fu">posterior_epred</span>(cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                                                                                                 <span class="at">newdata =</span> cycle_time_full_intx_lin_remonth_m_data_subsample,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                                                                                                 <span class="at">re_formula =</span> <span class="cn">NULL</span>))</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_preds <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                                                                               <span class="at">newdata =</span> cycle_time_full_intx_lin_remonth_m_data_subsample,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>                                                                               <span class="at">re_formula =</span> <span class="cn">NULL</span>, <span class="at">ndraws =</span> <span class="dv">100</span>)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_preds_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(cycle_time_full_intx_lin_remonth_m_data_subsample,</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="fu">as.data.table</span>(<span class="fu">t</span>(cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_preds)))</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_preds_data_l <span class="ot">&lt;-</span> <span class="fu">melt</span>(cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_preds_data,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="at">measure.vars =</span> <span class="fu">paste0</span>(<span class="st">'V'</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>))</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_summary <span class="ot">&lt;-</span> <span class="fu">cbind</span>(cycle_time_full_intx_lin_remonth_m_data_subsample,</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>                                                                     <span class="fu">as.data.table</span>(cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_summary))</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>breaks_seconds_to_days <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">12</span><span class="sc">*</span><span class="dv">1</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">4</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">1</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">13</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">1</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">26</span>)</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(breaks_seconds_to_days) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"12h"</span>, <span class="st">"1w"</span>, <span class="st">"4w"</span>, <span class="st">"1q"</span>, <span class="st">"6m"</span>)</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_summary <span class="ot">&lt;-</span> month_level_dt[</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>  , </span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">'yr_avg_avg_coding_days_per_week'</span>, <span class="st">'month_num_c'</span>, <span class="st">'user_id_fac'</span>, <span class="st">'org_id_fac'</span>)</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>][</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_summary, </span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>  on <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'month_num_c'</span>, <span class="st">'user_id_fac'</span>, <span class="st">'org_id_fac'</span>)</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_summary[, user_id_fac_sorted <span class="sc">:</span><span class="er">=</span> <span class="fu">reorder</span>(user_id_fac, yr_avg_avg_coding_days_per_week)]</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_preds_data_l[, user_id_fac_sorted <span class="sc">:</span><span class="er">=</span> <span class="fu">reorder</span>(user_id_fac, yr_avg_avg_coding_days_per_week_c)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [65]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>real_data_and_prediction_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_summary, </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num_c, <span class="at">y =</span> median_cycle_time_s)) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> median_cycle_time_s), <span class="at">linewidth =</span> .<span class="dv">125</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> median_cycle_time_s), <span class="at">size =</span> .<span class="dv">125</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_preds_data_l,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">interaction</span>(user_id_fac_sorted, variable), <span class="at">y =</span> value), </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> .<span class="dv">15</span>, <span class="at">alpha =</span> .<span class="dv">0625</span>) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>, <span class="at">group =</span> user_id_fac, <span class="at">fill =</span> yr_avg_avg_coding_days_per_week), </span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> .<span class="dv">0625</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">color =</span> <span class="st">'white'</span>) <span class="sc">+</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">group =</span> user_id_fac), <span class="at">color =</span> <span class="st">'white'</span>, <span class="at">linewidth =</span> .<span class="dv">65</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">group =</span> user_id_fac, <span class="at">color =</span> yr_avg_avg_coding_days_per_week), <span class="at">linewidth =</span> .<span class="dv">5</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> mod_trans,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> breaks_seconds_to_days, <span class="at">labels =</span> <span class="fu">names</span>(breaks_seconds_to_days)) <span class="sc">+</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> user_id_fac_sorted, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">end =</span> .<span class="dv">7</span>, <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">'fill'</span>, <span class="st">'color'</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">'Year-average coding-days-per-week'</span>,</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_colorbar</span>(<span class="at">direction =</span> <span class="st">"horizontal"</span>, <span class="at">title.position =</span> <span class="st">"top"</span>,</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">position =</span> <span class="st">'bottom'</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="at">units =</span> <span class="st">'mm'</span>),</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>),</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">#legend.key.width = unit(0.4, "cm"),</span></span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>)</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Calendar time'</span>, <span class="at">y =</span> <span class="st">'Cycle time'</span>) <span class="sc">+</span> </span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">25</span>))</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(real_data_and_prediction_plot)</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(real_data_and_prediction_plot, <span class="at">file =</span> <span class="st">'cycle_time_full_intx_lin_remonth_post_pred_samples.png'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">'in'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [66]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>yr_avg_avg_coding_days_per_week_c_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    cycle_time_full_intx_lin_remonth_m<span class="sc">$</span>data[</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>      , <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, <span class="st">'yr_avg_avg_coding_days_per_week_c'</span>)]</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  )[[<span class="st">'yr_avg_avg_coding_days_per_week_c'</span>]],</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, <span class="at">length.out =</span> <span class="dv">3</span>))</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>cf_data <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="fu">names</span>(yr_avg_avg_coding_days_per_week_c_quantiles),</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>         \(x){</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>           a_dt <span class="ot">&lt;-</span> <span class="fu">copy</span>(cycle_time_full_intx_lin_remonth_m_data_subsample)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>           a_dt[, yr_avg_avg_coding_days_per_week_c <span class="sc">:</span><span class="er">=</span> <span class="fu">rep</span>(yr_avg_avg_coding_days_per_week_c_quantiles[x], .N)]</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>           a_dt[, quantiles <span class="sc">:</span><span class="er">=</span> <span class="fu">rep</span>(x, .N)]</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>           <span class="fu">return</span>(a_dt)</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>         })</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>ndraws <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>cf_post_pred <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">newdata =</span> cf_data,</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">re_formula =</span> <span class="cn">NULL</span>, </span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ndraws =</span> ndraws)</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>cf_post_epred_sum <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(<span class="fu">posterior_epred</span>(cycle_time_full_intx_lin_remonth_m, </span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">newdata =</span> cf_data,</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">re_formula =</span> <span class="cn">NULL</span>))</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>cf_data_post_pred <span class="ot">&lt;-</span> <span class="fu">cbind</span>(cf_data,</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.data.table</span>(<span class="fu">t</span>(cf_post_pred)))</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>cf_data_post_epred <span class="ot">&lt;-</span> <span class="fu">cbind</span>(cf_data,</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">as.data.table</span>(cf_post_epred_sum))</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>cf_data_post_pred[, user_id_fac_sorted <span class="sc">:</span><span class="er">=</span> <span class="fu">reorder</span>(user_id_fac, yr_avg_avg_coding_days_per_week_c_quantile)]</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>cf_data_post_epred[, user_id_fac_sorted <span class="sc">:</span><span class="er">=</span> <span class="fu">reorder</span>(user_id_fac, yr_avg_avg_coding_days_per_week_c_quantile)]</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>cf_data_post_pred_l <span class="ot">&lt;-</span> <span class="fu">melt</span>(cf_data_post_pred, <span class="at">measure.vars =</span> <span class="fu">paste0</span>(<span class="st">'V'</span>, <span class="dv">1</span><span class="sc">:</span>ndraws))</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(cycle_time_full_intx_lin_remonth_m_data_subsample_posterior_summary[, .(<span class="at">diff =</span> <span class="sc">-</span>yr_avg_avg_coding_days_per_week_c <span class="sc">+</span> yr_avg_avg_coding_days_per_week)])[[<span class="dv">1</span>]] <span class="sc">+</span> yr_avg_avg_coding_days_per_week_c_quantiles</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a>cf_data_post_epred[, .(<span class="at">diff =</span> Estimate[quantiles <span class="sc">==</span> <span class="st">'50%'</span>] <span class="sc">-</span> Estimate[quantiles <span class="sc">==</span> <span class="st">'90%'</span>]), </span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a>                   by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'user_id_fac'</span>, <span class="st">'month_num_c'</span>)][, .(<span class="at">med_diff =</span> <span class="fu">median</span>(diff)), by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'user_id_fac'</span>)][</span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>                     , .(<span class="at">med_diff =</span> <span class="fu">median</span>(med_diff) <span class="sc">/</span> (<span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span>))</span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>                   ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [67]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>real_data_and_cf_prediction_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cf_data_post_pred_l, </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month_num_c, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point(aes(group = interaction(variable, quantiles), color = quantiles), size = .25, alpha = .25) +</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bin2d</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">interaction</span>(quantiles, month_num_c), <span class="at">fill =</span> quantiles, <span class="at">alpha =</span> <span class="fu">after_stat</span>(count)), <span class="at">binwidth =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">25</span>), </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">preserve =</span> <span class="st">'total'</span>)) <span class="sc">+</span> </span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(aes(group = interaction(variable, quantiles), color = quantiles), linewidth = .25, alpha = .0625) +</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> cf_data_post_epred, <span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">group =</span> quantiles), <span class="at">color =</span> <span class="st">'white'</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> cf_data_post_epred, <span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">group =</span> quantiles, <span class="at">color =</span> quantiles), <span class="at">linewidth =</span> .<span class="dv">75</span>) <span class="sc">+</span> </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> mod_trans,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> breaks_seconds_to_days, <span class="at">labels =</span> <span class="fu">names</span>(breaks_seconds_to_days)) <span class="sc">+</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(.<span class="dv">4</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">20</span>),</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">guide =</span> <span class="st">'none'</span>, <span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">transform_modulus</span>(<span class="at">p =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">'fill'</span>, <span class="st">'color'</span>), <span class="at">option =</span> <span class="st">'cividis'</span>, <span class="at">end =</span> .<span class="dv">7</span>,</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">'Counterfactual year-average-coding-days quantile'</span>,</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">direction =</span> <span class="st">"horizontal"</span>, <span class="at">title.position =</span> <span class="st">"top"</span>,</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">position =</span> <span class="st">'bottom'</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(aesthetics = c('fill', 'color'), </span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                    breaks = c("10%", "50%", "90%"), </span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                    values = c("#29483A", "#759C44", "#DF3383"),</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                    name = 'Counterfactual Year Average Coding Days quantiles',</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                    guide = guide_legend(direction = "horizontal", title.position = "top",</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                           position = 'bottom', title.hjust = 0.5)) +</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> user_id_fac_sorted, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="at">units =</span> <span class="st">'mm'</span>),</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>),</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>),</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>)</span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Calendar time'</span>, <span class="at">y =</span> <span class="st">'Cycle time'</span>) <span class="sc">+</span> </span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">7</span><span class="sc">*</span><span class="dv">25</span>))</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(real_data_and_cf_prediction_plot)</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(real_data_and_cf_prediction_plot, <span class="at">file =</span> <span class="st">'cycle_time_full_intx_lin_remonth_post_pred_counterfactual.png'</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">'in'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [68]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>combined_prediction_plot <span class="ot">&lt;-</span> real_data_and_prediction_plot <span class="sc">+</span> real_data_and_cf_prediction_plot <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">axis_titles =</span> <span class="st">'collect'</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_prediction_plot)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(combined_prediction_plot, <span class="at">file =</span> <span class="st">'cycle_time_full_intx_lin_remonth_combined_post_pred_counterfactual.png'</span>, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">'in'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [69]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"marginaleffects_posterior_interval"</span> <span class="ot">=</span> <span class="st">"hdi"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"marginaleffects_posterior_center"</span> <span class="ot">=</span> <span class="st">"median"</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>coding_days_comparisons_90_50 <span class="ot">&lt;-</span> marginaleffects<span class="sc">::</span><span class="fu">avg_comparisons</span>(</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_m,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">list</span>(<span class="at">yr_avg_avg_coding_days_per_week_c =</span> yr_avg_avg_coding_days_per_week_c_quantiles[<span class="dv">3</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> cycle_time_full_intx_lin_remonth_m<span class="sc">$</span>data,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">250</span>,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">re_formula =</span> <span class="cn">NULL</span>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>coding_days_comparisons_50_10 <span class="ot">&lt;-</span> marginaleffects<span class="sc">::</span><span class="fu">avg_comparisons</span>(</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_m,</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">list</span>(<span class="at">yr_avg_avg_coding_days_per_week_c =</span> yr_avg_avg_coding_days_per_week_c_quantiles[<span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>]),</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> cycle_time_full_intx_lin_remonth_m<span class="sc">$</span>data,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">250</span>,</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">re_formula =</span> <span class="cn">NULL</span>)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>convert_s_to_d <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">60</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">24</span>)</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>raw_median_cycle_time <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(cycle_time_full_intx_lin_remonth_m<span class="sc">$</span>data)[, .(<span class="at">median_users =</span> <span class="fu">median</span>(median_cycle_time_s)), by <span class="ot">=</span> <span class="st">'user_id_fac'</span>][, .(<span class="at">median =</span> <span class="fu">median</span>(median_users))]<span class="sc">*</span>convert_s_to_d</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"A difference between the 50th and 90th quantile of coding days is associated with a difference of %.2f (95%% CI = [%.2f, %.2f]) in cycle time (refer to overall median cycle time: %.2f)"</span>,</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>        coding_days_comparisons_90_50<span class="sc">$</span>estimate<span class="sc">*</span>convert_s_to_d, </span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>        coding_days_comparisons_90_50<span class="sc">$</span>conf.low<span class="sc">*</span>convert_s_to_d, </span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>        coding_days_comparisons_90_50<span class="sc">$</span>conf.high<span class="sc">*</span>convert_s_to_d,</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>        raw_median_cycle_time)</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"A difference between the 10th and 50th quantile of coding days is associated with a difference of %.2f (95%% CI = [%.2f, %.2f]) in cycle time (refer to overall median cycle time: %.2f)"</span>,</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>        coding_days_comparisons_50_10<span class="sc">$</span>estimate<span class="sc">*</span>convert_s_to_d, </span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>        coding_days_comparisons_50_10<span class="sc">$</span>conf.low<span class="sc">*</span>convert_s_to_d, </span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>        coding_days_comparisons_50_10<span class="sc">$</span>conf.high<span class="sc">*</span>convert_s_to_d,</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>        raw_median_cycle_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<pre><code>[1] "A difference between the 50th and 90th quantile of coding days is associated with a difference of -2.05 (95% CI = [-2.59, -1.43]) in cycle time (refer to overall median cycle time: 13.01)"

[1] "A difference between the 10th and 50th quantile of coding days is associated with a difference of -1.78 (95% CI = [-2.35, -1.20]) in cycle time (refer to overall median cycle time: 13.01)"</code></pre>
<div class="cell-container"><div class="cell-decorator"><pre>In [70]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>coding_days_comparisons_90_50_by_month <span class="ot">&lt;-</span> marginaleffects<span class="sc">::</span><span class="fu">avg_comparisons</span>(</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  cycle_time_full_intx_lin_remonth_m,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">list</span>(<span class="at">yr_avg_avg_coding_days_per_week_c =</span> yr_avg_avg_coding_days_per_week_c_quantiles[<span class="dv">3</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'org_id_fac'</span>, <span class="st">'month_num_c'</span>),</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> cycle_time_full_intx_lin_remonth_m<span class="sc">$</span>data,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">250</span>,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">re_formula =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [71]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>coding_days_comparisons_90_50_by_month<span class="sc">$</span>org_id_fac_reorder <span class="ot">&lt;-</span> <span class="fu">reorder</span>(coding_days_comparisons_90_50_by_month<span class="sc">$</span>org_id_fac, coding_days_comparisons_90_50_by_month<span class="sc">$</span>estimate, <span class="at">FUN =</span> mean)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(coding_days_comparisons_90_50_by_month, <span class="fu">aes</span>(<span class="at">x =</span> month_num_c, <span class="at">y =</span> org_id_fac_reorder)) <span class="sc">+</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> estimate<span class="sc">*</span>convert_s_to_d)) <span class="sc">+</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">transform =</span> scales<span class="sc">::</span><span class="fu">transform_modulus</span>(<span class="at">p =</span> <span class="sc">-</span>.<span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">5</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  theme_clean <span class="sc">+</span> </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove axis text for clarity</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),            <span class="co"># Remove grid lines for simplicity</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="at">units =</span> <span class="st">'mm'</span>),</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>),</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>),</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>)</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Calendar time'</span>, <span class="at">y =</span> <span class="st">'Organization'</span>, <span class="at">fill =</span> <span class="st">'Change in</span><span class="sc">\n</span><span class="st">cycle time (days)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</div>
</div>
</div>
</section>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content --> 
  
</body></html>